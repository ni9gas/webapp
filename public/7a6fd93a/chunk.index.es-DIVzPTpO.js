const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["7a6fd93a/chunk.index-5LjPrz-e.js","7a6fd93a/index.js"])))=>i.map(i=>d[i]);
import{a as go,c as wm,r as Ks,e as Zl,h as _m,j as Xl,k as bm,l as xc,t as yo,m as Em,n as Im,o as de,s as Fr,I as _i,A as xm,U as Pm,v as ie,w as Sm,x as gc,y as Om,_ as Am,z as Rm,V as $h,B as Cm,D as Tm,E as Nm,Z as Lh,$ as Dm,G as $m,H as lo,J as Lm,K as Ql,L as Lr,M as jm,N as Mm,X as us,O as Dt,Q as Qt,R as wi,S as ar,T as zm,Y as hs,a0 as ef,a1 as qm,a2 as Um,a3 as km,a4 as tf,a5 as Hm,a6 as rf,a7 as sf,a8 as ls,a9 as yc,aa as oo,ab as fs,ac as Km,ad as ao,ae as Bm,af as Vm,ag as Fm,ah as Gm,ai as Wm,aj as Wa,ak as jh,al as Jm,am as Ym,an as Zm,ao as Mh,ap as Xm,aq as Qm,ar as ew,as as tw,at as rw,au as iw,av as sw,aw as co,ax as nf,ay as Ja,az as nw,aA as ow}from"./index.js";import"https://esm.sh/react@18.3.1";import"https://esm.sh/react-dom@18.3.1";import"https://esm.sh/viem@1.5.0";var eo={exports:{}},zh;function of(){if(zh)return eo.exports;zh=1;var a=typeof Reflect=="object"?Reflect:null,r=a&&typeof a.apply=="function"?a.apply:function(j,E,C){return Function.prototype.apply.call(j,E,C)},i;a&&typeof a.ownKeys=="function"?i=a.ownKeys:Object.getOwnPropertySymbols?i=function(j){return Object.getOwnPropertyNames(j).concat(Object.getOwnPropertySymbols(j))}:i=function(j){return Object.getOwnPropertyNames(j)};function n(z){console&&console.warn&&console.warn(z)}var o=Number.isNaN||function(j){return j!==j};function h(){h.init.call(this)}eo.exports=h,eo.exports.once=ge,h.EventEmitter=h,h.prototype._events=void 0,h.prototype._eventsCount=0,h.prototype._maxListeners=void 0;var d=10;function m(z){if(typeof z!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof z)}Object.defineProperty(h,"defaultMaxListeners",{enumerable:!0,get:function(){return d},set:function(z){if(typeof z!="number"||z<0||o(z))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+z+".");d=z}}),h.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},h.prototype.setMaxListeners=function(j){if(typeof j!="number"||j<0||o(j))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+j+".");return this._maxListeners=j,this};function b(z){return z._maxListeners===void 0?h.defaultMaxListeners:z._maxListeners}h.prototype.getMaxListeners=function(){return b(this)},h.prototype.emit=function(j){for(var E=[],C=1;C<arguments.length;C++)E.push(arguments[C]);var q=j==="error",Q=this._events;if(Q!==void 0)q=q&&Q.error===void 0;else if(!q)return!1;if(q){var J;if(E.length>0&&(J=E[0]),J instanceof Error)throw J;var oe=new Error("Unhandled error."+(J?" ("+J.message+")":""));throw oe.context=J,oe}var be=Q[j];if(be===void 0)return!1;if(typeof be=="function")r(be,this,E);else for(var De=be.length,g=T(be,De),C=0;C<De;++C)r(g[C],this,E);return!0};function v(z,j,E,C){var q,Q,J;if(m(E),Q=z._events,Q===void 0?(Q=z._events=Object.create(null),z._eventsCount=0):(Q.newListener!==void 0&&(z.emit("newListener",j,E.listener?E.listener:E),Q=z._events),J=Q[j]),J===void 0)J=Q[j]=E,++z._eventsCount;else if(typeof J=="function"?J=Q[j]=C?[E,J]:[J,E]:C?J.unshift(E):J.push(E),q=b(z),q>0&&J.length>q&&!J.warned){J.warned=!0;var oe=new Error("Possible EventEmitter memory leak detected. "+J.length+" "+String(j)+" listeners added. Use emitter.setMaxListeners() to increase limit");oe.name="MaxListenersExceededWarning",oe.emitter=z,oe.type=j,oe.count=J.length,n(oe)}return z}h.prototype.addListener=function(j,E){return v(this,j,E,!1)},h.prototype.on=h.prototype.addListener,h.prototype.prependListener=function(j,E){return v(this,j,E,!0)};function x(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function N(z,j,E){var C={fired:!1,wrapFn:void 0,target:z,type:j,listener:E},q=x.bind(C);return q.listener=E,C.wrapFn=q,q}h.prototype.once=function(j,E){return m(E),this.on(j,N(this,j,E)),this},h.prototype.prependOnceListener=function(j,E){return m(E),this.prependListener(j,N(this,j,E)),this},h.prototype.removeListener=function(j,E){var C,q,Q,J,oe;if(m(E),q=this._events,q===void 0)return this;if(C=q[j],C===void 0)return this;if(C===E||C.listener===E)--this._eventsCount===0?this._events=Object.create(null):(delete q[j],q.removeListener&&this.emit("removeListener",j,C.listener||E));else if(typeof C!="function"){for(Q=-1,J=C.length-1;J>=0;J--)if(C[J]===E||C[J].listener===E){oe=C[J].listener,Q=J;break}if(Q<0)return this;Q===0?C.shift():W(C,Q),C.length===1&&(q[j]=C[0]),q.removeListener!==void 0&&this.emit("removeListener",j,oe||E)}return this},h.prototype.off=h.prototype.removeListener,h.prototype.removeAllListeners=function(j){var E,C,q;if(C=this._events,C===void 0)return this;if(C.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):C[j]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete C[j]),this;if(arguments.length===0){var Q=Object.keys(C),J;for(q=0;q<Q.length;++q)J=Q[q],J!=="removeListener"&&this.removeAllListeners(J);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(E=C[j],typeof E=="function")this.removeListener(j,E);else if(E!==void 0)for(q=E.length-1;q>=0;q--)this.removeListener(j,E[q]);return this};function L(z,j,E){var C=z._events;if(C===void 0)return[];var q=C[j];return q===void 0?[]:typeof q=="function"?E?[q.listener||q]:[q]:E?se(q):T(q,q.length)}h.prototype.listeners=function(j){return L(this,j,!0)},h.prototype.rawListeners=function(j){return L(this,j,!1)},h.listenerCount=function(z,j){return typeof z.listenerCount=="function"?z.listenerCount(j):K.call(z,j)},h.prototype.listenerCount=K;function K(z){var j=this._events;if(j!==void 0){var E=j[z];if(typeof E=="function")return 1;if(E!==void 0)return E.length}return 0}h.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]};function T(z,j){for(var E=new Array(j),C=0;C<j;++C)E[C]=z[C];return E}function W(z,j){for(;j+1<z.length;j++)z[j]=z[j+1];z.pop()}function se(z){for(var j=new Array(z.length),E=0;E<j.length;++E)j[E]=z[E].listener||z[E];return j}function ge(z,j){return new Promise(function(E,C){function q(J){z.removeListener(j,Q),C(J)}function Q(){typeof z.removeListener=="function"&&z.removeListener("error",q),E([].slice.call(arguments))}ue(z,j,Q,{once:!0}),j!=="error"&&fe(z,q,{once:!0})})}function fe(z,j,E){typeof z.on=="function"&&ue(z,"error",j,E)}function ue(z,j,E,C){if(typeof z.on=="function")C.once?z.once(j,E):z.on(j,E);else if(typeof z.addEventListener=="function")z.addEventListener(j,function q(Q){C.once&&z.removeEventListener(j,q),E(Q)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof z)}return eo.exports}var Ar=of();const Pc=go(Ar),aw=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,cw=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,uw=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function hw(a,r){if(a==="__proto__"||a==="constructor"&&r&&typeof r=="object"&&"prototype"in r){lw(a);return}return r}function lw(a){console.warn(`[destr] Dropping "${a}" key to prevent prototype pollution.`)}function to(a,r={}){if(typeof a!="string")return a;const i=a.trim();if(a[0]==='"'&&a.endsWith('"')&&!a.includes("\\"))return i.slice(1,-1);if(i.length<=9){const n=i.toLowerCase();if(n==="true")return!0;if(n==="false")return!1;if(n==="undefined")return;if(n==="null")return null;if(n==="nan")return Number.NaN;if(n==="infinity")return Number.POSITIVE_INFINITY;if(n==="-infinity")return Number.NEGATIVE_INFINITY}if(!uw.test(a)){if(r.strict)throw new SyntaxError("[destr] Invalid JSON");return a}try{if(aw.test(a)||cw.test(a)){if(r.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(a,hw)}return JSON.parse(a)}catch(n){if(r.strict)throw n;return a}}function fw(a){return!a||typeof a.then!="function"?Promise.resolve(a):a}function Ut(a,...r){try{return fw(a(...r))}catch(i){return Promise.reject(i)}}function pw(a){const r=typeof a;return a===null||r!=="object"&&r!=="function"}function dw(a){const r=Object.getPrototypeOf(a);return!r||r.isPrototypeOf(Object)}function uo(a){if(pw(a))return String(a);if(dw(a)||Array.isArray(a))return JSON.stringify(a);if(typeof a.toJSON=="function")return uo(a.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function af(){if(typeof Buffer>"u")throw new TypeError("[unstorage] Buffer is not supported!")}const vc="base64:";function gw(a){if(typeof a=="string")return a;af();const r=Buffer.from(a).toString("base64");return vc+r}function yw(a){return typeof a!="string"||!a.startsWith(vc)?a:(af(),Buffer.from(a.slice(vc.length),"base64"))}function or(a){return a?a.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function vw(...a){return or(a.join(":"))}function ro(a){return a=or(a),a?a+":":""}const mw="memory",ww=()=>{const a=new Map;return{name:mw,getInstance:()=>a,hasItem(r){return a.has(r)},getItem(r){return a.get(r)??null},getItemRaw(r){return a.get(r)??null},setItem(r,i){a.set(r,i)},setItemRaw(r,i){a.set(r,i)},removeItem(r){a.delete(r)},getKeys(){return[...a.keys()]},clear(){a.clear()},dispose(){a.clear()}}};function _w(a={}){const r={mounts:{"":a.driver||ww()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},i=v=>{for(const x of r.mountpoints)if(v.startsWith(x))return{base:x,relativeKey:v.slice(x.length),driver:r.mounts[x]};return{base:"",relativeKey:v,driver:r.mounts[""]}},n=(v,x)=>r.mountpoints.filter(N=>N.startsWith(v)||x&&v.startsWith(N)).map(N=>({relativeBase:v.length>N.length?v.slice(N.length):void 0,mountpoint:N,driver:r.mounts[N]})),o=(v,x)=>{if(r.watching){x=or(x);for(const N of r.watchListeners)N(v,x)}},h=async()=>{if(!r.watching){r.watching=!0;for(const v in r.mounts)r.unwatch[v]=await qh(r.mounts[v],o,v)}},d=async()=>{if(r.watching){for(const v in r.unwatch)await r.unwatch[v]();r.unwatch={},r.watching=!1}},m=(v,x,N)=>{const L=new Map,K=T=>{let W=L.get(T.base);return W||(W={driver:T.driver,base:T.base,items:[]},L.set(T.base,W)),W};for(const T of v){const W=typeof T=="string",se=or(W?T:T.key),ge=W?void 0:T.value,fe=W||!T.options?x:{...x,...T.options},ue=i(se);K(ue).items.push({key:se,value:ge,relativeKey:ue.relativeKey,options:fe})}return Promise.all([...L.values()].map(T=>N(T))).then(T=>T.flat())},b={hasItem(v,x={}){v=or(v);const{relativeKey:N,driver:L}=i(v);return Ut(L.hasItem,N,x)},getItem(v,x={}){v=or(v);const{relativeKey:N,driver:L}=i(v);return Ut(L.getItem,N,x).then(K=>to(K))},getItems(v,x){return m(v,x,N=>N.driver.getItems?Ut(N.driver.getItems,N.items.map(L=>({key:L.relativeKey,options:L.options})),x).then(L=>L.map(K=>({key:vw(N.base,K.key),value:to(K.value)}))):Promise.all(N.items.map(L=>Ut(N.driver.getItem,L.relativeKey,L.options).then(K=>({key:L.key,value:to(K)})))))},getItemRaw(v,x={}){v=or(v);const{relativeKey:N,driver:L}=i(v);return L.getItemRaw?Ut(L.getItemRaw,N,x):Ut(L.getItem,N,x).then(K=>yw(K))},async setItem(v,x,N={}){if(x===void 0)return b.removeItem(v);v=or(v);const{relativeKey:L,driver:K}=i(v);K.setItem&&(await Ut(K.setItem,L,uo(x),N),K.watch||o("update",v))},async setItems(v,x){await m(v,x,async N=>{if(N.driver.setItems)return Ut(N.driver.setItems,N.items.map(L=>({key:L.relativeKey,value:uo(L.value),options:L.options})),x);N.driver.setItem&&await Promise.all(N.items.map(L=>Ut(N.driver.setItem,L.relativeKey,uo(L.value),L.options)))})},async setItemRaw(v,x,N={}){if(x===void 0)return b.removeItem(v,N);v=or(v);const{relativeKey:L,driver:K}=i(v);if(K.setItemRaw)await Ut(K.setItemRaw,L,x,N);else if(K.setItem)await Ut(K.setItem,L,gw(x),N);else return;K.watch||o("update",v)},async removeItem(v,x={}){typeof x=="boolean"&&(x={removeMeta:x}),v=or(v);const{relativeKey:N,driver:L}=i(v);L.removeItem&&(await Ut(L.removeItem,N,x),(x.removeMeta||x.removeMata)&&await Ut(L.removeItem,N+"$",x),L.watch||o("remove",v))},async getMeta(v,x={}){typeof x=="boolean"&&(x={nativeOnly:x}),v=or(v);const{relativeKey:N,driver:L}=i(v),K=Object.create(null);if(L.getMeta&&Object.assign(K,await Ut(L.getMeta,N,x)),!x.nativeOnly){const T=await Ut(L.getItem,N+"$",x).then(W=>to(W));T&&typeof T=="object"&&(typeof T.atime=="string"&&(T.atime=new Date(T.atime)),typeof T.mtime=="string"&&(T.mtime=new Date(T.mtime)),Object.assign(K,T))}return K},setMeta(v,x,N={}){return this.setItem(v+"$",x,N)},removeMeta(v,x={}){return this.removeItem(v+"$",x)},async getKeys(v,x={}){v=ro(v);const N=n(v,!0);let L=[];const K=[];for(const T of N){const W=await Ut(T.driver.getKeys,T.relativeBase,x);for(const se of W){const ge=T.mountpoint+or(se);L.some(fe=>ge.startsWith(fe))||K.push(ge)}L=[T.mountpoint,...L.filter(se=>!se.startsWith(T.mountpoint))]}return v?K.filter(T=>T.startsWith(v)&&T[T.length-1]!=="$"):K.filter(T=>T[T.length-1]!=="$")},async clear(v,x={}){v=ro(v),await Promise.all(n(v,!1).map(async N=>{if(N.driver.clear)return Ut(N.driver.clear,N.relativeBase,x);if(N.driver.removeItem){const L=await N.driver.getKeys(N.relativeBase||"",x);return Promise.all(L.map(K=>N.driver.removeItem(K,x)))}}))},async dispose(){await Promise.all(Object.values(r.mounts).map(v=>Uh(v)))},async watch(v){return await h(),r.watchListeners.push(v),async()=>{r.watchListeners=r.watchListeners.filter(x=>x!==v),r.watchListeners.length===0&&await d()}},async unwatch(){r.watchListeners=[],await d()},mount(v,x){if(v=ro(v),v&&r.mounts[v])throw new Error(`already mounted at ${v}`);return v&&(r.mountpoints.push(v),r.mountpoints.sort((N,L)=>L.length-N.length)),r.mounts[v]=x,r.watching&&Promise.resolve(qh(x,o,v)).then(N=>{r.unwatch[v]=N}).catch(console.error),b},async unmount(v,x=!0){v=ro(v),!(!v||!r.mounts[v])&&(r.watching&&v in r.unwatch&&(r.unwatch[v](),delete r.unwatch[v]),x&&await Uh(r.mounts[v]),r.mountpoints=r.mountpoints.filter(N=>N!==v),delete r.mounts[v])},getMount(v=""){v=or(v)+":";const x=i(v);return{driver:x.driver,base:x.base}},getMounts(v="",x={}){return v=or(v),n(v,x.parents).map(L=>({driver:L.driver,base:L.mountpoint}))},keys:(v,x={})=>b.getKeys(v,x),get:(v,x={})=>b.getItem(v,x),set:(v,x,N={})=>b.setItem(v,x,N),has:(v,x={})=>b.hasItem(v,x),del:(v,x={})=>b.removeItem(v,x),remove:(v,x={})=>b.removeItem(v,x)};return b}function qh(a,r,i){return a.watch?a.watch((n,o)=>r(n,i+o)):()=>{}}async function Uh(a){typeof a.dispose=="function"&&await Ut(a.dispose)}function Ui(a){return new Promise((r,i)=>{a.oncomplete=a.onsuccess=()=>r(a.result),a.onabort=a.onerror=()=>i(a.error)})}function cf(a,r){const i=indexedDB.open(a);i.onupgradeneeded=()=>i.result.createObjectStore(r);const n=Ui(i);return(o,h)=>n.then(d=>h(d.transaction(r,o).objectStore(r)))}let Ya;function Bs(){return Ya||(Ya=cf("keyval-store","keyval")),Ya}function kh(a,r=Bs()){return r("readonly",i=>Ui(i.get(a)))}function bw(a,r,i=Bs()){return i("readwrite",n=>(n.put(r,a),Ui(n.transaction)))}function Ew(a,r=Bs()){return r("readwrite",i=>(i.delete(a),Ui(i.transaction)))}function Iw(a=Bs()){return a("readwrite",r=>(r.clear(),Ui(r.transaction)))}function xw(a,r){return a.openCursor().onsuccess=function(){this.result&&(r(this.result),this.result.continue())},Ui(a.transaction)}function Pw(a=Bs()){return a("readonly",r=>{if(r.getAllKeys)return Ui(r.getAllKeys());const i=[];return xw(r,n=>i.push(n.key)).then(()=>i)})}const Sw=a=>JSON.stringify(a,(r,i)=>typeof i=="bigint"?i.toString()+"n":i),Ow=a=>{const r=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,i=a.replace(r,'$1"$2n"$3');return JSON.parse(i,(n,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function Vs(a){if(typeof a!="string")throw new Error(`Cannot safe json parse value of type ${typeof a}`);try{return Ow(a)}catch{return a}}function qi(a){return typeof a=="string"?a:Sw(a)||""}const Aw="idb-keyval";var Rw=(a={})=>{const r=a.base&&a.base.length>0?`${a.base}:`:"",i=o=>r+o;let n;return a.dbName&&a.storeName&&(n=cf(a.dbName,a.storeName)),{name:Aw,options:a,async hasItem(o){return!(typeof await kh(i(o),n)>"u")},async getItem(o){return await kh(i(o),n)??null},setItem(o,h){return bw(i(o),h,n)},removeItem(o){return Ew(i(o),n)},getKeys(){return Pw(n)},clear(){return Iw(n)}}};const Cw="WALLET_CONNECT_V2_INDEXED_DB",Tw="keyvaluestorage";let Nw=class{constructor(){this.indexedDb=_w({driver:Rw({dbName:Cw,storeName:Tw})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(r=>[r.key,r.value])}async getItem(r){const i=await this.indexedDb.getItem(r);if(i!==null)return i}async setItem(r,i){await this.indexedDb.setItem(r,qi(i))}async removeItem(r){await this.indexedDb.removeItem(r)}};var Za=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ho={exports:{}};(function(){let a;function r(){}a=r,a.prototype.getItem=function(i){return this.hasOwnProperty(i)?String(this[i]):null},a.prototype.setItem=function(i,n){this[i]=String(n)},a.prototype.removeItem=function(i){delete this[i]},a.prototype.clear=function(){const i=this;Object.keys(i).forEach(function(n){i[n]=void 0,delete i[n]})},a.prototype.key=function(i){return i=i||0,Object.keys(this)[i]},a.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Za<"u"&&Za.localStorage?ho.exports=Za.localStorage:typeof window<"u"&&window.localStorage?ho.exports=window.localStorage:ho.exports=new r})();function Dw(a){var r;return[a[0],Vs((r=a[1])!=null?r:"")]}let $w=class{constructor(){this.localStorage=ho.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(Dw)}async getItem(r){const i=this.localStorage.getItem(r);if(i!==null)return Vs(i)}async setItem(r,i){this.localStorage.setItem(r,qi(i))}async removeItem(r){this.localStorage.removeItem(r)}};const Lw="wc_storage_version",Hh=1,jw=async(a,r,i)=>{const n=Lw,o=await r.getItem(n);if(o&&o>=Hh){i(r);return}const h=await a.getKeys();if(!h.length){i(r);return}const d=[];for(;h.length;){const m=h.shift();if(!m)continue;const b=m.toLowerCase();if(b.includes("wc@")||b.includes("walletconnect")||b.includes("wc_")||b.includes("wallet_connect")){const v=await a.getItem(m);await r.setItem(m,v),d.push(m)}}await r.setItem(n,Hh),i(r),Mw(a,d)},Mw=async(a,r)=>{r.length&&r.forEach(async i=>{await a.removeItem(i)})};let zw=class{constructor(){this.initialized=!1,this.setInitialized=i=>{this.storage=i,this.initialized=!0};const r=new $w;this.storage=r;try{const i=new Nw;jw(r,i,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(r){return await this.initialize(),this.storage.getItem(r)}async setItem(r,i){return await this.initialize(),this.storage.setItem(r,i)}async removeItem(r){return await this.initialize(),this.storage.removeItem(r)}async initialize(){this.initialized||await new Promise(r=>{const i=setInterval(()=>{this.initialized&&(clearInterval(i),r())},20)})}};var Xa={},Ns={},Qa={},Ds={};class ki{}const qw=Object.freeze(Object.defineProperty({__proto__:null,IEvents:ki},Symbol.toStringTag,{value:"Module"})),Uw=wm(qw);var Kh;function kw(){if(Kh)return Ds;Kh=1,Object.defineProperty(Ds,"__esModule",{value:!0}),Ds.IHeartBeat=void 0;const a=Uw;class r extends a.IEvents{constructor(n){super()}}return Ds.IHeartBeat=r,Ds}var Bh;function uf(){return Bh||(Bh=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),Ks.__exportStar(kw(),a)}(Qa)),Qa}var ec={},zi={},Vh;function Hw(){if(Vh)return zi;Vh=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.HEARTBEAT_EVENTS=zi.HEARTBEAT_INTERVAL=void 0;const a=Zl();return zi.HEARTBEAT_INTERVAL=a.FIVE_SECONDS,zi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},zi}var Fh;function hf(){return Fh||(Fh=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),Ks.__exportStar(Hw(),a)}(ec)),ec}var Gh;function Kw(){if(Gh)return Ns;Gh=1,Object.defineProperty(Ns,"__esModule",{value:!0}),Ns.HeartBeat=void 0;const a=Ks,r=of(),i=Zl(),n=uf(),o=hf();class h extends n.IHeartBeat{constructor(m){super(m),this.events=new r.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(m==null?void 0:m.interval)||o.HEARTBEAT_INTERVAL}static init(m){return a.__awaiter(this,void 0,void 0,function*(){const b=new h(m);return yield b.init(),b})}init(){return a.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(m,b){this.events.on(m,b)}once(m,b){this.events.once(m,b)}off(m,b){this.events.off(m,b)}removeListener(m,b){this.events.removeListener(m,b)}initialize(){return a.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),i.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return Ns.HeartBeat=h,Ns}var Wh;function Bw(){return Wh||(Wh=1,function(a){Object.defineProperty(a,"__esModule",{value:!0});const r=Ks;r.__exportStar(Kw(),a),r.__exportStar(uf(),a),r.__exportStar(hf(),a)}(Xa)),Xa}var Fs=Bw(),tc,Jh;function Vw(){if(Jh)return tc;Jh=1;function a(i){try{return JSON.stringify(i)}catch{return'"[Circular]"'}}tc=r;function r(i,n,o){var h=o&&o.stringify||a,d=1;if(typeof i=="object"&&i!==null){var m=n.length+d;if(m===1)return i;var b=new Array(m);b[0]=h(i);for(var v=1;v<m;v++)b[v]=h(n[v]);return b.join(" ")}if(typeof i!="string")return i;var x=n.length;if(x===0)return i;for(var N="",L=1-d,K=-1,T=i&&i.length||0,W=0;W<T;){if(i.charCodeAt(W)===37&&W+1<T){switch(K=K>-1?K:0,i.charCodeAt(W+1)){case 100:case 102:if(L>=x||n[L]==null)break;K<W&&(N+=i.slice(K,W)),N+=Number(n[L]),K=W+2,W++;break;case 105:if(L>=x||n[L]==null)break;K<W&&(N+=i.slice(K,W)),N+=Math.floor(Number(n[L])),K=W+2,W++;break;case 79:case 111:case 106:if(L>=x||n[L]===void 0)break;K<W&&(N+=i.slice(K,W));var se=typeof n[L];if(se==="string"){N+="'"+n[L]+"'",K=W+2,W++;break}if(se==="function"){N+=n[L].name||"<anonymous>",K=W+2,W++;break}N+=h(n[L]),K=W+2,W++;break;case 115:if(L>=x)break;K<W&&(N+=i.slice(K,W)),N+=String(n[L]),K=W+2,W++;break;case 37:K<W&&(N+=i.slice(K,W)),N+="%",K=W+2,W++,L--;break}++L}++W}return K===-1?i:(K<T&&(N+=i.slice(K)),N)}return tc}var rc,Yh;function Fw(){if(Yh)return rc;Yh=1;const a=Vw();rc=o;const r=j().console||{},i={mapHttpRequest:T,mapHttpResponse:T,wrapRequestSerializer:W,wrapResponseSerializer:W,wrapErrorSerializer:W,req:T,res:T,err:L};function n(E,C){return Array.isArray(E)?E.filter(function(Q){return Q!=="!stdSerializers.err"}):E===!0?Object.keys(C):!1}function o(E){E=E||{},E.browser=E.browser||{};const C=E.browser.transmit;if(C&&typeof C.send!="function")throw Error("pino: transmit option must have a send function");const q=E.browser.write||r;E.browser.write&&(E.browser.asObject=!0);const Q=E.serializers||{},J=n(E.browser.serialize,Q);let oe=E.browser.serialize;Array.isArray(E.browser.serialize)&&E.browser.serialize.indexOf("!stdSerializers.err")>-1&&(oe=!1);const be=["error","fatal","warn","info","debug","trace"];typeof q=="function"&&(q.error=q.fatal=q.warn=q.info=q.debug=q.trace=q),E.enabled===!1&&(E.level="silent");const De=E.level||"info",g=Object.create(q);g.log||(g.log=se),Object.defineProperty(g,"levelVal",{get:te}),Object.defineProperty(g,"level",{get:pe,set:Y});const P={transmit:C,serialize:J,asObject:E.browser.asObject,levels:be,timestamp:K(E)};g.levels=o.levels,g.level=De,g.setMaxListeners=g.getMaxListeners=g.emit=g.addListener=g.on=g.prependListener=g.once=g.prependOnceListener=g.removeListener=g.removeAllListeners=g.listeners=g.listenerCount=g.eventNames=g.write=g.flush=se,g.serializers=Q,g._serialize=J,g._stdErrSerialize=oe,g.child=V,C&&(g._logEvent=N());function te(){return this.level==="silent"?1/0:this.levels.values[this.level]}function pe(){return this._level}function Y(G){if(G!=="silent"&&!this.levels.values[G])throw Error("unknown level "+G);this._level=G,h(P,g,"error","log"),h(P,g,"fatal","error"),h(P,g,"warn","error"),h(P,g,"info","log"),h(P,g,"debug","log"),h(P,g,"trace","log")}function V(G,Z){if(!G)throw new Error("missing bindings for child Pino");Z=Z||{},J&&G.serializers&&(Z.serializers=G.serializers);const We=Z.serializers;if(J&&We){var He=Object.assign({},Q,We),Mr=E.browser.serialize===!0?Object.keys(He):J;delete G.serializers,b([G],Mr,He,this._stdErrSerialize)}function xe(It){this._childLevel=(It._childLevel|0)+1,this.error=v(It,G,"error"),this.fatal=v(It,G,"fatal"),this.warn=v(It,G,"warn"),this.info=v(It,G,"info"),this.debug=v(It,G,"debug"),this.trace=v(It,G,"trace"),He&&(this.serializers=He,this._serialize=Mr),C&&(this._logEvent=N([].concat(It._logEvent.bindings,G)))}return xe.prototype=this,new xe(this)}return g}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=i,o.stdTimeFunctions=Object.assign({},{nullTime:ge,epochTime:fe,unixTime:ue,isoTime:z});function h(E,C,q,Q){const J=Object.getPrototypeOf(C);C[q]=C.levelVal>C.levels.values[q]?se:J[q]?J[q]:r[q]||r[Q]||se,d(E,C,q)}function d(E,C,q){!E.transmit&&C[q]===se||(C[q]=function(Q){return function(){const oe=E.timestamp(),be=new Array(arguments.length),De=Object.getPrototypeOf&&Object.getPrototypeOf(this)===r?r:this;for(var g=0;g<be.length;g++)be[g]=arguments[g];if(E.serialize&&!E.asObject&&b(be,this._serialize,this.serializers,this._stdErrSerialize),E.asObject?Q.call(De,m(this,q,be,oe)):Q.apply(De,be),E.transmit){const P=E.transmit.level||C.level,te=o.levels.values[P],pe=o.levels.values[q];if(pe<te)return;x(this,{ts:oe,methodLevel:q,methodValue:pe,transmitLevel:P,transmitValue:o.levels.values[E.transmit.level||C.level],send:E.transmit.send,val:C.levelVal},be)}}}(C[q]))}function m(E,C,q,Q){E._serialize&&b(q,E._serialize,E.serializers,E._stdErrSerialize);const J=q.slice();let oe=J[0];const be={};Q&&(be.time=Q),be.level=o.levels.values[C];let De=(E._childLevel|0)+1;if(De<1&&(De=1),oe!==null&&typeof oe=="object"){for(;De--&&typeof J[0]=="object";)Object.assign(be,J.shift());oe=J.length?a(J.shift(),J):void 0}else typeof oe=="string"&&(oe=a(J.shift(),J));return oe!==void 0&&(be.msg=oe),be}function b(E,C,q,Q){for(const J in E)if(Q&&E[J]instanceof Error)E[J]=o.stdSerializers.err(E[J]);else if(typeof E[J]=="object"&&!Array.isArray(E[J]))for(const oe in E[J])C&&C.indexOf(oe)>-1&&oe in q&&(E[J][oe]=q[oe](E[J][oe]))}function v(E,C,q){return function(){const Q=new Array(1+arguments.length);Q[0]=C;for(var J=1;J<Q.length;J++)Q[J]=arguments[J-1];return E[q].apply(this,Q)}}function x(E,C,q){const Q=C.send,J=C.ts,oe=C.methodLevel,be=C.methodValue,De=C.val,g=E._logEvent.bindings;b(q,E._serialize||Object.keys(E.serializers),E.serializers,E._stdErrSerialize===void 0?!0:E._stdErrSerialize),E._logEvent.ts=J,E._logEvent.messages=q.filter(function(P){return g.indexOf(P)===-1}),E._logEvent.level.label=oe,E._logEvent.level.value=be,Q(oe,E._logEvent,De),E._logEvent=N(g)}function N(E){return{ts:0,messages:[],bindings:E||[],level:{label:"",value:0}}}function L(E){const C={type:E.constructor.name,msg:E.message,stack:E.stack};for(const q in E)C[q]===void 0&&(C[q]=E[q]);return C}function K(E){return typeof E.timestamp=="function"?E.timestamp:E.timestamp===!1?ge:fe}function T(){return{}}function W(E){return E}function se(){}function ge(){return!1}function fe(){return Date.now()}function ue(){return Math.round(Date.now()/1e3)}function z(){return new Date(Date.now()).toISOString()}function j(){function E(C){return typeof C<"u"&&C}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return E(self)||E(window)||E(this)||{}}}return rc}var Gw=Fw();const vo=go(Gw),Ww={level:"info"},Gs="custom_context";var Jw=Object.defineProperty,Yw=Object.defineProperties,Zw=Object.getOwnPropertyDescriptors,Zh=Object.getOwnPropertySymbols,Xw=Object.prototype.hasOwnProperty,Qw=Object.prototype.propertyIsEnumerable,Xh=(a,r,i)=>r in a?Jw(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,e_=(a,r)=>{for(var i in r||(r={}))Xw.call(r,i)&&Xh(a,i,r[i]);if(Zh)for(var i of Zh(r))Qw.call(r,i)&&Xh(a,i,r[i]);return a},t_=(a,r)=>Yw(a,Zw(r));function mo(a){return t_(e_({},a),{level:(a==null?void 0:a.level)||Ww.level})}function r_(a,r=Gs){return a[r]||""}function i_(a,r,i=Gs){return a[i]=r,a}function cr(a,r=Gs){let i="";return typeof a.bindings>"u"?i=r_(a,r):i=a.bindings().context||"",i}function s_(a,r,i=Gs){const n=cr(a,i);return n.trim()?`${n}/${r}`:r}function gr(a,r,i=Gs){const n=s_(a,r,i),o=a.child({context:n});return i_(o,n,i)}let n_=class extends ki{constructor(r){super(),this.opts=r,this.protocol="wc",this.version=2}};class o_ extends ki{constructor(r,i){super(),this.core=r,this.logger=i,this.records=new Map}}class a_{constructor(r,i){this.logger=r,this.core=i}}let c_=class extends ki{constructor(r,i){super(),this.relayer=r,this.logger=i}},u_=class extends ki{constructor(r){super()}},h_=class{constructor(r,i,n,o){this.core=r,this.logger=i,this.name=n}},l_=class extends ki{constructor(r,i){super(),this.relayer=r,this.logger=i}},f_=class extends ki{constructor(r,i){super(),this.core=r,this.logger=i}},p_=class{constructor(r,i){this.projectId=r,this.logger=i}},d_=class{constructor(r){this.opts=r,this.protocol="wc",this.version=2}},g_=class{constructor(r){this.client=r}};var ic={},sc={},Qh;function y_(){return Qh||(Qh=1,function(a){Object.defineProperty(a,"__esModule",{value:!0});var r=_m(),i=Xl();a.DIGEST_LENGTH=64,a.BLOCK_SIZE=128;var n=function(){function m(){this.digestLength=a.DIGEST_LENGTH,this.blockSize=a.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return m.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},m.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},m.prototype.clean=function(){i.wipe(this._buffer),i.wipe(this._tempHi),i.wipe(this._tempLo),this.reset()},m.prototype.update=function(b,v){if(v===void 0&&(v=b.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var x=0;if(this._bytesHashed+=v,this._bufferLength>0){for(;this._bufferLength<a.BLOCK_SIZE&&v>0;)this._buffer[this._bufferLength++]=b[x++],v--;this._bufferLength===this.blockSize&&(h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(v>=this.blockSize&&(x=h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,b,x,v),v%=this.blockSize);v>0;)this._buffer[this._bufferLength++]=b[x++],v--;return this},m.prototype.finish=function(b){if(!this._finished){var v=this._bytesHashed,x=this._bufferLength,N=v/536870912|0,L=v<<3,K=v%128<112?128:256;this._buffer[x]=128;for(var T=x+1;T<K-8;T++)this._buffer[T]=0;r.writeUint32BE(N,this._buffer,K-8),r.writeUint32BE(L,this._buffer,K-4),h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,K),this._finished=!0}for(var T=0;T<this.digestLength/8;T++)r.writeUint32BE(this._stateHi[T],b,T*8),r.writeUint32BE(this._stateLo[T],b,T*8+4);return this},m.prototype.digest=function(){var b=new Uint8Array(this.digestLength);return this.finish(b),b},m.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},m.prototype.restoreState=function(b){return this._stateHi.set(b.stateHi),this._stateLo.set(b.stateLo),this._bufferLength=b.bufferLength,b.buffer&&this._buffer.set(b.buffer),this._bytesHashed=b.bytesHashed,this._finished=!1,this},m.prototype.cleanSavedState=function(b){i.wipe(b.stateHi),i.wipe(b.stateLo),b.buffer&&i.wipe(b.buffer),b.bufferLength=0,b.bytesHashed=0},m}();a.SHA512=n;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function h(m,b,v,x,N,L,K){for(var T=v[0],W=v[1],se=v[2],ge=v[3],fe=v[4],ue=v[5],z=v[6],j=v[7],E=x[0],C=x[1],q=x[2],Q=x[3],J=x[4],oe=x[5],be=x[6],De=x[7],g,P,te,pe,Y,V,G,Z;K>=128;){for(var We=0;We<16;We++){var He=8*We+L;m[We]=r.readUint32BE(N,He),b[We]=r.readUint32BE(N,He+4)}for(var We=0;We<80;We++){var Mr=T,xe=W,It=se,M=ge,$=fe,R=ue,u=z,I=j,ne=E,ye=C,Ee=q,Te=Q,$e=J,Oe=oe,xt=be,vt=De;if(g=j,P=De,Y=P&65535,V=P>>>16,G=g&65535,Z=g>>>16,g=(fe>>>14|J<<18)^(fe>>>18|J<<14)^(J>>>9|fe<<23),P=(J>>>14|fe<<18)^(J>>>18|fe<<14)^(fe>>>9|J<<23),Y+=P&65535,V+=P>>>16,G+=g&65535,Z+=g>>>16,g=fe&ue^~fe&z,P=J&oe^~J&be,Y+=P&65535,V+=P>>>16,G+=g&65535,Z+=g>>>16,g=o[We*2],P=o[We*2+1],Y+=P&65535,V+=P>>>16,G+=g&65535,Z+=g>>>16,g=m[We%16],P=b[We%16],Y+=P&65535,V+=P>>>16,G+=g&65535,Z+=g>>>16,V+=Y>>>16,G+=V>>>16,Z+=G>>>16,te=G&65535|Z<<16,pe=Y&65535|V<<16,g=te,P=pe,Y=P&65535,V=P>>>16,G=g&65535,Z=g>>>16,g=(T>>>28|E<<4)^(E>>>2|T<<30)^(E>>>7|T<<25),P=(E>>>28|T<<4)^(T>>>2|E<<30)^(T>>>7|E<<25),Y+=P&65535,V+=P>>>16,G+=g&65535,Z+=g>>>16,g=T&W^T&se^W&se,P=E&C^E&q^C&q,Y+=P&65535,V+=P>>>16,G+=g&65535,Z+=g>>>16,V+=Y>>>16,G+=V>>>16,Z+=G>>>16,I=G&65535|Z<<16,vt=Y&65535|V<<16,g=M,P=Te,Y=P&65535,V=P>>>16,G=g&65535,Z=g>>>16,g=te,P=pe,Y+=P&65535,V+=P>>>16,G+=g&65535,Z+=g>>>16,V+=Y>>>16,G+=V>>>16,Z+=G>>>16,M=G&65535|Z<<16,Te=Y&65535|V<<16,W=Mr,se=xe,ge=It,fe=M,ue=$,z=R,j=u,T=I,C=ne,q=ye,Q=Ee,J=Te,oe=$e,be=Oe,De=xt,E=vt,We%16===15)for(var He=0;He<16;He++)g=m[He],P=b[He],Y=P&65535,V=P>>>16,G=g&65535,Z=g>>>16,g=m[(He+9)%16],P=b[(He+9)%16],Y+=P&65535,V+=P>>>16,G+=g&65535,Z+=g>>>16,te=m[(He+1)%16],pe=b[(He+1)%16],g=(te>>>1|pe<<31)^(te>>>8|pe<<24)^te>>>7,P=(pe>>>1|te<<31)^(pe>>>8|te<<24)^(pe>>>7|te<<25),Y+=P&65535,V+=P>>>16,G+=g&65535,Z+=g>>>16,te=m[(He+14)%16],pe=b[(He+14)%16],g=(te>>>19|pe<<13)^(pe>>>29|te<<3)^te>>>6,P=(pe>>>19|te<<13)^(te>>>29|pe<<3)^(pe>>>6|te<<26),Y+=P&65535,V+=P>>>16,G+=g&65535,Z+=g>>>16,V+=Y>>>16,G+=V>>>16,Z+=G>>>16,m[He]=G&65535|Z<<16,b[He]=Y&65535|V<<16}g=T,P=E,Y=P&65535,V=P>>>16,G=g&65535,Z=g>>>16,g=v[0],P=x[0],Y+=P&65535,V+=P>>>16,G+=g&65535,Z+=g>>>16,V+=Y>>>16,G+=V>>>16,Z+=G>>>16,v[0]=T=G&65535|Z<<16,x[0]=E=Y&65535|V<<16,g=W,P=C,Y=P&65535,V=P>>>16,G=g&65535,Z=g>>>16,g=v[1],P=x[1],Y+=P&65535,V+=P>>>16,G+=g&65535,Z+=g>>>16,V+=Y>>>16,G+=V>>>16,Z+=G>>>16,v[1]=W=G&65535|Z<<16,x[1]=C=Y&65535|V<<16,g=se,P=q,Y=P&65535,V=P>>>16,G=g&65535,Z=g>>>16,g=v[2],P=x[2],Y+=P&65535,V+=P>>>16,G+=g&65535,Z+=g>>>16,V+=Y>>>16,G+=V>>>16,Z+=G>>>16,v[2]=se=G&65535|Z<<16,x[2]=q=Y&65535|V<<16,g=ge,P=Q,Y=P&65535,V=P>>>16,G=g&65535,Z=g>>>16,g=v[3],P=x[3],Y+=P&65535,V+=P>>>16,G+=g&65535,Z+=g>>>16,V+=Y>>>16,G+=V>>>16,Z+=G>>>16,v[3]=ge=G&65535|Z<<16,x[3]=Q=Y&65535|V<<16,g=fe,P=J,Y=P&65535,V=P>>>16,G=g&65535,Z=g>>>16,g=v[4],P=x[4],Y+=P&65535,V+=P>>>16,G+=g&65535,Z+=g>>>16,V+=Y>>>16,G+=V>>>16,Z+=G>>>16,v[4]=fe=G&65535|Z<<16,x[4]=J=Y&65535|V<<16,g=ue,P=oe,Y=P&65535,V=P>>>16,G=g&65535,Z=g>>>16,g=v[5],P=x[5],Y+=P&65535,V+=P>>>16,G+=g&65535,Z+=g>>>16,V+=Y>>>16,G+=V>>>16,Z+=G>>>16,v[5]=ue=G&65535|Z<<16,x[5]=oe=Y&65535|V<<16,g=z,P=be,Y=P&65535,V=P>>>16,G=g&65535,Z=g>>>16,g=v[6],P=x[6],Y+=P&65535,V+=P>>>16,G+=g&65535,Z+=g>>>16,V+=Y>>>16,G+=V>>>16,Z+=G>>>16,v[6]=z=G&65535|Z<<16,x[6]=be=Y&65535|V<<16,g=j,P=De,Y=P&65535,V=P>>>16,G=g&65535,Z=g>>>16,g=v[7],P=x[7],Y+=P&65535,V+=P>>>16,G+=g&65535,Z+=g>>>16,V+=Y>>>16,G+=V>>>16,Z+=G>>>16,v[7]=j=G&65535|Z<<16,x[7]=De=Y&65535|V<<16,L+=128,K-=128}return L}function d(m){var b=new n;b.update(m);var v=b.digest();return b.clean(),v}a.hash=d}(sc)),sc}var el;function v_(){return el||(el=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.convertSecretKeyToX25519=a.convertPublicKeyToX25519=a.verify=a.sign=a.extractPublicKeyFromSecretKey=a.generateKeyPair=a.generateKeyPairFromSeed=a.SEED_LENGTH=a.SECRET_KEY_LENGTH=a.PUBLIC_KEY_LENGTH=a.SIGNATURE_LENGTH=void 0;const r=bm(),i=y_(),n=Xl();a.SIGNATURE_LENGTH=64,a.PUBLIC_KEY_LENGTH=32,a.SECRET_KEY_LENGTH=64,a.SEED_LENGTH=32;function o(M){const $=new Float64Array(16);if(M)for(let R=0;R<M.length;R++)$[R]=M[R];return $}const h=new Uint8Array(32);h[0]=9;const d=o(),m=o([1]),b=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),v=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),x=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),N=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),L=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function K(M,$){for(let R=0;R<16;R++)M[R]=$[R]|0}function T(M){let $=1;for(let R=0;R<16;R++){let u=M[R]+$+65535;$=Math.floor(u/65536),M[R]=u-$*65536}M[0]+=$-1+37*($-1)}function W(M,$,R){const u=~(R-1);for(let I=0;I<16;I++){const ne=u&(M[I]^$[I]);M[I]^=ne,$[I]^=ne}}function se(M,$){const R=o(),u=o();for(let I=0;I<16;I++)u[I]=$[I];T(u),T(u),T(u);for(let I=0;I<2;I++){R[0]=u[0]-65517;for(let ye=1;ye<15;ye++)R[ye]=u[ye]-65535-(R[ye-1]>>16&1),R[ye-1]&=65535;R[15]=u[15]-32767-(R[14]>>16&1);const ne=R[15]>>16&1;R[14]&=65535,W(u,R,1-ne)}for(let I=0;I<16;I++)M[2*I]=u[I]&255,M[2*I+1]=u[I]>>8}function ge(M,$){let R=0;for(let u=0;u<32;u++)R|=M[u]^$[u];return(1&R-1>>>8)-1}function fe(M,$){const R=new Uint8Array(32),u=new Uint8Array(32);return se(R,M),se(u,$),ge(R,u)}function ue(M){const $=new Uint8Array(32);return se($,M),$[0]&1}function z(M,$){for(let R=0;R<16;R++)M[R]=$[2*R]+($[2*R+1]<<8);M[15]&=32767}function j(M,$,R){for(let u=0;u<16;u++)M[u]=$[u]+R[u]}function E(M,$,R){for(let u=0;u<16;u++)M[u]=$[u]-R[u]}function C(M,$,R){let u,I,ne=0,ye=0,Ee=0,Te=0,$e=0,Oe=0,xt=0,vt=0,st=0,je=0,Ye=0,Ze=0,nt=0,Ue=0,Xe=0,Ne=0,Ke=0,ct=0,ze=0,Pt=0,$t=0,kt=0,Ht=0,Mt=0,Gt=0,er=0,zr=0,Wt=0,Gr=0,ci=0,xi=0,ut=R[0],tt=R[1],ht=R[2],lt=R[3],ot=R[4],rt=R[5],St=R[6],Ot=R[7],ft=R[8],At=R[9],pt=R[10],mt=R[11],dt=R[12],Je=R[13],Rt=R[14],Ct=R[15];u=$[0],ne+=u*ut,ye+=u*tt,Ee+=u*ht,Te+=u*lt,$e+=u*ot,Oe+=u*rt,xt+=u*St,vt+=u*Ot,st+=u*ft,je+=u*At,Ye+=u*pt,Ze+=u*mt,nt+=u*dt,Ue+=u*Je,Xe+=u*Rt,Ne+=u*Ct,u=$[1],ye+=u*ut,Ee+=u*tt,Te+=u*ht,$e+=u*lt,Oe+=u*ot,xt+=u*rt,vt+=u*St,st+=u*Ot,je+=u*ft,Ye+=u*At,Ze+=u*pt,nt+=u*mt,Ue+=u*dt,Xe+=u*Je,Ne+=u*Rt,Ke+=u*Ct,u=$[2],Ee+=u*ut,Te+=u*tt,$e+=u*ht,Oe+=u*lt,xt+=u*ot,vt+=u*rt,st+=u*St,je+=u*Ot,Ye+=u*ft,Ze+=u*At,nt+=u*pt,Ue+=u*mt,Xe+=u*dt,Ne+=u*Je,Ke+=u*Rt,ct+=u*Ct,u=$[3],Te+=u*ut,$e+=u*tt,Oe+=u*ht,xt+=u*lt,vt+=u*ot,st+=u*rt,je+=u*St,Ye+=u*Ot,Ze+=u*ft,nt+=u*At,Ue+=u*pt,Xe+=u*mt,Ne+=u*dt,Ke+=u*Je,ct+=u*Rt,ze+=u*Ct,u=$[4],$e+=u*ut,Oe+=u*tt,xt+=u*ht,vt+=u*lt,st+=u*ot,je+=u*rt,Ye+=u*St,Ze+=u*Ot,nt+=u*ft,Ue+=u*At,Xe+=u*pt,Ne+=u*mt,Ke+=u*dt,ct+=u*Je,ze+=u*Rt,Pt+=u*Ct,u=$[5],Oe+=u*ut,xt+=u*tt,vt+=u*ht,st+=u*lt,je+=u*ot,Ye+=u*rt,Ze+=u*St,nt+=u*Ot,Ue+=u*ft,Xe+=u*At,Ne+=u*pt,Ke+=u*mt,ct+=u*dt,ze+=u*Je,Pt+=u*Rt,$t+=u*Ct,u=$[6],xt+=u*ut,vt+=u*tt,st+=u*ht,je+=u*lt,Ye+=u*ot,Ze+=u*rt,nt+=u*St,Ue+=u*Ot,Xe+=u*ft,Ne+=u*At,Ke+=u*pt,ct+=u*mt,ze+=u*dt,Pt+=u*Je,$t+=u*Rt,kt+=u*Ct,u=$[7],vt+=u*ut,st+=u*tt,je+=u*ht,Ye+=u*lt,Ze+=u*ot,nt+=u*rt,Ue+=u*St,Xe+=u*Ot,Ne+=u*ft,Ke+=u*At,ct+=u*pt,ze+=u*mt,Pt+=u*dt,$t+=u*Je,kt+=u*Rt,Ht+=u*Ct,u=$[8],st+=u*ut,je+=u*tt,Ye+=u*ht,Ze+=u*lt,nt+=u*ot,Ue+=u*rt,Xe+=u*St,Ne+=u*Ot,Ke+=u*ft,ct+=u*At,ze+=u*pt,Pt+=u*mt,$t+=u*dt,kt+=u*Je,Ht+=u*Rt,Mt+=u*Ct,u=$[9],je+=u*ut,Ye+=u*tt,Ze+=u*ht,nt+=u*lt,Ue+=u*ot,Xe+=u*rt,Ne+=u*St,Ke+=u*Ot,ct+=u*ft,ze+=u*At,Pt+=u*pt,$t+=u*mt,kt+=u*dt,Ht+=u*Je,Mt+=u*Rt,Gt+=u*Ct,u=$[10],Ye+=u*ut,Ze+=u*tt,nt+=u*ht,Ue+=u*lt,Xe+=u*ot,Ne+=u*rt,Ke+=u*St,ct+=u*Ot,ze+=u*ft,Pt+=u*At,$t+=u*pt,kt+=u*mt,Ht+=u*dt,Mt+=u*Je,Gt+=u*Rt,er+=u*Ct,u=$[11],Ze+=u*ut,nt+=u*tt,Ue+=u*ht,Xe+=u*lt,Ne+=u*ot,Ke+=u*rt,ct+=u*St,ze+=u*Ot,Pt+=u*ft,$t+=u*At,kt+=u*pt,Ht+=u*mt,Mt+=u*dt,Gt+=u*Je,er+=u*Rt,zr+=u*Ct,u=$[12],nt+=u*ut,Ue+=u*tt,Xe+=u*ht,Ne+=u*lt,Ke+=u*ot,ct+=u*rt,ze+=u*St,Pt+=u*Ot,$t+=u*ft,kt+=u*At,Ht+=u*pt,Mt+=u*mt,Gt+=u*dt,er+=u*Je,zr+=u*Rt,Wt+=u*Ct,u=$[13],Ue+=u*ut,Xe+=u*tt,Ne+=u*ht,Ke+=u*lt,ct+=u*ot,ze+=u*rt,Pt+=u*St,$t+=u*Ot,kt+=u*ft,Ht+=u*At,Mt+=u*pt,Gt+=u*mt,er+=u*dt,zr+=u*Je,Wt+=u*Rt,Gr+=u*Ct,u=$[14],Xe+=u*ut,Ne+=u*tt,Ke+=u*ht,ct+=u*lt,ze+=u*ot,Pt+=u*rt,$t+=u*St,kt+=u*Ot,Ht+=u*ft,Mt+=u*At,Gt+=u*pt,er+=u*mt,zr+=u*dt,Wt+=u*Je,Gr+=u*Rt,ci+=u*Ct,u=$[15],Ne+=u*ut,Ke+=u*tt,ct+=u*ht,ze+=u*lt,Pt+=u*ot,$t+=u*rt,kt+=u*St,Ht+=u*Ot,Mt+=u*ft,Gt+=u*At,er+=u*pt,zr+=u*mt,Wt+=u*dt,Gr+=u*Je,ci+=u*Rt,xi+=u*Ct,ne+=38*Ke,ye+=38*ct,Ee+=38*ze,Te+=38*Pt,$e+=38*$t,Oe+=38*kt,xt+=38*Ht,vt+=38*Mt,st+=38*Gt,je+=38*er,Ye+=38*zr,Ze+=38*Wt,nt+=38*Gr,Ue+=38*ci,Xe+=38*xi,I=1,u=ne+I+65535,I=Math.floor(u/65536),ne=u-I*65536,u=ye+I+65535,I=Math.floor(u/65536),ye=u-I*65536,u=Ee+I+65535,I=Math.floor(u/65536),Ee=u-I*65536,u=Te+I+65535,I=Math.floor(u/65536),Te=u-I*65536,u=$e+I+65535,I=Math.floor(u/65536),$e=u-I*65536,u=Oe+I+65535,I=Math.floor(u/65536),Oe=u-I*65536,u=xt+I+65535,I=Math.floor(u/65536),xt=u-I*65536,u=vt+I+65535,I=Math.floor(u/65536),vt=u-I*65536,u=st+I+65535,I=Math.floor(u/65536),st=u-I*65536,u=je+I+65535,I=Math.floor(u/65536),je=u-I*65536,u=Ye+I+65535,I=Math.floor(u/65536),Ye=u-I*65536,u=Ze+I+65535,I=Math.floor(u/65536),Ze=u-I*65536,u=nt+I+65535,I=Math.floor(u/65536),nt=u-I*65536,u=Ue+I+65535,I=Math.floor(u/65536),Ue=u-I*65536,u=Xe+I+65535,I=Math.floor(u/65536),Xe=u-I*65536,u=Ne+I+65535,I=Math.floor(u/65536),Ne=u-I*65536,ne+=I-1+37*(I-1),I=1,u=ne+I+65535,I=Math.floor(u/65536),ne=u-I*65536,u=ye+I+65535,I=Math.floor(u/65536),ye=u-I*65536,u=Ee+I+65535,I=Math.floor(u/65536),Ee=u-I*65536,u=Te+I+65535,I=Math.floor(u/65536),Te=u-I*65536,u=$e+I+65535,I=Math.floor(u/65536),$e=u-I*65536,u=Oe+I+65535,I=Math.floor(u/65536),Oe=u-I*65536,u=xt+I+65535,I=Math.floor(u/65536),xt=u-I*65536,u=vt+I+65535,I=Math.floor(u/65536),vt=u-I*65536,u=st+I+65535,I=Math.floor(u/65536),st=u-I*65536,u=je+I+65535,I=Math.floor(u/65536),je=u-I*65536,u=Ye+I+65535,I=Math.floor(u/65536),Ye=u-I*65536,u=Ze+I+65535,I=Math.floor(u/65536),Ze=u-I*65536,u=nt+I+65535,I=Math.floor(u/65536),nt=u-I*65536,u=Ue+I+65535,I=Math.floor(u/65536),Ue=u-I*65536,u=Xe+I+65535,I=Math.floor(u/65536),Xe=u-I*65536,u=Ne+I+65535,I=Math.floor(u/65536),Ne=u-I*65536,ne+=I-1+37*(I-1),M[0]=ne,M[1]=ye,M[2]=Ee,M[3]=Te,M[4]=$e,M[5]=Oe,M[6]=xt,M[7]=vt,M[8]=st,M[9]=je,M[10]=Ye,M[11]=Ze,M[12]=nt,M[13]=Ue,M[14]=Xe,M[15]=Ne}function q(M,$){C(M,$,$)}function Q(M,$){const R=o();let u;for(u=0;u<16;u++)R[u]=$[u];for(u=253;u>=0;u--)q(R,R),u!==2&&u!==4&&C(R,R,$);for(u=0;u<16;u++)M[u]=R[u]}function J(M,$){const R=o();let u;for(u=0;u<16;u++)R[u]=$[u];for(u=250;u>=0;u--)q(R,R),u!==1&&C(R,R,$);for(u=0;u<16;u++)M[u]=R[u]}function oe(M,$){const R=o(),u=o(),I=o(),ne=o(),ye=o(),Ee=o(),Te=o(),$e=o(),Oe=o();E(R,M[1],M[0]),E(Oe,$[1],$[0]),C(R,R,Oe),j(u,M[0],M[1]),j(Oe,$[0],$[1]),C(u,u,Oe),C(I,M[3],$[3]),C(I,I,v),C(ne,M[2],$[2]),j(ne,ne,ne),E(ye,u,R),E(Ee,ne,I),j(Te,ne,I),j($e,u,R),C(M[0],ye,Ee),C(M[1],$e,Te),C(M[2],Te,Ee),C(M[3],ye,$e)}function be(M,$,R){for(let u=0;u<4;u++)W(M[u],$[u],R)}function De(M,$){const R=o(),u=o(),I=o();Q(I,$[2]),C(R,$[0],I),C(u,$[1],I),se(M,u),M[31]^=ue(R)<<7}function g(M,$,R){K(M[0],d),K(M[1],m),K(M[2],m),K(M[3],d);for(let u=255;u>=0;--u){const I=R[u/8|0]>>(u&7)&1;be(M,$,I),oe($,M),oe(M,M),be(M,$,I)}}function P(M,$){const R=[o(),o(),o(),o()];K(R[0],x),K(R[1],N),K(R[2],m),C(R[3],x,N),g(M,R,$)}function te(M){if(M.length!==a.SEED_LENGTH)throw new Error(`ed25519: seed must be ${a.SEED_LENGTH} bytes`);const $=(0,i.hash)(M);$[0]&=248,$[31]&=127,$[31]|=64;const R=new Uint8Array(32),u=[o(),o(),o(),o()];P(u,$),De(R,u);const I=new Uint8Array(64);return I.set(M),I.set(R,32),{publicKey:R,secretKey:I}}a.generateKeyPairFromSeed=te;function pe(M){const $=(0,r.randomBytes)(32,M),R=te($);return(0,n.wipe)($),R}a.generateKeyPair=pe;function Y(M){if(M.length!==a.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${a.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(M.subarray(32))}a.extractPublicKeyFromSecretKey=Y;const V=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function G(M,$){let R,u,I,ne;for(u=63;u>=32;--u){for(R=0,I=u-32,ne=u-12;I<ne;++I)$[I]+=R-16*$[u]*V[I-(u-32)],R=Math.floor(($[I]+128)/256),$[I]-=R*256;$[I]+=R,$[u]=0}for(R=0,I=0;I<32;I++)$[I]+=R-($[31]>>4)*V[I],R=$[I]>>8,$[I]&=255;for(I=0;I<32;I++)$[I]-=R*V[I];for(u=0;u<32;u++)$[u+1]+=$[u]>>8,M[u]=$[u]&255}function Z(M){const $=new Float64Array(64);for(let R=0;R<64;R++)$[R]=M[R];for(let R=0;R<64;R++)M[R]=0;G(M,$)}function We(M,$){const R=new Float64Array(64),u=[o(),o(),o(),o()],I=(0,i.hash)(M.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const ne=new Uint8Array(64);ne.set(I.subarray(32),32);const ye=new i.SHA512;ye.update(ne.subarray(32)),ye.update($);const Ee=ye.digest();ye.clean(),Z(Ee),P(u,Ee),De(ne,u),ye.reset(),ye.update(ne.subarray(0,32)),ye.update(M.subarray(32)),ye.update($);const Te=ye.digest();Z(Te);for(let $e=0;$e<32;$e++)R[$e]=Ee[$e];for(let $e=0;$e<32;$e++)for(let Oe=0;Oe<32;Oe++)R[$e+Oe]+=Te[$e]*I[Oe];return G(ne.subarray(32),R),ne}a.sign=We;function He(M,$){const R=o(),u=o(),I=o(),ne=o(),ye=o(),Ee=o(),Te=o();return K(M[2],m),z(M[1],$),q(I,M[1]),C(ne,I,b),E(I,I,M[2]),j(ne,M[2],ne),q(ye,ne),q(Ee,ye),C(Te,Ee,ye),C(R,Te,I),C(R,R,ne),J(R,R),C(R,R,I),C(R,R,ne),C(R,R,ne),C(M[0],R,ne),q(u,M[0]),C(u,u,ne),fe(u,I)&&C(M[0],M[0],L),q(u,M[0]),C(u,u,ne),fe(u,I)?-1:(ue(M[0])===$[31]>>7&&E(M[0],d,M[0]),C(M[3],M[0],M[1]),0)}function Mr(M,$,R){const u=new Uint8Array(32),I=[o(),o(),o(),o()],ne=[o(),o(),o(),o()];if(R.length!==a.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${a.SIGNATURE_LENGTH} bytes`);if(He(ne,M))return!1;const ye=new i.SHA512;ye.update(R.subarray(0,32)),ye.update(M),ye.update($);const Ee=ye.digest();return Z(Ee),g(I,ne,Ee),P(ne,R.subarray(32)),oe(I,ne),De(u,I),!ge(R,u)}a.verify=Mr;function xe(M){let $=[o(),o(),o(),o()];if(He($,M))throw new Error("Ed25519: invalid public key");let R=o(),u=o(),I=$[1];j(R,m,I),E(u,m,I),Q(u,u),C(R,R,u);let ne=new Uint8Array(32);return se(ne,R),ne}a.convertPublicKeyToX25519=xe;function It(M){const $=(0,i.hash)(M.subarray(0,32));$[0]&=248,$[31]&=127,$[31]|=64;const R=new Uint8Array($.subarray(0,32));return(0,n.wipe)($),R}a.convertSecretKeyToX25519=It}(ic)),ic}var lf=v_();const m_="EdDSA",w_="JWT",ff=".",pf="base64url",__="utf8",b_="utf8",E_=":",I_="did",x_="key",tl="base58btc",P_="z",S_="K36",O_=32;function fo(a){return yo(xc(qi(a),__),pf)}function df(a){const r=xc(S_,tl),i=P_+yo(Em([r,a]),tl);return[I_,x_,i].join(E_)}function A_(a){return yo(a,pf)}function R_(a){return xc([fo(a.header),fo(a.payload)].join(ff),b_)}function C_(a){return[fo(a.header),fo(a.payload),A_(a.signature)].join(ff)}function rl(a=Im.randomBytes(O_)){return lf.generateKeyPairFromSeed(a)}async function T_(a,r,i,n,o=de.fromMiliseconds(Date.now())){const h={alg:m_,typ:w_},d=df(n.publicKey),m=o+i,b={iss:d,sub:a,aud:r,iat:o,exp:m},v=R_({header:h,payload:b}),x=lf.sign(n.secretKey,v);return C_({header:h,payload:b,signature:x})}const N_="PARSE_ERROR",D_="INVALID_REQUEST",$_="METHOD_NOT_FOUND",L_="INVALID_PARAMS",gf="INTERNAL_ERROR",Sc="SERVER_ERROR",j_=[-32700,-32600,-32601,-32602,-32603],Hs={[N_]:{code:-32700,message:"Parse error"},[D_]:{code:-32600,message:"Invalid Request"},[$_]:{code:-32601,message:"Method not found"},[L_]:{code:-32602,message:"Invalid params"},[gf]:{code:-32603,message:"Internal error"},[Sc]:{code:-32e3,message:"Server error"}},yf=Sc;function M_(a){return j_.includes(a)}function il(a){return Object.keys(Hs).includes(a)?Hs[a]:Hs[yf]}function z_(a){const r=Object.values(Hs).find(i=>i.code===a);return r||Hs[yf]}function vf(a,r,i){return a.message.includes("getaddrinfo ENOTFOUND")||a.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${i} RPC url at ${r}`):a}var nc={},ni={},sl;function q_(){if(sl)return ni;sl=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.isBrowserCryptoAvailable=ni.getSubtleCrypto=ni.getBrowerCrypto=void 0;function a(){return(Fr===null||Fr===void 0?void 0:Fr.crypto)||(Fr===null||Fr===void 0?void 0:Fr.msCrypto)||{}}ni.getBrowerCrypto=a;function r(){const n=a();return n.subtle||n.webkitSubtle}ni.getSubtleCrypto=r;function i(){return!!a()&&!!r()}return ni.isBrowserCryptoAvailable=i,ni}var oi={},nl;function U_(){if(nl)return oi;nl=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.isBrowser=oi.isNode=oi.isReactNative=void 0;function a(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}oi.isReactNative=a;function r(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}oi.isNode=r;function i(){return!a()&&!r()}return oi.isBrowser=i,oi}var ol;function k_(){return ol||(ol=1,function(a){Object.defineProperty(a,"__esModule",{value:!0});const r=Ks;r.__exportStar(q_(),a),r.__exportStar(U_(),a)}(nc)),nc}var H_=k_();function mf(a=3){const r=Date.now()*Math.pow(10,a),i=Math.floor(Math.random()*Math.pow(10,a));return r+i}function Oc(a=6){return BigInt(mf(a))}function wo(a,r,i){return{id:i||mf(),jsonrpc:"2.0",method:a,params:r}}function Ac(a,r){return{id:a,jsonrpc:"2.0",result:r}}function _o(a,r,i){return{id:a,jsonrpc:"2.0",error:K_(r)}}function K_(a,r){return typeof a>"u"?il(gf):(typeof a=="string"&&(a=Object.assign(Object.assign({},il(Sc)),{message:a})),M_(a.code)&&(a=z_(a.code)),a)}class B_{}class V_ extends B_{constructor(){super()}}class F_ extends V_{constructor(r){super()}}const G_="^https?:",W_="^wss?:";function J_(a){const r=a.match(new RegExp(/^\w+:/,"gi"));if(!(!r||!r.length))return r[0]}function wf(a,r){const i=J_(a);return typeof i>"u"?!1:new RegExp(r).test(i)}function al(a){return wf(a,G_)}function cl(a){return wf(a,W_)}function Y_(a){return new RegExp("wss?://localhost(:d{2,5})?").test(a)}function _f(a){return typeof a=="object"&&"id"in a&&"jsonrpc"in a&&a.jsonrpc==="2.0"}function Rc(a){return _f(a)&&"method"in a}function bo(a){return _f(a)&&(ai(a)||jr(a))}function ai(a){return"result"in a}function jr(a){return"error"in a}class Ei extends F_{constructor(r){super(r),this.events=new Ar.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(r),this.connection.connected&&this.registerEventListeners()}async connect(r=this.connection){await this.open(r)}async disconnect(){await this.close()}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}off(r,i){this.events.off(r,i)}removeListener(r,i){this.events.removeListener(r,i)}async request(r,i){return this.requestStrict(wo(r.method,r.params||[],r.id||Oc().toString()),i)}async requestStrict(r,i){return new Promise(async(n,o)=>{if(!this.connection.connected)try{await this.open()}catch(h){o(h)}this.events.on(`${r.id}`,h=>{jr(h)?o(h.error):n(h.result)});try{await this.connection.send(r,i)}catch(h){o(h)}})}setConnection(r=this.connection){return r}onPayload(r){this.events.emit("payload",r),bo(r)?this.events.emit(`${r.id}`,r):this.events.emit("message",{type:r.method,data:r.params})}onClose(r){r&&r.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${r.code} ${r.reason?`(${r.reason})`:""}`)),this.events.emit("disconnect")}async open(r=this.connection){this.connection===r&&this.connection.connected||(this.connection.connected&&this.close(),typeof r=="string"&&(await this.connection.open(r),r=this.connection),this.connection=this.setConnection(r),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",r=>this.onPayload(r)),this.connection.on("close",r=>this.onClose(r)),this.connection.on("error",r=>this.events.emit("error",r)),this.connection.on("register_error",r=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Z_=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),X_=()=>typeof window<"u",ul=a=>a.split("?")[0],hl=10,Q_=Z_();class eb{constructor(r){if(this.url=r,this.events=new Ar.EventEmitter,this.registering=!1,!cl(r))throw new Error(`Provided URL is not compatible with WebSocket connection: ${r}`);this.url=r}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}off(r,i){this.events.off(r,i)}removeListener(r,i){this.events.removeListener(r,i)}async open(r=this.url){await this.register(r)}async close(){return new Promise((r,i)=>{if(typeof this.socket>"u"){i(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),r()},this.socket.close()})}async send(r,i){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(qi(r))}catch(n){this.onError(r.id,n)}}register(r=this.url){if(!cl(r))throw new Error(`Provided URL is not compatible with WebSocket connection: ${r}`);if(this.registering){const i=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=i||this.events.listenerCount("open")>=i)&&this.events.setMaxListeners(i+1),new Promise((n,o)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),o(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=r,this.registering=!0,new Promise((i,n)=>{const o=H_.isReactNative()?void 0:{rejectUnauthorized:!Y_(r)},h=new Q_(r,[],o);X_()?h.onerror=d=>{const m=d;n(this.emitError(m.error))}:h.on("error",d=>{n(this.emitError(d))}),h.onopen=()=>{this.onOpen(h),i(h)}})}onOpen(r){r.onmessage=i=>this.onPayload(i),r.onclose=i=>this.onClose(i),this.socket=r,this.registering=!1,this.events.emit("open")}onClose(r){this.socket=void 0,this.registering=!1,this.events.emit("close",r)}onPayload(r){if(typeof r.data>"u")return;const i=typeof r.data=="string"?Vs(r.data):r.data;this.events.emit("payload",i)}onError(r,i){const n=this.parseError(i),o=n.message||n.toString(),h=_o(r,o);this.events.emit("payload",h)}parseError(r,i=this.url){return vf(r,ul(i),"WS")}resetMaxListeners(){this.events.getMaxListeners()>hl&&this.events.setMaxListeners(hl)}emitError(r){const i=this.parseError(new Error((r==null?void 0:r.message)||`WebSocket connection failed for host: ${ul(this.url)}`));return this.events.emit("register_error",i),i}}var qs={exports:{}};qs.exports;var ll;function tb(){return ll||(ll=1,function(a,r){var i=200,n="__lodash_hash_undefined__",o=1,h=2,d=9007199254740991,m="[object Arguments]",b="[object Array]",v="[object AsyncFunction]",x="[object Boolean]",N="[object Date]",L="[object Error]",K="[object Function]",T="[object GeneratorFunction]",W="[object Map]",se="[object Number]",ge="[object Null]",fe="[object Object]",ue="[object Promise]",z="[object Proxy]",j="[object RegExp]",E="[object Set]",C="[object String]",q="[object Symbol]",Q="[object Undefined]",J="[object WeakMap]",oe="[object ArrayBuffer]",be="[object DataView]",De="[object Float32Array]",g="[object Float64Array]",P="[object Int8Array]",te="[object Int16Array]",pe="[object Int32Array]",Y="[object Uint8Array]",V="[object Uint8ClampedArray]",G="[object Uint16Array]",Z="[object Uint32Array]",We=/[\\^$.*+?()[\]{}|]/g,He=/^\[object .+?Constructor\]$/,Mr=/^(?:0|[1-9]\d*)$/,xe={};xe[De]=xe[g]=xe[P]=xe[te]=xe[pe]=xe[Y]=xe[V]=xe[G]=xe[Z]=!0,xe[m]=xe[b]=xe[oe]=xe[x]=xe[be]=xe[N]=xe[L]=xe[K]=xe[W]=xe[se]=xe[fe]=xe[j]=xe[E]=xe[C]=xe[J]=!1;var It=typeof Fr=="object"&&Fr&&Fr.Object===Object&&Fr,M=typeof self=="object"&&self&&self.Object===Object&&self,$=It||M||Function("return this")(),R=r&&!r.nodeType&&r,u=R&&!0&&a&&!a.nodeType&&a,I=u&&u.exports===R,ne=I&&It.process,ye=function(){try{return ne&&ne.binding&&ne.binding("util")}catch{}}(),Ee=ye&&ye.isTypedArray;function Te(y,S){for(var B=-1,ee=y==null?0:y.length,Ve=0,me=[];++B<ee;){var Qe=y[B];S(Qe,B,y)&&(me[Ve++]=Qe)}return me}function $e(y,S){for(var B=-1,ee=S.length,Ve=y.length;++B<ee;)y[Ve+B]=S[B];return y}function Oe(y,S){for(var B=-1,ee=y==null?0:y.length;++B<ee;)if(S(y[B],B,y))return!0;return!1}function xt(y,S){for(var B=-1,ee=Array(y);++B<y;)ee[B]=S(B);return ee}function vt(y){return function(S){return y(S)}}function st(y,S){return y.has(S)}function je(y,S){return y==null?void 0:y[S]}function Ye(y){var S=-1,B=Array(y.size);return y.forEach(function(ee,Ve){B[++S]=[Ve,ee]}),B}function Ze(y,S){return function(B){return y(S(B))}}function nt(y){var S=-1,B=Array(y.size);return y.forEach(function(ee){B[++S]=ee}),B}var Ue=Array.prototype,Xe=Function.prototype,Ne=Object.prototype,Ke=$["__core-js_shared__"],ct=Xe.toString,ze=Ne.hasOwnProperty,Pt=function(){var y=/[^.]+$/.exec(Ke&&Ke.keys&&Ke.keys.IE_PROTO||"");return y?"Symbol(src)_1."+y:""}(),$t=Ne.toString,kt=RegExp("^"+ct.call(ze).replace(We,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ht=I?$.Buffer:void 0,Mt=$.Symbol,Gt=$.Uint8Array,er=Ne.propertyIsEnumerable,zr=Ue.splice,Wt=Mt?Mt.toStringTag:void 0,Gr=Object.getOwnPropertySymbols,ci=Ht?Ht.isBuffer:void 0,xi=Ze(Object.keys,Object),ut=ur($,"DataView"),tt=ur($,"Map"),ht=ur($,"Promise"),lt=ur($,"Set"),ot=ur($,"WeakMap"),rt=ur(Object,"create"),St=Jr(ut),Ot=Jr(tt),ft=Jr(ht),At=Jr(lt),pt=Jr(ot),mt=Mt?Mt.prototype:void 0,dt=mt?mt.valueOf:void 0;function Je(y){var S=-1,B=y==null?0:y.length;for(this.clear();++S<B;){var ee=y[S];this.set(ee[0],ee[1])}}function Rt(){this.__data__=rt?rt(null):{},this.size=0}function Ct(y){var S=this.has(y)&&delete this.__data__[y];return this.size-=S?1:0,S}function xo(y){var S=this.__data__;if(rt){var B=S[y];return B===n?void 0:B}return ze.call(S,y)?S[y]:void 0}function Po(y){var S=this.__data__;return rt?S[y]!==void 0:ze.call(S,y)}function So(y,S){var B=this.__data__;return this.size+=this.has(y)?0:1,B[y]=rt&&S===void 0?n:S,this}Je.prototype.clear=Rt,Je.prototype.delete=Ct,Je.prototype.get=xo,Je.prototype.has=Po,Je.prototype.set=So;function yr(y){var S=-1,B=y==null?0:y.length;for(this.clear();++S<B;){var ee=y[S];this.set(ee[0],ee[1])}}function Oo(){this.__data__=[],this.size=0}function Ao(y){var S=this.__data__,B=Pi(S,y);if(B<0)return!1;var ee=S.length-1;return B==ee?S.pop():zr.call(S,B,1),--this.size,!0}function Ro(y){var S=this.__data__,B=Pi(S,y);return B<0?void 0:S[B][1]}function Co(y){return Pi(this.__data__,y)>-1}function To(y,S){var B=this.__data__,ee=Pi(B,y);return ee<0?(++this.size,B.push([y,S])):B[ee][1]=S,this}yr.prototype.clear=Oo,yr.prototype.delete=Ao,yr.prototype.get=Ro,yr.prototype.has=Co,yr.prototype.set=To;function Wr(y){var S=-1,B=y==null?0:y.length;for(this.clear();++S<B;){var ee=y[S];this.set(ee[0],ee[1])}}function Ki(){this.size=0,this.__data__={hash:new Je,map:new(tt||yr),string:new Je}}function No(y){var S=ui(this,y).delete(y);return this.size-=S?1:0,S}function Bi(y){return ui(this,y).get(y)}function Do(y){return ui(this,y).has(y)}function $o(y,S){var B=ui(this,y),ee=B.size;return B.set(y,S),this.size+=B.size==ee?0:1,this}Wr.prototype.clear=Ki,Wr.prototype.delete=No,Wr.prototype.get=Bi,Wr.prototype.has=Do,Wr.prototype.set=$o;function Vi(y){var S=-1,B=y==null?0:y.length;for(this.__data__=new Wr;++S<B;)this.add(y[S])}function Js(y){return this.__data__.set(y,n),this}function Ys(y){return this.__data__.has(y)}Vi.prototype.add=Vi.prototype.push=Js,Vi.prototype.has=Ys;function Rr(y){var S=this.__data__=new yr(y);this.size=S.size}function Lo(){this.__data__=new yr,this.size=0}function jo(y){var S=this.__data__,B=S.delete(y);return this.size=S.size,B}function Mo(y){return this.__data__.get(y)}function zo(y){return this.__data__.has(y)}function Zs(y,S){var B=this.__data__;if(B instanceof yr){var ee=B.__data__;if(!tt||ee.length<i-1)return ee.push([y,S]),this.size=++B.size,this;B=this.__data__=new Wr(ee)}return B.set(y,S),this.size=B.size,this}Rr.prototype.clear=Lo,Rr.prototype.delete=jo,Rr.prototype.get=Mo,Rr.prototype.has=zo,Rr.prototype.set=Zs;function Xs(y,S){var B=Wi(y),ee=!B&&ln(y),Ve=!B&&!ee&&gs(y),me=!B&&!ee&&!Ve&&dn(y),Qe=B||ee||Ve||me,Tt=Qe?xt(y.length,String):[],Re=Tt.length;for(var Fe in y)ze.call(y,Fe)&&!(Qe&&(Fe=="length"||Ve&&(Fe=="offset"||Fe=="parent")||me&&(Fe=="buffer"||Fe=="byteLength"||Fe=="byteOffset")||on(Fe,Re)))&&Tt.push(Fe);return Tt}function Pi(y,S){for(var B=y.length;B--;)if(hn(y[B][0],S))return B;return-1}function ps(y,S,B){var ee=S(y);return Wi(y)?ee:$e(ee,B(y))}function Si(y){return y==null?y===void 0?Q:ge:Wt&&Wt in Object(y)?sn(y):ko(y)}function ds(y){return Ai(y)&&Si(y)==m}function Oi(y,S,B,ee,Ve){return y===S?!0:y==null||S==null||!Ai(y)&&!Ai(S)?y!==y&&S!==S:Qs(y,S,B,ee,Oi,Ve)}function Qs(y,S,B,ee,Ve,me){var Qe=Wi(y),Tt=Wi(S),Re=Qe?b:qr(y),Fe=Tt?b:qr(S);Re=Re==m?fe:Re,Fe=Fe==m?fe:Fe;var wt=Re==fe,tr=Fe==fe,Nt=Re==Fe;if(Nt&&gs(y)){if(!gs(S))return!1;Qe=!0,wt=!1}if(Nt&&!wt)return me||(me=new Rr),Qe||dn(y)?Fi(y,S,B,ee,Ve,me):Uo(y,S,Re,B,ee,Ve,me);if(!(B&o)){var et=wt&&ze.call(y,"__wrapped__"),Jt=tr&&ze.call(S,"__wrapped__");if(et||Jt){var Cr=et?y.value():y,vr=Jt?S.value():S;return me||(me=new Rr),Ve(Cr,vr,B,ee,me)}}return Nt?(me||(me=new Rr),rn(y,S,B,ee,Ve,me)):!1}function qo(y){if(!pn(y)||cn(y))return!1;var S=Ji(y)?kt:He;return S.test(Jr(y))}function en(y){return Ai(y)&&fn(y.length)&&!!xe[Si(y)]}function tn(y){if(!un(y))return xi(y);var S=[];for(var B in Object(y))ze.call(y,B)&&B!="constructor"&&S.push(B);return S}function Fi(y,S,B,ee,Ve,me){var Qe=B&o,Tt=y.length,Re=S.length;if(Tt!=Re&&!(Qe&&Re>Tt))return!1;var Fe=me.get(y);if(Fe&&me.get(S))return Fe==S;var wt=-1,tr=!0,Nt=B&h?new Vi:void 0;for(me.set(y,S),me.set(S,y);++wt<Tt;){var et=y[wt],Jt=S[wt];if(ee)var Cr=Qe?ee(Jt,et,wt,S,y,me):ee(et,Jt,wt,y,S,me);if(Cr!==void 0){if(Cr)continue;tr=!1;break}if(Nt){if(!Oe(S,function(vr,Ur){if(!st(Nt,Ur)&&(et===vr||Ve(et,vr,B,ee,me)))return Nt.push(Ur)})){tr=!1;break}}else if(!(et===Jt||Ve(et,Jt,B,ee,me))){tr=!1;break}}return me.delete(y),me.delete(S),tr}function Uo(y,S,B,ee,Ve,me,Qe){switch(B){case be:if(y.byteLength!=S.byteLength||y.byteOffset!=S.byteOffset)return!1;y=y.buffer,S=S.buffer;case oe:return!(y.byteLength!=S.byteLength||!me(new Gt(y),new Gt(S)));case x:case N:case se:return hn(+y,+S);case L:return y.name==S.name&&y.message==S.message;case j:case C:return y==S+"";case W:var Tt=Ye;case E:var Re=ee&o;if(Tt||(Tt=nt),y.size!=S.size&&!Re)return!1;var Fe=Qe.get(y);if(Fe)return Fe==S;ee|=h,Qe.set(y,S);var wt=Fi(Tt(y),Tt(S),ee,Ve,me,Qe);return Qe.delete(y),wt;case q:if(dt)return dt.call(y)==dt.call(S)}return!1}function rn(y,S,B,ee,Ve,me){var Qe=B&o,Tt=Gi(y),Re=Tt.length,Fe=Gi(S),wt=Fe.length;if(Re!=wt&&!Qe)return!1;for(var tr=Re;tr--;){var Nt=Tt[tr];if(!(Qe?Nt in S:ze.call(S,Nt)))return!1}var et=me.get(y);if(et&&me.get(S))return et==S;var Jt=!0;me.set(y,S),me.set(S,y);for(var Cr=Qe;++tr<Re;){Nt=Tt[tr];var vr=y[Nt],Ur=S[Nt];if(ee)var ys=Qe?ee(Ur,vr,Nt,S,y,me):ee(vr,Ur,Nt,y,S,me);if(!(ys===void 0?vr===Ur||Ve(vr,Ur,B,ee,me):ys)){Jt=!1;break}Cr||(Cr=Nt=="constructor")}if(Jt&&!Cr){var Ri=y.constructor,zt=S.constructor;Ri!=zt&&"constructor"in y&&"constructor"in S&&!(typeof Ri=="function"&&Ri instanceof Ri&&typeof zt=="function"&&zt instanceof zt)&&(Jt=!1)}return me.delete(y),me.delete(S),Jt}function Gi(y){return ps(y,Bo,nn)}function ui(y,S){var B=y.__data__;return an(S)?B[typeof S=="string"?"string":"hash"]:B.map}function ur(y,S){var B=je(y,S);return qo(B)?B:void 0}function sn(y){var S=ze.call(y,Wt),B=y[Wt];try{y[Wt]=void 0;var ee=!0}catch{}var Ve=$t.call(y);return ee&&(S?y[Wt]=B:delete y[Wt]),Ve}var nn=Gr?function(y){return y==null?[]:(y=Object(y),Te(Gr(y),function(S){return er.call(y,S)}))}:Be,qr=Si;(ut&&qr(new ut(new ArrayBuffer(1)))!=be||tt&&qr(new tt)!=W||ht&&qr(ht.resolve())!=ue||lt&&qr(new lt)!=E||ot&&qr(new ot)!=J)&&(qr=function(y){var S=Si(y),B=S==fe?y.constructor:void 0,ee=B?Jr(B):"";if(ee)switch(ee){case St:return be;case Ot:return W;case ft:return ue;case At:return E;case pt:return J}return S});function on(y,S){return S=S??d,!!S&&(typeof y=="number"||Mr.test(y))&&y>-1&&y%1==0&&y<S}function an(y){var S=typeof y;return S=="string"||S=="number"||S=="symbol"||S=="boolean"?y!=="__proto__":y===null}function cn(y){return!!Pt&&Pt in y}function un(y){var S=y&&y.constructor,B=typeof S=="function"&&S.prototype||Ne;return y===B}function ko(y){return $t.call(y)}function Jr(y){if(y!=null){try{return ct.call(y)}catch{}try{return y+""}catch{}}return""}function hn(y,S){return y===S||y!==y&&S!==S}var ln=ds(function(){return arguments}())?ds:function(y){return Ai(y)&&ze.call(y,"callee")&&!er.call(y,"callee")},Wi=Array.isArray;function Ho(y){return y!=null&&fn(y.length)&&!Ji(y)}var gs=ci||ke;function Ko(y,S){return Oi(y,S)}function Ji(y){if(!pn(y))return!1;var S=Si(y);return S==K||S==T||S==v||S==z}function fn(y){return typeof y=="number"&&y>-1&&y%1==0&&y<=d}function pn(y){var S=typeof y;return y!=null&&(S=="object"||S=="function")}function Ai(y){return y!=null&&typeof y=="object"}var dn=Ee?vt(Ee):en;function Bo(y){return Ho(y)?Xs(y):tn(y)}function Be(){return[]}function ke(){return!1}a.exports=Ko}(qs,qs.exports)),qs.exports}var rb=tb();const ib=go(rb);var sb={};function nb(a,r){if(a.length>=255)throw new TypeError("Alphabet too long");for(var i=new Uint8Array(256),n=0;n<i.length;n++)i[n]=255;for(var o=0;o<a.length;o++){var h=a.charAt(o),d=h.charCodeAt(0);if(i[d]!==255)throw new TypeError(h+" is ambiguous");i[d]=o}var m=a.length,b=a.charAt(0),v=Math.log(m)/Math.log(256),x=Math.log(256)/Math.log(m);function N(T){if(T instanceof Uint8Array||(ArrayBuffer.isView(T)?T=new Uint8Array(T.buffer,T.byteOffset,T.byteLength):Array.isArray(T)&&(T=Uint8Array.from(T))),!(T instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(T.length===0)return"";for(var W=0,se=0,ge=0,fe=T.length;ge!==fe&&T[ge]===0;)ge++,W++;for(var ue=(fe-ge)*x+1>>>0,z=new Uint8Array(ue);ge!==fe;){for(var j=T[ge],E=0,C=ue-1;(j!==0||E<se)&&C!==-1;C--,E++)j+=256*z[C]>>>0,z[C]=j%m>>>0,j=j/m>>>0;if(j!==0)throw new Error("Non-zero carry");se=E,ge++}for(var q=ue-se;q!==ue&&z[q]===0;)q++;for(var Q=b.repeat(W);q<ue;++q)Q+=a.charAt(z[q]);return Q}function L(T){if(typeof T!="string")throw new TypeError("Expected String");if(T.length===0)return new Uint8Array;var W=0;if(T[W]!==" "){for(var se=0,ge=0;T[W]===b;)se++,W++;for(var fe=(T.length-W)*v+1>>>0,ue=new Uint8Array(fe);T[W];){var z=i[T.charCodeAt(W)];if(z===255)return;for(var j=0,E=fe-1;(z!==0||j<ge)&&E!==-1;E--,j++)z+=m*ue[E]>>>0,ue[E]=z%256>>>0,z=z/256>>>0;if(z!==0)throw new Error("Non-zero carry");ge=j,W++}if(T[W]!==" "){for(var C=fe-ge;C!==fe&&ue[C]===0;)C++;for(var q=new Uint8Array(se+(fe-C)),Q=se;C!==fe;)q[Q++]=ue[C++];return q}}}function K(T){var W=L(T);if(W)return W;throw new Error(`Non-${r} character`)}return{encode:N,decodeUnsafe:L,decode:K}}var ob=nb,ab=ob;const bf=a=>{if(a instanceof Uint8Array&&a.constructor.name==="Uint8Array")return a;if(a instanceof ArrayBuffer)return new Uint8Array(a);if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);throw new Error("Unknown type, must be binary type")},cb=a=>new TextEncoder().encode(a),ub=a=>new TextDecoder().decode(a);class hb{constructor(r,i,n){this.name=r,this.prefix=i,this.baseEncode=n}encode(r){if(r instanceof Uint8Array)return`${this.prefix}${this.baseEncode(r)}`;throw Error("Unknown type, must be binary type")}}class lb{constructor(r,i,n){if(this.name=r,this.prefix=i,i.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=i.codePointAt(0),this.baseDecode=n}decode(r){if(typeof r=="string"){if(r.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(r)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(r.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(r){return Ef(this,r)}}class fb{constructor(r){this.decoders=r}or(r){return Ef(this,r)}decode(r){const i=r[0],n=this.decoders[i];if(n)return n.decode(r);throw RangeError(`Unable to decode multibase string ${JSON.stringify(r)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Ef=(a,r)=>new fb({...a.decoders||{[a.prefix]:a},...r.decoders||{[r.prefix]:r}});class pb{constructor(r,i,n,o){this.name=r,this.prefix=i,this.baseEncode=n,this.baseDecode=o,this.encoder=new hb(r,i,n),this.decoder=new lb(r,i,o)}encode(r){return this.encoder.encode(r)}decode(r){return this.decoder.decode(r)}}const Eo=({name:a,prefix:r,encode:i,decode:n})=>new pb(a,r,i,n),Ws=({prefix:a,name:r,alphabet:i})=>{const{encode:n,decode:o}=ab(i,r);return Eo({prefix:a,name:r,encode:n,decode:h=>bf(o(h))})},db=(a,r,i,n)=>{const o={};for(let x=0;x<r.length;++x)o[r[x]]=x;let h=a.length;for(;a[h-1]==="=";)--h;const d=new Uint8Array(h*i/8|0);let m=0,b=0,v=0;for(let x=0;x<h;++x){const N=o[a[x]];if(N===void 0)throw new SyntaxError(`Non-${n} character`);b=b<<i|N,m+=i,m>=8&&(m-=8,d[v++]=255&b>>m)}if(m>=i||255&b<<8-m)throw new SyntaxError("Unexpected end of data");return d},gb=(a,r,i)=>{const n=r[r.length-1]==="=",o=(1<<i)-1;let h="",d=0,m=0;for(let b=0;b<a.length;++b)for(m=m<<8|a[b],d+=8;d>i;)d-=i,h+=r[o&m>>d];if(d&&(h+=r[o&m<<i-d]),n)for(;h.length*i&7;)h+="=";return h},Bt=({name:a,prefix:r,bitsPerChar:i,alphabet:n})=>Eo({prefix:r,name:a,encode(o){return gb(o,n,i)},decode(o){return db(o,n,i,a)}}),yb=Eo({prefix:"\0",name:"identity",encode:a=>ub(a),decode:a=>cb(a)});var vb=Object.freeze({__proto__:null,identity:yb});const mb=Bt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var wb=Object.freeze({__proto__:null,base2:mb});const _b=Bt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var bb=Object.freeze({__proto__:null,base8:_b});const Eb=Ws({prefix:"9",name:"base10",alphabet:"0123456789"});var Ib=Object.freeze({__proto__:null,base10:Eb});const xb=Bt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Pb=Bt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Sb=Object.freeze({__proto__:null,base16:xb,base16upper:Pb});const Ob=Bt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ab=Bt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Rb=Bt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Cb=Bt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Tb=Bt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Nb=Bt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Db=Bt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),$b=Bt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Lb=Bt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var jb=Object.freeze({__proto__:null,base32:Ob,base32upper:Ab,base32pad:Rb,base32padupper:Cb,base32hex:Tb,base32hexupper:Nb,base32hexpad:Db,base32hexpadupper:$b,base32z:Lb});const Mb=Ws({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),zb=Ws({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var qb=Object.freeze({__proto__:null,base36:Mb,base36upper:zb});const Ub=Ws({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),kb=Ws({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Hb=Object.freeze({__proto__:null,base58btc:Ub,base58flickr:kb});const Kb=Bt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Bb=Bt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Vb=Bt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Fb=Bt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Gb=Object.freeze({__proto__:null,base64:Kb,base64pad:Bb,base64url:Vb,base64urlpad:Fb});const If=Array.from(""),Wb=If.reduce((a,r,i)=>(a[i]=r,a),[]),Jb=If.reduce((a,r,i)=>(a[r.codePointAt(0)]=i,a),[]);function Yb(a){return a.reduce((r,i)=>(r+=Wb[i],r),"")}function Zb(a){const r=[];for(const i of a){const n=Jb[i.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${i}`);r.push(n)}return new Uint8Array(r)}const Xb=Eo({prefix:"",name:"base256emoji",encode:Yb,decode:Zb});var Qb=Object.freeze({__proto__:null,base256emoji:Xb}),e1=xf,fl=128,t1=127,r1=~t1,i1=Math.pow(2,31);function xf(a,r,i){r=r||[],i=i||0;for(var n=i;a>=i1;)r[i++]=a&255|fl,a/=128;for(;a&r1;)r[i++]=a&255|fl,a>>>=7;return r[i]=a|0,xf.bytes=i-n+1,r}var s1=mc,n1=128,pl=127;function mc(a,n){var i=0,n=n||0,o=0,h=n,d,m=a.length;do{if(h>=m)throw mc.bytes=0,new RangeError("Could not decode varint");d=a[h++],i+=o<28?(d&pl)<<o:(d&pl)*Math.pow(2,o),o+=7}while(d>=n1);return mc.bytes=h-n,i}var o1=Math.pow(2,7),a1=Math.pow(2,14),c1=Math.pow(2,21),u1=Math.pow(2,28),h1=Math.pow(2,35),l1=Math.pow(2,42),f1=Math.pow(2,49),p1=Math.pow(2,56),d1=Math.pow(2,63),g1=function(a){return a<o1?1:a<a1?2:a<c1?3:a<u1?4:a<h1?5:a<l1?6:a<f1?7:a<p1?8:a<d1?9:10},y1={encode:e1,decode:s1,encodingLength:g1},Pf=y1;const dl=(a,r,i=0)=>(Pf.encode(a,r,i),r),gl=a=>Pf.encodingLength(a),wc=(a,r)=>{const i=r.byteLength,n=gl(a),o=n+gl(i),h=new Uint8Array(o+i);return dl(a,h,0),dl(i,h,n),h.set(r,o),new v1(a,i,r,h)};class v1{constructor(r,i,n,o){this.code=r,this.size=i,this.digest=n,this.bytes=o}}const Sf=({name:a,code:r,encode:i})=>new m1(a,r,i);class m1{constructor(r,i,n){this.name=r,this.code=i,this.encode=n}digest(r){if(r instanceof Uint8Array){const i=this.encode(r);return i instanceof Uint8Array?wc(this.code,i):i.then(n=>wc(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Of=a=>async r=>new Uint8Array(await crypto.subtle.digest(a,r)),w1=Sf({name:"sha2-256",code:18,encode:Of("SHA-256")}),_1=Sf({name:"sha2-512",code:19,encode:Of("SHA-512")});var b1=Object.freeze({__proto__:null,sha256:w1,sha512:_1});const Af=0,E1="identity",Rf=bf,I1=a=>wc(Af,Rf(a)),x1={code:Af,name:E1,encode:Rf,digest:I1};var P1=Object.freeze({__proto__:null,identity:x1});new TextEncoder,new TextDecoder;const yl={...vb,...wb,...bb,...Ib,...Sb,...jb,...qb,...Hb,...Gb,...Qb};({...b1,...P1});function Cf(a){return globalThis.Buffer!=null?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):a}function S1(a=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Cf(globalThis.Buffer.allocUnsafe(a)):new Uint8Array(a)}function Tf(a,r,i,n){return{name:a,prefix:r,encoder:{name:a,prefix:r,encode:i},decoder:{decode:n}}}const vl=Tf("utf8","u",a=>"u"+new TextDecoder("utf8").decode(a),a=>new TextEncoder().encode(a.substring(1))),oc=Tf("ascii","a",a=>{let r="a";for(let i=0;i<a.length;i++)r+=String.fromCharCode(a[i]);return r},a=>{a=a.substring(1);const r=S1(a.length);for(let i=0;i<a.length;i++)r[i]=a.charCodeAt(i);return r}),O1={utf8:vl,"utf-8":vl,hex:yl.base16,latin1:oc,ascii:oc,binary:oc,...yl};function A1(a,r="utf8"){const i=O1[r];if(!i)throw new Error(`Unsupported encoding "${r}"`);return(r==="utf8"||r==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Cf(globalThis.Buffer.from(a,"utf-8")):i.decoder.decode(`${i.prefix}${a}`)}const Nf="wc",R1=2,Cc="core",bi=`${Nf}@2:${Cc}:`,C1={name:Cc,logger:"error"},T1={database:":memory:"},N1="crypto",ml="client_ed25519_seed",D1=de.ONE_DAY,$1="keychain",L1="0.3",j1="messages",M1="0.3",z1=de.SIX_HOURS,q1="publisher",Df="irn",U1="error",$f="wss://relay.walletconnect.com",wl="wss://relay.walletconnect.org",k1="relayer",yt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},H1="_subscription",$s={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},K1=de.ONE_SECOND/2,B1="2.9.0",V1=1e4,F1="0.3",G1="WALLETCONNECT_CLIENT_ID",Vr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},W1="subscription",J1="0.3",Y1=de.FIVE_SECONDS*1e3,Z1="pairing",X1="0.3",Ls={wc_pairingDelete:{req:{ttl:de.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:de.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:de.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:de.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:de.ONE_DAY,prompt:!1,tag:0},res:{ttl:de.ONE_DAY,prompt:!1,tag:0}}},Br={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Q1="history",eE="0.3",tE="expirer",Sr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},rE="0.3",ac="verify-api",_l="https://verify.walletconnect.com";class iE{constructor(r,i){this.core=r,this.logger=i,this.keychain=new Map,this.name=$1,this.version=L1,this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,o)=>{this.isInitialized(),this.keychain.set(n,o),await this.persist()},this.get=n=>{this.isInitialized();const o=this.keychain.get(n);if(typeof o>"u"){const{message:h}=ie("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(h)}return o},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=r,this.logger=gr(i,this.name)}get context(){return cr(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(r){await this.core.storage.setItem(this.storageKey,rf(r))}async getKeyChain(){const r=await this.core.storage.getItem(this.storageKey);return typeof r<"u"?sf(r):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:r}=ie("NOT_INITIALIZED",this.name);throw new Error(r)}}}class sE{constructor(r,i,n){this.core=r,this.logger=i,this.name=N1,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),h=rl(o);return df(h.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=Sm();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const h=await this.getClientSeed(),d=rl(h),m=gc();return await T_(m,o,D1,d)},this.generateSharedKey=(o,h,d)=>{this.isInitialized();const m=this.getPrivateKey(o),b=Om(m,h);return this.setSymKey(b,d)},this.setSymKey=async(o,h)=>{this.isInitialized();const d=h||Am(o);return await this.keychain.set(d,o),d},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,h,d)=>{this.isInitialized();const m=Rm(d),b=qi(h);if($h(m)){const L=m.senderPublicKey,K=m.receiverPublicKey;o=await this.generateSharedKey(L,K)}const v=this.getSymKey(o),{type:x,senderPublicKey:N}=m;return Cm({type:x,symKey:v,message:b,senderPublicKey:N})},this.decode=async(o,h,d)=>{this.isInitialized();const m=Tm(h,d);if($h(m)){const x=m.receiverPublicKey,N=m.senderPublicKey;o=await this.generateSharedKey(x,N)}const b=this.getSymKey(o),v=Nm({symKey:b,encoded:h});return Vs(v)},this.getPayloadType=o=>{const h=Lh(o);return Dm(h.type)},this.getPayloadSenderPublicKey=o=>{const h=Lh(o);return h.senderPublicKey?yo(h.senderPublicKey,$m):void 0},this.core=r,this.logger=gr(i,this.name),this.keychain=n||new iE(this.core,this.logger)}get context(){return cr(this.logger)}async setPrivateKey(r,i){return await this.keychain.set(r,i),r}getPrivateKey(r){return this.keychain.get(r)}async getClientSeed(){let r="";try{r=this.keychain.get(ml)}catch{r=gc(),await this.keychain.set(ml,r)}return A1(r,"base16")}getSymKey(r){return this.keychain.get(r)}isInitialized(){if(!this.initialized){const{message:r}=ie("NOT_INITIALIZED",this.name);throw new Error(r)}}}class nE extends a_{constructor(r,i){super(r,i),this.logger=r,this.core=i,this.messages=new Map,this.name=j1,this.version=M1,this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,o)=>{this.isInitialized();const h=ls(o);let d=this.messages.get(n);return typeof d>"u"&&(d={}),typeof d[h]<"u"||(d[h]=o,this.messages.set(n,d),await this.persist()),h},this.get=n=>{this.isInitialized();let o=this.messages.get(n);return typeof o>"u"&&(o={}),o},this.has=(n,o)=>{this.isInitialized();const h=this.get(n),d=ls(o);return typeof h[d]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=gr(r,this.name),this.core=i}get context(){return cr(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(r){await this.core.storage.setItem(this.storageKey,rf(r))}async getRelayerMessages(){const r=await this.core.storage.getItem(this.storageKey);return typeof r<"u"?sf(r):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:r}=ie("NOT_INITIALIZED",this.name);throw new Error(r)}}}class oE extends c_{constructor(r,i){super(r,i),this.relayer=r,this.logger=i,this.events=new Ar.EventEmitter,this.name=q1,this.queue=new Map,this.publishTimeout=de.toMiliseconds(de.TEN_SECONDS),this.queueTimeout=de.toMiliseconds(de.FIVE_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,o,h)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:h}});try{const d=(h==null?void 0:h.ttl)||z1,m=yc(h),b=(h==null?void 0:h.prompt)||!1,v=(h==null?void 0:h.tag)||0,x=(h==null?void 0:h.id)||Oc().toString(),N={topic:n,message:o,opts:{ttl:d,relay:m,prompt:b,tag:v,id:x}},L=setTimeout(()=>this.queue.set(x,N),this.queueTimeout);try{await await lo(this.rpcPublish(n,o,d,m,b,v,x),this.publishTimeout),clearTimeout(L),this.relayer.events.emit(yt.publish,N)}catch{this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0;return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:h}})}catch(d){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(d),d}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.relayer=r,this.logger=gr(i,this.name),this.registerEventListeners()}get context(){return cr(this.logger)}rpcPublish(r,i,n,o,h,d,m){var b,v,x,N;const L={method:oo(o.protocol).publish,params:{topic:r,message:i,ttl:n,prompt:h,tag:d},id:m};return _i((b=L.params)==null?void 0:b.prompt)&&((v=L.params)==null||delete v.prompt),_i((x=L.params)==null?void 0:x.tag)&&((N=L.params)==null||delete N.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:L}),this.relayer.request(L)}onPublish(r){this.queue.delete(r)}checkQueue(){this.queue.forEach(async r=>{const{topic:i,message:n,opts:o}=r;await this.publish(i,n,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(Fs.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(yt.connection_stalled);return}this.checkQueue()}),this.relayer.on(yt.message_ack,r=>{this.onPublish(r.id.toString())})}}class aE{constructor(){this.map=new Map,this.set=(r,i)=>{const n=this.get(r);this.exists(r,i)||this.map.set(r,[...n,i])},this.get=r=>this.map.get(r)||[],this.exists=(r,i)=>this.get(r).includes(i),this.delete=(r,i)=>{if(typeof i>"u"){this.map.delete(r);return}if(!this.map.has(r))return;const n=this.get(r);if(!this.exists(r,i))return;const o=n.filter(h=>h!==i);if(!o.length){this.map.delete(r);return}this.map.set(r,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var cE=Object.defineProperty,uE=Object.defineProperties,hE=Object.getOwnPropertyDescriptors,bl=Object.getOwnPropertySymbols,lE=Object.prototype.hasOwnProperty,fE=Object.prototype.propertyIsEnumerable,El=(a,r,i)=>r in a?cE(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,js=(a,r)=>{for(var i in r||(r={}))lE.call(r,i)&&El(a,i,r[i]);if(bl)for(var i of bl(r))fE.call(r,i)&&El(a,i,r[i]);return a},cc=(a,r)=>uE(a,hE(r));class pE extends l_{constructor(r,i){super(r,i),this.relayer=r,this.logger=i,this.subscriptions=new Map,this.topicMap=new aE,this.events=new Ar.EventEmitter,this.name=W1,this.version=J1,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=bi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}});try{const h=yc(o),d={topic:n,relay:h};this.pending.set(n,d);const m=await this.rpcSubscribe(n,h);return this.onSubscribe(m,d),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}}),m}catch(h){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(h),h}},this.unsubscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(n,o.id,o):await this.unsubscribeByTopic(n,o)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((o,h)=>{const d=new de.Watch;d.start(this.pendingSubscriptionWatchLabel);const m=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(m),d.stop(this.pendingSubscriptionWatchLabel),o(!0)),d.elapsed(this.pendingSubscriptionWatchLabel)>=Y1&&(clearInterval(m),d.stop(this.pendingSubscriptionWatchLabel),h(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=r,this.logger=gr(i,this.name),this.clientId=""}get context(){return cr(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(r,i){let n=!1;try{n=this.getSubscription(r).topic===i}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(r,i){const n=this.topicMap.get(r);await Promise.all(n.map(async o=>await this.unsubscribeById(r,o,i)))}async unsubscribeById(r,i,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:r,id:i,opts:n}});try{const o=yc(n);await this.rpcUnsubscribe(r,i,o);const h=Qt("USER_DISCONNECTED",`${this.name}, ${r}`);await this.onUnsubscribe(r,i,h),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:r,id:i,opts:n}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(r,i){const n={method:oo(i.protocol).subscribe,params:{topic:r}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await lo(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(yt.connection_stalled)}return ls(r+this.clientId)}async rpcBatchSubscribe(r){if(!r.length)return;const i=r[0].relay,n={method:oo(i.protocol).batchSubscribe,params:{topics:r.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await lo(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(yt.connection_stalled)}}rpcUnsubscribe(r,i,n){const o={method:oo(n.protocol).unsubscribe,params:{topic:r,id:i}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(r,i){this.setSubscription(r,cc(js({},i),{id:r})),this.pending.delete(i.topic)}onBatchSubscribe(r){r.length&&r.forEach(i=>{this.setSubscription(i.id,js({},i)),this.pending.delete(i.topic)})}async onUnsubscribe(r,i,n){this.events.removeAllListeners(i),this.hasSubscription(i,r)&&this.deleteSubscription(i,n),await this.relayer.messages.del(r)}async setRelayerSubscriptions(r){await this.relayer.core.storage.setItem(this.storageKey,r)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(r,i){this.subscriptions.has(r)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:r,subscription:i}),this.addSubscription(r,i))}addSubscription(r,i){this.subscriptions.set(r,js({},i)),this.topicMap.set(i.topic,r),this.events.emit(Vr.created,i)}getSubscription(r){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:r});const i=this.subscriptions.get(r);if(!i){const{message:n}=ie("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(n)}return i}deleteSubscription(r,i){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:r,reason:i});const n=this.getSubscription(r);this.subscriptions.delete(r),this.topicMap.delete(n.topic,r),this.events.emit(Vr.deleted,cc(js({},n),{reason:i}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Vr.sync)}async reset(){if(this.cached.length){const r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let i=0;i<r;i++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(Vr.resubscribed)}async restore(){try{const r=await this.getRelayerSubscriptions();if(typeof r>"u"||!r.length)return;if(this.subscriptions.size){const{message:i}=ie("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(i)}this.cached=r,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(r){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(r)}}async batchSubscribe(r){if(!r.length)return;const i=await this.rpcBatchSubscribe(r);fs(i)&&this.onBatchSubscribe(i.map((n,o)=>cc(js({},r[o]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const r=[];this.pending.forEach(i=>{r.push(i)}),await this.batchSubscribe(r)}registerEventListeners(){this.relayer.core.heartbeat.on(Fs.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(yt.connect,async()=>{await this.onConnect()}),this.relayer.on(yt.disconnect,()=>{this.onDisconnect()}),this.events.on(Vr.created,async r=>{const i=Vr.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),await this.persist()}),this.events.on(Vr.deleted,async r=>{const i=Vr.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:r}=ie("NOT_INITIALIZED",this.name);throw new Error(r)}}async restartToComplete(){this.restartInProgress&&await new Promise(r=>{const i=setInterval(()=>{this.restartInProgress||(clearInterval(i),r())},this.pollingInterval)})}}var dE=Object.defineProperty,Il=Object.getOwnPropertySymbols,gE=Object.prototype.hasOwnProperty,yE=Object.prototype.propertyIsEnumerable,xl=(a,r,i)=>r in a?dE(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,vE=(a,r)=>{for(var i in r||(r={}))gE.call(r,i)&&xl(a,i,r[i]);if(Il)for(var i of Il(r))yE.call(r,i)&&xl(a,i,r[i]);return a};class mE extends u_{constructor(r){super(r),this.protocol="wc",this.version=2,this.events=new Ar.EventEmitter,this.name=k1,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async i=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(i)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.core=r.core,this.logger=typeof r.logger<"u"&&typeof r.logger!="string"?gr(r.logger,this.name):vo(mo({level:r.logger||U1})),this.messages=new nE(this.logger,r.core),this.subscriber=new pE(this,this.logger),this.publisher=new oE(this,this.logger),this.relayUrl=(r==null?void 0:r.relayUrl)||$f,this.projectId=r.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${wl}...`),await this.restartTransport(wl)}this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},V1)}get context(){return cr(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(r,i,n){this.isInitialized(),await this.publisher.publish(r,i,n),await this.recordMessageEvent({topic:r,message:i,publishedAt:Date.now()})}async subscribe(r,i){var n;this.isInitialized();let o=((n=this.subscriber.topicMap.get(r))==null?void 0:n[0])||"";return o||(await Promise.all([new Promise(h=>{this.subscriber.once(Vr.created,d=>{d.topic===r&&h()})}),new Promise(async h=>{o=await this.subscriber.subscribe(r,i),h()})]),o)}async unsubscribe(r,i){this.isInitialized(),await this.subscriber.unsubscribe(r,i)}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}off(r,i){this.events.off(r,i)}removeListener(r,i){this.events.removeListener(r,i)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(yt.transport_closed))}async transportOpen(r){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=r||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(i=>{this.initialized||i(),this.subscriber.once(Vr.resubscribed,()=>{i()})}),await Promise.race([new Promise(async(i,n)=>{await lo(this.provider.connect(),5e3,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>n(o)).then(()=>i()).finally(()=>this.removeListener(yt.transport_closed,this.rejectTransportOpen))}),new Promise(i=>this.once(yt.transport_closed,this.rejectTransportOpen))])])}catch(i){this.logger.error(i);const n=i;if(!this.isConnectionStalled(n.message))throw i;this.events.emit(yt.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(r){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=r||this.relayUrl,this.connected&&await Promise.all([new Promise(i=>{this.provider.once($s.disconnect,()=>{i()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(r){return this.staleConnectionErrors.some(i=>r.includes(i))}rejectTransportOpen(){throw new Error("Attempt to connect to relay via `transportOpen` has stalled. Retrying...")}async createProvider(){const r=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ei(new eb(Lm({sdkVersion:B1,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:r,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(r){const{topic:i,message:n}=r;await this.messages.set(i,n)}async shouldIgnoreMessageEvent(r){const{topic:i,message:n}=r;return await this.subscriber.isSubscribed(i)?this.messages.has(i,n):!0}async onProviderPayload(r){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:r}),Rc(r)){if(!r.method.endsWith(H1))return;const i=r.params,{topic:n,message:o,publishedAt:h}=i.data,d={topic:n,message:o,publishedAt:h};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(vE({type:"event",event:i.id},d)),this.events.emit(i.id,d),await this.acknowledgePayload(r),await this.onMessageEvent(d)}else bo(r)&&this.events.emit(yt.message_ack,r)}async onMessageEvent(r){await this.shouldIgnoreMessageEvent(r)||(this.events.emit(yt.message,r),await this.recordMessageEvent(r))}async acknowledgePayload(r){const i=Ac(r.id,!0);await this.provider.connection.send(i)}registerProviderListeners(){this.provider.on($s.payload,r=>this.onProviderPayload(r)),this.provider.on($s.connect,()=>{this.events.emit(yt.connect)}),this.provider.on($s.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on($s.error,r=>{this.logger.error(r),this.events.emit(yt.error,r)})}registerEventListeners(){this.events.on(yt.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(yt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},de.toMiliseconds(K1))}isInitialized(){if(!this.initialized){const{message:r}=ie("NOT_INITIALIZED",this.name);throw new Error(r)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(r=>{const i=setInterval(()=>{this.connected&&(clearInterval(i),r())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var wE=Object.defineProperty,Pl=Object.getOwnPropertySymbols,_E=Object.prototype.hasOwnProperty,bE=Object.prototype.propertyIsEnumerable,Sl=(a,r,i)=>r in a?wE(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,Ol=(a,r)=>{for(var i in r||(r={}))_E.call(r,i)&&Sl(a,i,r[i]);if(Pl)for(var i of Pl(r))bE.call(r,i)&&Sl(a,i,r[i]);return a};class Io extends h_{constructor(r,i,n,o=bi,h=void 0){super(r,i,n,o),this.core=r,this.logger=i,this.name=n,this.map=new Map,this.version=F1,this.cached=[],this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(d=>{this.getKey&&d!==null&&!_i(d)?this.map.set(this.getKey(d),d):xm(d)?this.map.set(d.id,d):Pm(d)&&this.map.set(d.topic,d)}),this.cached=[],this.initialized=!0)},this.set=async(d,m)=>{this.isInitialized(),this.map.has(d)?await this.update(d,m):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:d,value:m}),this.map.set(d,m),await this.persist())},this.get=d=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:d}),this.getData(d)),this.getAll=d=>(this.isInitialized(),d?this.values.filter(m=>Object.keys(d).every(b=>ib(m[b],d[b]))):this.values),this.update=async(d,m)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:d,update:m});const b=Ol(Ol({},this.getData(d)),m);this.map.set(d,b),await this.persist()},this.delete=async(d,m)=>{this.isInitialized(),this.map.has(d)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:d,reason:m}),this.map.delete(d),await this.persist())},this.logger=gr(i,this.name),this.storagePrefix=o,this.getKey=h}get context(){return cr(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(r){await this.core.storage.setItem(this.storageKey,r)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(r){const i=this.map.get(r);if(!i){const{message:n}=ie("NO_MATCHING_KEY",`${this.name}: ${r}`);throw this.logger.error(n),new Error(n)}return i}async persist(){await this.setDataStore(this.values)}async restore(){try{const r=await this.getDataStore();if(typeof r>"u"||!r.length)return;if(this.map.size){const{message:i}=ie("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=r,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(r){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(r)}}isInitialized(){if(!this.initialized){const{message:r}=ie("NOT_INITIALIZED",this.name);throw new Error(r)}}}class EE{constructor(r,i){this.core=r,this.logger=i,this.name=Z1,this.version=X1,this.events=new Pc,this.initialized=!1,this.storagePrefix=bi,this.ignoredPayloadTypes=[Ql],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=gc(),o=await this.core.crypto.setSymKey(n),h=Lr(de.FIVE_MINUTES),d={protocol:Df},m={topic:o,expiry:h,relay:d,active:!1},b=jm({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:n,relay:d});return await this.pairings.set(o,m),await this.core.relayer.subscribe(o),this.core.expirer.set(o,h),{topic:o,uri:b}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:o,symKey:h,relay:d}=Mm(n.uri);if(this.pairings.keys.includes(o))throw new Error(`Pairing already exists: ${o}`);if(this.core.crypto.hasKeys(o))throw new Error(`Keychain already exists: ${o}`);const m=Lr(de.FIVE_MINUTES),b={topic:o,relay:d,expiry:m,active:!1};return await this.pairings.set(o,b),await this.core.crypto.setSymKey(h,o),await this.core.relayer.subscribe(o,{relay:d}),this.core.expirer.set(o,m),n.activatePairing&&await this.activate({topic:o}),b},this.activate=async({topic:n})=>{this.isInitialized();const o=Lr(de.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:o}),this.core.expirer.set(n,o)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:o}=n;if(this.pairings.keys.includes(o)){const h=await this.sendRequest(o,"wc_pairingPing",{}),{done:d,resolve:m,reject:b}=us();this.events.once(Dt("pairing_ping",h),({error:v})=>{v?b(v):m()}),await d()}},this.updateExpiry=async({topic:n,expiry:o})=>{this.isInitialized(),await this.pairings.update(n,{expiry:o})},this.updateMetadata=async({topic:n,metadata:o})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:o}=n;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",Qt("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(n,o,h)=>{const d=wo(o,h),m=await this.core.crypto.encode(n,d),b=Ls[o].req;return this.core.history.set(n,d),this.core.relayer.publish(n,m,b),d.id},this.sendResult=async(n,o,h)=>{const d=Ac(n,h),m=await this.core.crypto.encode(o,d),b=await this.core.history.get(o,n),v=Ls[b.request.method].res;await this.core.relayer.publish(o,m,v),await this.core.history.resolve(d)},this.sendError=async(n,o,h)=>{const d=_o(n,h),m=await this.core.crypto.encode(o,d),b=await this.core.history.get(o,n),v=Ls[b.request.method]?Ls[b.request.method].res:Ls.unregistered_method.res;await this.core.relayer.publish(o,m,v),await this.core.history.resolve(d)},this.deletePairing=async(n,o)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,Qt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),o?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(o=>wi(o.expiry));await Promise.all(n.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=n=>{const{topic:o,payload:h}=n,d=h.method;if(this.pairings.keys.includes(o))switch(d){case"wc_pairingPing":return this.onPairingPingRequest(o,h);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,h);default:return this.onUnknownRpcMethodRequest(o,h)}},this.onRelayEventResponse=async n=>{const{topic:o,payload:h}=n,d=(await this.core.history.get(o,h.id)).request.method;if(this.pairings.keys.includes(o))switch(d){case"wc_pairingPing":return this.onPairingPingResponse(o,h);default:return this.onUnknownRpcMethodResponse(d)}},this.onPairingPingRequest=async(n,o)=>{const{id:h}=o;try{this.isValidPing({topic:n}),await this.sendResult(h,n,!0),this.events.emit("pairing_ping",{id:h,topic:n})}catch(d){await this.sendError(h,n,d),this.logger.error(d)}},this.onPairingPingResponse=(n,o)=>{const{id:h}=o;setTimeout(()=>{ai(o)?this.events.emit(Dt("pairing_ping",h),{}):jr(o)&&this.events.emit(Dt("pairing_ping",h),{error:o.error})},500)},this.onPairingDeleteRequest=async(n,o)=>{const{id:h}=o;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit("pairing_delete",{id:h,topic:n})}catch(d){await this.sendError(h,n,d),this.logger.error(d)}},this.onUnknownRpcMethodRequest=async(n,o)=>{const{id:h,method:d}=o;try{if(this.registeredMethods.includes(d))return;const m=Qt("WC_METHOD_UNSUPPORTED",d);await this.sendError(h,n,m),this.logger.error(m)}catch(m){await this.sendError(h,n,m),this.logger.error(m)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(Qt("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!ar(n)){const{message:o}=ie("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(o)}if(!zm(n.uri)){const{message:o}=ie("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(o)}},this.isValidPing=async n=>{if(!ar(n)){const{message:h}=ie("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(h)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidDisconnect=async n=>{if(!ar(n)){const{message:h}=ie("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(h)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async n=>{if(!hs(n,!1)){const{message:o}=ie("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(o)}if(!this.pairings.keys.includes(n)){const{message:o}=ie("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(o)}if(wi(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:o}=ie("EXPIRED",`pairing topic: ${n}`);throw new Error(o)}},this.core=r,this.logger=gr(i,this.name),this.pairings=new Io(this.core,this.logger,this.name,this.storagePrefix)}get context(){return cr(this.logger)}isInitialized(){if(!this.initialized){const{message:r}=ie("NOT_INITIALIZED",this.name);throw new Error(r)}}registerRelayerEvents(){this.core.relayer.on(yt.message,async r=>{const{topic:i,message:n}=r;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const o=await this.core.crypto.decode(i,n);Rc(o)?(this.core.history.set(i,o),this.onRelayEventRequest({topic:i,payload:o})):bo(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:i,payload:o}),this.core.history.delete(i,o.id))})}registerExpirerEvents(){this.core.expirer.on(Sr.expired,async r=>{const{topic:i}=ef(r.target);i&&this.pairings.keys.includes(i)&&(await this.deletePairing(i,!0),this.events.emit("pairing_expire",{topic:i}))})}}class IE extends o_{constructor(r,i){super(r,i),this.core=r,this.logger=i,this.records=new Map,this.events=new Ar.EventEmitter,this.name=Q1,this.version=eE,this.cached=[],this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,o,h)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:o,chainId:h}),this.records.has(o.id))return;const d={id:o.id,topic:n,request:{method:o.method,params:o.params||null},chainId:h,expiry:Lr(de.THIRTY_DAYS)};this.records.set(d.id,d),this.events.emit(Br.created,d)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const o=await this.getRecord(n.id);typeof o.response>"u"&&(o.response=jr(n)?{error:n.error}:{result:n.result},this.records.set(o.id,o),this.events.emit(Br.updated,o))},this.get=async(n,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:o}),await this.getRecord(o)),this.delete=(n,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(h=>{if(h.topic===n){if(typeof o<"u"&&h.id!==o)return;this.records.delete(h.id),this.events.emit(Br.deleted,h)}})},this.exists=async(n,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===n:!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=gr(i,this.name)}get context(){return cr(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const r=[];return this.values.forEach(i=>{if(typeof i.response<"u")return;const n={topic:i.topic,request:wo(i.request.method,i.request.params,i.id),chainId:i.chainId};return r.push(n)}),r}async setJsonRpcRecords(r){await this.core.storage.setItem(this.storageKey,r)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(r){this.isInitialized();const i=this.records.get(r);if(!i){const{message:n}=ie("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(n)}return i}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Br.sync)}async restore(){try{const r=await this.getJsonRpcRecords();if(typeof r>"u"||!r.length)return;if(this.records.size){const{message:i}=ie("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=r,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}}registerEventListeners(){this.events.on(Br.created,r=>{const i=Br.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:r}),this.persist()}),this.events.on(Br.updated,r=>{const i=Br.updated;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:r}),this.persist()}),this.events.on(Br.deleted,r=>{const i=Br.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:r}),this.persist()}),this.core.heartbeat.on(Fs.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(r=>{de.toMiliseconds(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.delete(r.topic,r.id))})}catch(r){this.logger.warn(r)}}isInitialized(){if(!this.initialized){const{message:r}=ie("NOT_INITIALIZED",this.name);throw new Error(r)}}}class xE extends f_{constructor(r,i){super(r,i),this.core=r,this.logger=i,this.expirations=new Map,this.events=new Ar.EventEmitter,this.name=tE,this.version=rE,this.cached=[],this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const o=this.formatTarget(n);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(n,o)=>{this.isInitialized();const h=this.formatTarget(n),d={target:h,expiry:o};this.expirations.set(h,d),this.checkExpiry(h,d),this.events.emit(Sr.created,{target:h,expiration:d})},this.get=n=>{this.isInitialized();const o=this.formatTarget(n);return this.getExpiration(o)},this.del=n=>{if(this.isInitialized(),this.has(n)){const o=this.formatTarget(n),h=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Sr.deleted,{target:o,expiration:h})}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=gr(i,this.name)}get context(){return cr(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(r){if(typeof r=="string")return qm(r);if(typeof r=="number")return Um(r);const{message:i}=ie("UNKNOWN_TYPE",`Target type: ${typeof r}`);throw new Error(i)}async setExpirations(r){await this.core.storage.setItem(this.storageKey,r)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Sr.sync)}async restore(){try{const r=await this.getExpirations();if(typeof r>"u"||!r.length)return;if(this.expirations.size){const{message:i}=ie("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=r,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(r){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(r)}}getExpiration(r){const i=this.expirations.get(r);if(!i){const{message:n}=ie("NO_MATCHING_KEY",`${this.name}: ${r}`);throw this.logger.error(n),new Error(n)}return i}checkExpiry(r,i){const{expiry:n}=i;de.toMiliseconds(n)-Date.now()<=0&&this.expire(r,i)}expire(r,i){this.expirations.delete(r),this.events.emit(Sr.expired,{target:r,expiration:i})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((r,i)=>this.checkExpiry(i,r))}registerEventListeners(){this.core.heartbeat.on(Fs.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Sr.created,r=>{const i=Sr.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),this.persist()}),this.events.on(Sr.expired,r=>{const i=Sr.expired;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),this.persist()}),this.events.on(Sr.deleted,r=>{const i=Sr.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),this.persist()})}isInitialized(){if(!this.initialized){const{message:r}=ie("NOT_INITIALIZED",this.name);throw new Error(r)}}}class PE extends p_{constructor(r,i){super(r,i),this.projectId=r,this.logger=i,this.name=ac,this.initialized=!1,this.init=async n=>{km()||!tf()||(this.verifyUrl=(n==null?void 0:n.verifyUrl)||_l,await this.createIframe())},this.register=async n=>{var o;if(this.initialized||await this.init(),!!this.iframe)try{(o=this.iframe.contentWindow)==null||o.postMessage(n.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${n.attestationId} ${this.verifyUrl}`)}catch{}},this.resolve=async n=>{var o;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${n.attestationId}`);const h=this.startAbortTimer(de.FIVE_SECONDS),d=await fetch(`${this.verifyUrl}/attestation/${n.attestationId}`,{signal:this.abortController.signal});return clearTimeout(h),d.status===200?(o=await d.json())==null?void 0:o.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((n,o)=>{if(document.getElementById(ac))return n();const h=document.createElement("iframe");h.setAttribute("id",ac),h.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),h.style.display="none",h.addEventListener("load",()=>{this.initialized=!0,n()}),h.addEventListener("error",d=>{o(d)}),document.body.append(h),this.iframe=h}),new Promise(n=>{setTimeout(()=>n("iframe load timeout"),de.toMiliseconds(de.ONE_SECOND/2))})])}catch(n){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(n)}},this.logger=gr(i,this.name),this.verifyUrl=_l,this.abortController=new AbortController,this.isDevEnv=Hm()&&sb.IS_VITEST}get context(){return cr(this.logger)}startAbortTimer(r){return setTimeout(()=>this.abortController.abort(),de.toMiliseconds(r))}}var SE=Object.defineProperty,Al=Object.getOwnPropertySymbols,OE=Object.prototype.hasOwnProperty,AE=Object.prototype.propertyIsEnumerable,Rl=(a,r,i)=>r in a?SE(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,Cl=(a,r)=>{for(var i in r||(r={}))OE.call(r,i)&&Rl(a,i,r[i]);if(Al)for(var i of Al(r))AE.call(r,i)&&Rl(a,i,r[i]);return a};class Tc extends n_{constructor(r){super(r),this.protocol=Nf,this.version=R1,this.name=Cc,this.events=new Ar.EventEmitter,this.initialized=!1,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.projectId=r==null?void 0:r.projectId,this.relayUrl=(r==null?void 0:r.relayUrl)||$f;const i=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:vo(mo({level:(r==null?void 0:r.logger)||C1.logger}));this.logger=gr(i,this.name),this.heartbeat=new Fs.HeartBeat,this.crypto=new sE(this,this.logger,r==null?void 0:r.keychain),this.history=new IE(this,this.logger),this.expirer=new xE(this,this.logger),this.storage=r!=null&&r.storage?r.storage:new zw(Cl(Cl({},T1),r==null?void 0:r.storageOptions)),this.relayer=new mE({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new EE(this,this.logger),this.verify=new PE(this.projectId||"",this.logger)}static async init(r){const i=new Tc(r);await i.initialize();const n=await i.crypto.getClientId();return await i.storage.setItem(G1,n),i}get context(){return cr(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(r){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,r),this.logger.error(r.message),r}}}const RE=Tc,Lf="wc",jf=2,Mf="client",Nc=`${Lf}@${jf}:${Mf}:`,uc={name:Mf,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},CE="WALLETCONNECT_DEEPLINK_CHOICE",TE="proposal",zf="Proposal expired",NE="session",io=de.SEVEN_DAYS,DE="engine",Ms={wc_sessionPropose:{req:{ttl:de.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:de.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:de.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:de.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:de.ONE_DAY,prompt:!1,tag:1104},res:{ttl:de.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:de.ONE_DAY,prompt:!1,tag:1106},res:{ttl:de.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:de.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:de.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:de.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:de.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:de.ONE_DAY,prompt:!1,tag:1112},res:{ttl:de.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:de.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:de.THIRTY_SECONDS,prompt:!1,tag:1115}}},hc={min:de.FIVE_MINUTES,max:de.SEVEN_DAYS},$E="request",LE=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var jE=Object.defineProperty,ME=Object.defineProperties,zE=Object.getOwnPropertyDescriptors,Tl=Object.getOwnPropertySymbols,qE=Object.prototype.hasOwnProperty,UE=Object.prototype.propertyIsEnumerable,Nl=(a,r,i)=>r in a?jE(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,Pr=(a,r)=>{for(var i in r||(r={}))qE.call(r,i)&&Nl(a,i,r[i]);if(Tl)for(var i of Tl(r))UE.call(r,i)&&Nl(a,i,r[i]);return a},lc=(a,r)=>ME(a,zE(r));class kE extends g_{constructor(r){super(r),this.name=DE,this.events=new Pc,this.initialized=!1,this.ignoredPayloadTypes=[Ql],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(Ms)}),this.initialized=!0)},this.connect=async i=>{this.isInitialized();const n=lc(Pr({},i),{requiredNamespaces:i.requiredNamespaces||{},optionalNamespaces:i.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:o,requiredNamespaces:h,optionalNamespaces:d,sessionProperties:m,relays:b}=n;let v=o,x,N=!1;if(v&&(N=this.client.core.pairing.pairings.get(v).active),!v||!N){const{topic:ue,uri:z}=await this.client.core.pairing.create();v=ue,x=z}const L=await this.client.core.crypto.generateKeyPair(),K=Pr({requiredNamespaces:h,optionalNamespaces:d,relays:b??[{protocol:Df}],proposer:{publicKey:L,metadata:this.client.metadata}},m&&{sessionProperties:m}),{reject:T,resolve:W,done:se}=us(de.FIVE_MINUTES,zf);if(this.events.once(Dt("session_connect"),async({error:ue,session:z})=>{if(ue)T(ue);else if(z){z.self.publicKey=L;const j=lc(Pr({},z),{requiredNamespaces:z.requiredNamespaces,optionalNamespaces:z.optionalNamespaces});await this.client.session.set(z.topic,j),await this.setExpiry(z.topic,z.expiry),v&&await this.client.core.pairing.updateMetadata({topic:v,metadata:z.peer.metadata}),W(j)}}),!v){const{message:ue}=ie("NO_MATCHING_KEY",`connect() pairing topic: ${v}`);throw new Error(ue)}const ge=await this.sendRequest(v,"wc_sessionPropose",K),fe=Lr(de.FIVE_MINUTES);return await this.setProposal(ge,Pr({id:ge,expiry:fe},K)),{uri:x,approval:se}},this.pair=async i=>(this.isInitialized(),await this.client.core.pairing.pair(i)),this.approve=async i=>{this.isInitialized(),await this.isValidApprove(i);const{id:n,relayProtocol:o,namespaces:h,sessionProperties:d}=i,m=this.client.proposal.get(n);let{pairingTopic:b,proposer:v,requiredNamespaces:x,optionalNamespaces:N}=m;b=b||"",ao(x)||(x=Bm(h,"approve()"));const L=await this.client.core.crypto.generateKeyPair(),K=v.publicKey,T=await this.client.core.crypto.generateSharedKey(L,K);b&&n&&(await this.client.core.pairing.updateMetadata({topic:b,metadata:v.metadata}),await this.sendResult(n,b,{relay:{protocol:o??"irn"},responderPublicKey:L}),await this.client.proposal.delete(n,Qt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:b}));const W=Pr({relay:{protocol:o??"irn"},namespaces:h,requiredNamespaces:x,optionalNamespaces:N,pairingTopic:b,controller:{publicKey:L,metadata:this.client.metadata},expiry:Lr(io)},d&&{sessionProperties:d});await this.client.core.relayer.subscribe(T),await this.sendRequest(T,"wc_sessionSettle",W);const se=lc(Pr({},W),{topic:T,pairingTopic:b,acknowledged:!1,self:W.controller,peer:{publicKey:v.publicKey,metadata:v.metadata},controller:L});return await this.client.session.set(T,se),await this.setExpiry(T,Lr(io)),{topic:T,acknowledged:()=>new Promise(ge=>setTimeout(()=>ge(this.client.session.get(T)),500))}},this.reject=async i=>{this.isInitialized(),await this.isValidReject(i);const{id:n,reason:o}=i,{pairingTopic:h}=this.client.proposal.get(n);h&&(await this.sendError(n,h,o),await this.client.proposal.delete(n,Qt("USER_DISCONNECTED")))},this.update=async i=>{this.isInitialized(),await this.isValidUpdate(i);const{topic:n,namespaces:o}=i,h=await this.sendRequest(n,"wc_sessionUpdate",{namespaces:o}),{done:d,resolve:m,reject:b}=us();return this.events.once(Dt("session_update",h),({error:v})=>{v?b(v):m()}),await this.client.session.update(n,{namespaces:o}),{acknowledged:d}},this.extend=async i=>{this.isInitialized(),await this.isValidExtend(i);const{topic:n}=i,o=await this.sendRequest(n,"wc_sessionExtend",{}),{done:h,resolve:d,reject:m}=us();return this.events.once(Dt("session_extend",o),({error:b})=>{b?m(b):d()}),await this.setExpiry(n,Lr(io)),{acknowledged:h}},this.request=async i=>{this.isInitialized(),await this.isValidRequest(i);const{chainId:n,request:o,topic:h,expiry:d}=i,m=await this.sendRequest(h,"wc_sessionRequest",{request:o,chainId:n},d),{done:b,resolve:v,reject:x}=us(d);this.events.once(Dt("session_request",m),({error:L,result:K})=>{L?x(L):v(K)}),this.client.events.emit("session_request_sent",{topic:h,request:o,chainId:n,id:m});const N=await this.client.core.storage.getItem(CE);return Vm({id:m,topic:h,wcDeepLink:N}),await b()},this.respond=async i=>{this.isInitialized(),await this.isValidRespond(i);const{topic:n,response:o}=i,{id:h}=o;ai(o)?await this.sendResult(h,n,o.result):jr(o)&&await this.sendError(h,n,o.error),this.deletePendingSessionRequest(i.response.id,{message:"fulfilled",code:0})},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:n}=i;if(this.client.session.keys.includes(n)){const o=await this.sendRequest(n,"wc_sessionPing",{}),{done:h,resolve:d,reject:m}=us();this.events.once(Dt("session_ping",o),({error:b})=>{b?m(b):d()}),await h()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async i=>{this.isInitialized(),await this.isValidEmit(i);const{topic:n,event:o,chainId:h}=i;await this.sendRequest(n,"wc_sessionEvent",{event:o,chainId:h})},this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;if(this.client.session.keys.includes(n)){const o=Oc().toString();let h;const d=m=>{(m==null?void 0:m.id.toString())===o&&(this.client.core.relayer.events.removeListener(yt.message_ack,d),h())};await Promise.all([new Promise(m=>{h=m,this.client.core.relayer.on(yt.message_ack,d)}),this.sendRequest(n,"wc_sessionDelete",Qt("USER_DISCONNECTED"),void 0,o)]),await this.deleteSession(n)}else await this.client.core.pairing.disconnect({topic:n})},this.find=i=>(this.isInitialized(),this.client.session.getAll().filter(n=>Fm(n,i))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async i=>{if(i.pairingTopic)try{const n=this.client.core.pairing.pairings.get(i.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(h=>{var d,m;return((d=h.peerMetadata)==null?void 0:d.url)&&((m=h.peerMetadata)==null?void 0:m.url)===i.peer.metadata.url&&h.topic&&h.topic!==n.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(h=>this.client.core.pairing.disconnect({topic:h.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(i,n)=>{const{self:o}=this.client.session.get(i);await this.client.core.relayer.unsubscribe(i),this.client.session.delete(i,Qt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(i)&&await this.client.core.crypto.deleteSymKey(i),n||this.client.core.expirer.del(i)},this.deleteProposal=async(i,n)=>{await Promise.all([this.client.proposal.delete(i,Qt("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(i)])},this.deletePendingSessionRequest=async(i,n,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(i,n),o?Promise.resolve():this.client.core.expirer.del(i)])},this.setExpiry=async(i,n)=>{this.client.session.keys.includes(i)&&await this.client.session.update(i,{expiry:n}),this.client.core.expirer.set(i,n)},this.setProposal=async(i,n)=>{await this.client.proposal.set(i,n),this.client.core.expirer.set(i,n.expiry)},this.setPendingSessionRequest=async i=>{const n=Ms.wc_sessionRequest.req.ttl,{id:o,topic:h,params:d}=i;await this.client.pendingRequest.set(o,{id:o,topic:h,params:d}),n&&this.client.core.expirer.set(o,Lr(n))},this.sendRequest=async(i,n,o,h,d)=>{const m=wo(n,o);if(tf()&&LE.includes(n)){const x=ls(JSON.stringify(m));await this.client.core.verify.register({attestationId:x})}const b=await this.client.core.crypto.encode(i,m),v=Ms[n].req;return h&&(v.ttl=h),d&&(v.id=d),this.client.core.history.set(i,m),this.client.core.relayer.publish(i,b,v),m.id},this.sendResult=async(i,n,o)=>{const h=Ac(i,o),d=await this.client.core.crypto.encode(n,h),m=await this.client.core.history.get(n,i),b=Ms[m.request.method].res;this.client.core.relayer.publish(n,d,b),await this.client.core.history.resolve(h)},this.sendError=async(i,n,o)=>{const h=_o(i,o),d=await this.client.core.crypto.encode(n,h),m=await this.client.core.history.get(n,i),b=Ms[m.request.method].res;this.client.core.relayer.publish(n,d,b),await this.client.core.history.resolve(h)},this.cleanup=async()=>{const i=[],n=[];this.client.session.getAll().forEach(o=>{wi(o.expiry)&&i.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{wi(o.expiry)&&n.push(o.id)}),await Promise.all([...i.map(o=>this.deleteSession(o)),...n.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=i=>{const{topic:n,payload:o}=i,h=o.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeRequest(n,o);case"wc_sessionSettle":return this.onSessionSettleRequest(n,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,o);case"wc_sessionExtend":return this.onSessionExtendRequest(n,o);case"wc_sessionPing":return this.onSessionPingRequest(n,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,o);case"wc_sessionRequest":return this.onSessionRequest(n,o);case"wc_sessionEvent":return this.onSessionEventRequest(n,o);default:return this.client.logger.info(`Unsupported request method ${h}`)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:o}=i,h=(await this.client.core.history.get(n,o.id)).request.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeResponse(n,o);case"wc_sessionSettle":return this.onSessionSettleResponse(n,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,o);case"wc_sessionExtend":return this.onSessionExtendResponse(n,o);case"wc_sessionPing":return this.onSessionPingResponse(n,o);case"wc_sessionRequest":return this.onSessionRequestResponse(n,o);default:return this.client.logger.info(`Unsupported response method ${h}`)}},this.onRelayEventUnknownPayload=i=>{const{topic:n}=i,{message:o}=ie("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(i,n)=>{const{params:o,id:h}=n;try{this.isValidConnect(Pr({},n.params));const d=Lr(de.FIVE_MINUTES),m=Pr({id:h,pairingTopic:i,expiry:d},o);await this.setProposal(h,m);const b=ls(JSON.stringify(n)),v=await this.getVerifyContext(b,m.proposer.metadata);this.client.events.emit("session_proposal",{id:h,params:m,verifyContext:v})}catch(d){await this.sendError(h,i,d),this.client.logger.error(d)}},this.onSessionProposeResponse=async(i,n)=>{const{id:o}=n;if(ai(n)){const{result:h}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:h});const d=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:d});const m=d.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:m});const b=h.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:b});const v=await this.client.core.crypto.generateSharedKey(m,b);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:v});const x=await this.client.core.relayer.subscribe(v);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:x}),await this.client.core.pairing.activate({topic:i})}else jr(n)&&(await this.client.proposal.delete(o,Qt("USER_DISCONNECTED")),this.events.emit(Dt("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(i,n)=>{const{id:o,params:h}=n;try{this.isValidSessionSettleRequest(h);const{relay:d,controller:m,expiry:b,namespaces:v,requiredNamespaces:x,optionalNamespaces:N,sessionProperties:L,pairingTopic:K}=n.params,T=Pr({topic:i,relay:d,expiry:b,namespaces:v,acknowledged:!0,pairingTopic:K,requiredNamespaces:x,optionalNamespaces:N,controller:m.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:m.publicKey,metadata:m.metadata}},L&&{sessionProperties:L});await this.sendResult(n.id,i,!0),this.events.emit(Dt("session_connect"),{session:T}),this.cleanupDuplicatePairings(T)}catch(d){await this.sendError(o,i,d),this.client.logger.error(d)}},this.onSessionSettleResponse=async(i,n)=>{const{id:o}=n;ai(n)?(await this.client.session.update(i,{acknowledged:!0}),this.events.emit(Dt("session_approve",o),{})):jr(n)&&(await this.client.session.delete(i,Qt("USER_DISCONNECTED")),this.events.emit(Dt("session_approve",o),{error:n.error}))},this.onSessionUpdateRequest=async(i,n)=>{const{params:o,id:h}=n;try{this.isValidUpdate(Pr({topic:i},o)),await this.client.session.update(i,{namespaces:o.namespaces}),await this.sendResult(h,i,!0),this.client.events.emit("session_update",{id:h,topic:i,params:o})}catch(d){await this.sendError(h,i,d),this.client.logger.error(d)}},this.onSessionUpdateResponse=(i,n)=>{const{id:o}=n;ai(n)?this.events.emit(Dt("session_update",o),{}):jr(n)&&this.events.emit(Dt("session_update",o),{error:n.error})},this.onSessionExtendRequest=async(i,n)=>{const{id:o}=n;try{this.isValidExtend({topic:i}),await this.setExpiry(i,Lr(io)),await this.sendResult(o,i,!0),this.client.events.emit("session_extend",{id:o,topic:i})}catch(h){await this.sendError(o,i,h),this.client.logger.error(h)}},this.onSessionExtendResponse=(i,n)=>{const{id:o}=n;ai(n)?this.events.emit(Dt("session_extend",o),{}):jr(n)&&this.events.emit(Dt("session_extend",o),{error:n.error})},this.onSessionPingRequest=async(i,n)=>{const{id:o}=n;try{this.isValidPing({topic:i}),await this.sendResult(o,i,!0),this.client.events.emit("session_ping",{id:o,topic:i})}catch(h){await this.sendError(o,i,h),this.client.logger.error(h)}},this.onSessionPingResponse=(i,n)=>{const{id:o}=n;setTimeout(()=>{ai(n)?this.events.emit(Dt("session_ping",o),{}):jr(n)&&this.events.emit(Dt("session_ping",o),{error:n.error})},500)},this.onSessionDeleteRequest=async(i,n)=>{const{id:o}=n;try{this.isValidDisconnect({topic:i,reason:n.params}),await Promise.all([new Promise(h=>{this.client.core.relayer.once(yt.publish,async()=>{h(await this.deleteSession(i))})}),this.sendResult(o,i,!0)]),this.client.events.emit("session_delete",{id:o,topic:i})}catch(h){this.client.logger.error(h)}},this.onSessionRequest=async(i,n)=>{const{id:o,params:h}=n;try{this.isValidRequest(Pr({topic:i},h)),await this.setPendingSessionRequest({id:o,topic:i,params:h});const d=ls(JSON.stringify(n)),m=this.client.session.get(i),b=await this.getVerifyContext(d,m.peer.metadata);this.client.events.emit("session_request",{id:o,topic:i,params:h,verifyContext:b})}catch(d){await this.sendError(o,i,d),this.client.logger.error(d)}},this.onSessionRequestResponse=(i,n)=>{const{id:o}=n;ai(n)?this.events.emit(Dt("session_request",o),{result:n.result}):jr(n)&&this.events.emit(Dt("session_request",o),{error:n.error})},this.onSessionEventRequest=async(i,n)=>{const{id:o,params:h}=n;try{this.isValidEmit(Pr({topic:i},h)),this.client.events.emit("session_event",{id:o,topic:i,params:h})}catch(d){await this.sendError(o,i,d),this.client.logger.error(d)}},this.isValidConnect=async i=>{if(!ar(i)){const{message:b}=ie("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(i)}`);throw new Error(b)}const{pairingTopic:n,requiredNamespaces:o,optionalNamespaces:h,sessionProperties:d,relays:m}=i;if(_i(n)||await this.isValidPairingTopic(n),!Gm(m)){const{message:b}=ie("MISSING_OR_INVALID",`connect() relays: ${m}`);throw new Error(b)}!_i(o)&&ao(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!_i(h)&&ao(h)!==0&&this.validateNamespaces(h,"optionalNamespaces"),_i(d)||this.validateSessionProps(d,"sessionProperties")},this.validateNamespaces=(i,n)=>{const o=Wm(i,"connect()",n);if(o)throw new Error(o.message)},this.isValidApprove=async i=>{if(!ar(i))throw new Error(ie("MISSING_OR_INVALID",`approve() params: ${i}`).message);const{id:n,namespaces:o,relayProtocol:h,sessionProperties:d}=i;await this.isValidProposalId(n);const m=this.client.proposal.get(n),b=Wa(o,"approve()");if(b)throw new Error(b.message);const v=jh(m.requiredNamespaces,o,"approve()");if(v)throw new Error(v.message);if(!hs(h,!0)){const{message:x}=ie("MISSING_OR_INVALID",`approve() relayProtocol: ${h}`);throw new Error(x)}_i(d)||this.validateSessionProps(d,"sessionProperties")},this.isValidReject=async i=>{if(!ar(i)){const{message:h}=ie("MISSING_OR_INVALID",`reject() params: ${i}`);throw new Error(h)}const{id:n,reason:o}=i;if(await this.isValidProposalId(n),!Jm(o)){const{message:h}=ie("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(h)}},this.isValidSessionSettleRequest=i=>{if(!ar(i)){const{message:v}=ie("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${i}`);throw new Error(v)}const{relay:n,controller:o,namespaces:h,expiry:d}=i;if(!Ym(n)){const{message:v}=ie("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(v)}const m=Zm(o,"onSessionSettleRequest()");if(m)throw new Error(m.message);const b=Wa(h,"onSessionSettleRequest()");if(b)throw new Error(b.message);if(wi(d)){const{message:v}=ie("EXPIRED","onSessionSettleRequest()");throw new Error(v)}},this.isValidUpdate=async i=>{if(!ar(i)){const{message:b}=ie("MISSING_OR_INVALID",`update() params: ${i}`);throw new Error(b)}const{topic:n,namespaces:o}=i;await this.isValidSessionTopic(n);const h=this.client.session.get(n),d=Wa(o,"update()");if(d)throw new Error(d.message);const m=jh(h.requiredNamespaces,o,"update()");if(m)throw new Error(m.message)},this.isValidExtend=async i=>{if(!ar(i)){const{message:o}=ie("MISSING_OR_INVALID",`extend() params: ${i}`);throw new Error(o)}const{topic:n}=i;await this.isValidSessionTopic(n)},this.isValidRequest=async i=>{if(!ar(i)){const{message:b}=ie("MISSING_OR_INVALID",`request() params: ${i}`);throw new Error(b)}const{topic:n,request:o,chainId:h,expiry:d}=i;await this.isValidSessionTopic(n);const{namespaces:m}=this.client.session.get(n);if(!Mh(m,h)){const{message:b}=ie("MISSING_OR_INVALID",`request() chainId: ${h}`);throw new Error(b)}if(!Xm(o)){const{message:b}=ie("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(b)}if(!Qm(m,h,o.method)){const{message:b}=ie("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(b)}if(d&&!ew(d,hc)){const{message:b}=ie("MISSING_OR_INVALID",`request() expiry: ${d}. Expiry must be a number (in seconds) between ${hc.min} and ${hc.max}`);throw new Error(b)}},this.isValidRespond=async i=>{if(!ar(i)){const{message:h}=ie("MISSING_OR_INVALID",`respond() params: ${i}`);throw new Error(h)}const{topic:n,response:o}=i;if(await this.isValidSessionTopic(n),!tw(o)){const{message:h}=ie("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(h)}},this.isValidPing=async i=>{if(!ar(i)){const{message:o}=ie("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(o)}const{topic:n}=i;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async i=>{if(!ar(i)){const{message:m}=ie("MISSING_OR_INVALID",`emit() params: ${i}`);throw new Error(m)}const{topic:n,event:o,chainId:h}=i;await this.isValidSessionTopic(n);const{namespaces:d}=this.client.session.get(n);if(!Mh(d,h)){const{message:m}=ie("MISSING_OR_INVALID",`emit() chainId: ${h}`);throw new Error(m)}if(!rw(o)){const{message:m}=ie("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(m)}if(!iw(d,h,o.name)){const{message:m}=ie("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(m)}},this.isValidDisconnect=async i=>{if(!ar(i)){const{message:o}=ie("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(o)}const{topic:n}=i;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(i,n)=>{const o={verified:{verifyUrl:n.verifyUrl||"",validation:"UNKNOWN",origin:n.url||""}};try{const h=await this.client.core.verify.resolve({attestationId:i,verifyUrl:n.verifyUrl});h&&(o.verified.origin=h,o.verified.validation=h===n.url?"VALID":"INVALID")}catch(h){this.client.logger.error(h)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(i,n)=>{Object.values(i).forEach(o=>{if(!hs(o,!1)){const{message:h}=ie("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(h)}})}}isInitialized(){if(!this.initialized){const{message:r}=ie("NOT_INITIALIZED",this.name);throw new Error(r)}}registerRelayerEvents(){this.client.core.relayer.on(yt.message,async r=>{const{topic:i,message:n}=r;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const o=await this.client.core.crypto.decode(i,n);Rc(o)?(this.client.core.history.set(i,o),this.onRelayEventRequest({topic:i,payload:o})):bo(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:i,payload:o}),this.client.core.history.delete(i,o.id)):this.onRelayEventUnknownPayload({topic:i,payload:o})})}registerExpirerEvents(){this.client.core.expirer.on(Sr.expired,async r=>{const{topic:i,id:n}=ef(r.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,ie("EXPIRED"),!0);i?this.client.session.keys.includes(i)&&(await this.deleteSession(i,!0),this.client.events.emit("session_expire",{topic:i})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}isValidPairingTopic(r){if(!hs(r,!1)){const{message:i}=ie("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(i)}if(!this.client.core.pairing.pairings.keys.includes(r)){const{message:i}=ie("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(i)}if(wi(this.client.core.pairing.pairings.get(r).expiry)){const{message:i}=ie("EXPIRED",`pairing topic: ${r}`);throw new Error(i)}}async isValidSessionTopic(r){if(!hs(r,!1)){const{message:i}=ie("MISSING_OR_INVALID",`session topic should be a string: ${r}`);throw new Error(i)}if(!this.client.session.keys.includes(r)){const{message:i}=ie("NO_MATCHING_KEY",`session topic doesn't exist: ${r}`);throw new Error(i)}if(wi(this.client.session.get(r).expiry)){await this.deleteSession(r);const{message:i}=ie("EXPIRED",`session topic: ${r}`);throw new Error(i)}}async isValidSessionOrPairingTopic(r){if(this.client.session.keys.includes(r))await this.isValidSessionTopic(r);else if(this.client.core.pairing.pairings.keys.includes(r))this.isValidPairingTopic(r);else if(hs(r,!1)){const{message:i}=ie("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${r}`);throw new Error(i)}else{const{message:i}=ie("MISSING_OR_INVALID",`session or pairing topic should be a string: ${r}`);throw new Error(i)}}async isValidProposalId(r){if(!sw(r)){const{message:i}=ie("MISSING_OR_INVALID",`proposal id should be a number: ${r}`);throw new Error(i)}if(!this.client.proposal.keys.includes(r)){const{message:i}=ie("NO_MATCHING_KEY",`proposal id doesn't exist: ${r}`);throw new Error(i)}if(wi(this.client.proposal.get(r).expiry)){await this.deleteProposal(r);const{message:i}=ie("EXPIRED",`proposal id: ${r}`);throw new Error(i)}}}class HE extends Io{constructor(r,i){super(r,i,TE,Nc),this.core=r,this.logger=i}}class KE extends Io{constructor(r,i){super(r,i,NE,Nc),this.core=r,this.logger=i}}class BE extends Io{constructor(r,i){super(r,i,$E,Nc,n=>n.id),this.core=r,this.logger=i}}let VE=class qf extends d_{constructor(r){super(r),this.protocol=Lf,this.version=jf,this.name=uc.name,this.events=new Ar.EventEmitter,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(o){throw this.logger.error(o.message),o}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(o){throw this.logger.error(o.message),o}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(o){throw this.logger.error(o.message),o}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(o){throw this.logger.error(o.message),o}},this.update=async n=>{try{return await this.engine.update(n)}catch(o){throw this.logger.error(o.message),o}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(o){throw this.logger.error(o.message),o}},this.request=async n=>{try{return await this.engine.request(n)}catch(o){throw this.logger.error(o.message),o}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(o){throw this.logger.error(o.message),o}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(o){throw this.logger.error(o.message),o}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(o){throw this.logger.error(o.message),o}},this.find=n=>{try{return this.engine.find(n)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(r==null?void 0:r.name)||uc.name,this.metadata=(r==null?void 0:r.metadata)||Km();const i=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:vo(mo({level:(r==null?void 0:r.logger)||uc.logger}));this.core=(r==null?void 0:r.core)||new RE(r),this.logger=gr(i,this.name),this.session=new KE(this.core,this.logger),this.proposal=new HE(this.core,this.logger),this.pendingRequest=new BE(this.core,this.logger),this.engine=new kE(this)}static async init(r){const i=new qf(r);return await i.initialize(),i}get context(){return cr(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(r){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(r.message),r}}};var Us={exports:{}},FE=Us.exports,Dl;function GE(){return Dl||(Dl=1,function(a,r){var i=typeof self<"u"?self:FE,n=function(){function h(){this.fetch=!1,this.DOMException=i.DOMException}return h.prototype=i,new h}();(function(h){(function(d){var m={searchParams:"URLSearchParams"in h,iterable:"Symbol"in h&&"iterator"in Symbol,blob:"FileReader"in h&&"Blob"in h&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in h,arrayBuffer:"ArrayBuffer"in h};function b(g){return g&&DataView.prototype.isPrototypeOf(g)}if(m.arrayBuffer)var v=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],x=ArrayBuffer.isView||function(g){return g&&v.indexOf(Object.prototype.toString.call(g))>-1};function N(g){if(typeof g!="string"&&(g=String(g)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(g))throw new TypeError("Invalid character in header field name");return g.toLowerCase()}function L(g){return typeof g!="string"&&(g=String(g)),g}function K(g){var P={next:function(){var te=g.shift();return{done:te===void 0,value:te}}};return m.iterable&&(P[Symbol.iterator]=function(){return P}),P}function T(g){this.map={},g instanceof T?g.forEach(function(P,te){this.append(te,P)},this):Array.isArray(g)?g.forEach(function(P){this.append(P[0],P[1])},this):g&&Object.getOwnPropertyNames(g).forEach(function(P){this.append(P,g[P])},this)}T.prototype.append=function(g,P){g=N(g),P=L(P);var te=this.map[g];this.map[g]=te?te+", "+P:P},T.prototype.delete=function(g){delete this.map[N(g)]},T.prototype.get=function(g){return g=N(g),this.has(g)?this.map[g]:null},T.prototype.has=function(g){return this.map.hasOwnProperty(N(g))},T.prototype.set=function(g,P){this.map[N(g)]=L(P)},T.prototype.forEach=function(g,P){for(var te in this.map)this.map.hasOwnProperty(te)&&g.call(P,this.map[te],te,this)},T.prototype.keys=function(){var g=[];return this.forEach(function(P,te){g.push(te)}),K(g)},T.prototype.values=function(){var g=[];return this.forEach(function(P){g.push(P)}),K(g)},T.prototype.entries=function(){var g=[];return this.forEach(function(P,te){g.push([te,P])}),K(g)},m.iterable&&(T.prototype[Symbol.iterator]=T.prototype.entries);function W(g){if(g.bodyUsed)return Promise.reject(new TypeError("Already read"));g.bodyUsed=!0}function se(g){return new Promise(function(P,te){g.onload=function(){P(g.result)},g.onerror=function(){te(g.error)}})}function ge(g){var P=new FileReader,te=se(P);return P.readAsArrayBuffer(g),te}function fe(g){var P=new FileReader,te=se(P);return P.readAsText(g),te}function ue(g){for(var P=new Uint8Array(g),te=new Array(P.length),pe=0;pe<P.length;pe++)te[pe]=String.fromCharCode(P[pe]);return te.join("")}function z(g){if(g.slice)return g.slice(0);var P=new Uint8Array(g.byteLength);return P.set(new Uint8Array(g)),P.buffer}function j(){return this.bodyUsed=!1,this._initBody=function(g){this._bodyInit=g,g?typeof g=="string"?this._bodyText=g:m.blob&&Blob.prototype.isPrototypeOf(g)?this._bodyBlob=g:m.formData&&FormData.prototype.isPrototypeOf(g)?this._bodyFormData=g:m.searchParams&&URLSearchParams.prototype.isPrototypeOf(g)?this._bodyText=g.toString():m.arrayBuffer&&m.blob&&b(g)?(this._bodyArrayBuffer=z(g.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):m.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(g)||x(g))?this._bodyArrayBuffer=z(g):this._bodyText=g=Object.prototype.toString.call(g):this._bodyText="",this.headers.get("content-type")||(typeof g=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):m.searchParams&&URLSearchParams.prototype.isPrototypeOf(g)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},m.blob&&(this.blob=function(){var g=W(this);if(g)return g;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?W(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(ge)}),this.text=function(){var g=W(this);if(g)return g;if(this._bodyBlob)return fe(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(ue(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},m.formData&&(this.formData=function(){return this.text().then(Q)}),this.json=function(){return this.text().then(JSON.parse)},this}var E=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function C(g){var P=g.toUpperCase();return E.indexOf(P)>-1?P:g}function q(g,P){P=P||{};var te=P.body;if(g instanceof q){if(g.bodyUsed)throw new TypeError("Already read");this.url=g.url,this.credentials=g.credentials,P.headers||(this.headers=new T(g.headers)),this.method=g.method,this.mode=g.mode,this.signal=g.signal,!te&&g._bodyInit!=null&&(te=g._bodyInit,g.bodyUsed=!0)}else this.url=String(g);if(this.credentials=P.credentials||this.credentials||"same-origin",(P.headers||!this.headers)&&(this.headers=new T(P.headers)),this.method=C(P.method||this.method||"GET"),this.mode=P.mode||this.mode||null,this.signal=P.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&te)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(te)}q.prototype.clone=function(){return new q(this,{body:this._bodyInit})};function Q(g){var P=new FormData;return g.trim().split("&").forEach(function(te){if(te){var pe=te.split("="),Y=pe.shift().replace(/\+/g," "),V=pe.join("=").replace(/\+/g," ");P.append(decodeURIComponent(Y),decodeURIComponent(V))}}),P}function J(g){var P=new T,te=g.replace(/\r?\n[\t ]+/g," ");return te.split(/\r?\n/).forEach(function(pe){var Y=pe.split(":"),V=Y.shift().trim();if(V){var G=Y.join(":").trim();P.append(V,G)}}),P}j.call(q.prototype);function oe(g,P){P||(P={}),this.type="default",this.status=P.status===void 0?200:P.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in P?P.statusText:"OK",this.headers=new T(P.headers),this.url=P.url||"",this._initBody(g)}j.call(oe.prototype),oe.prototype.clone=function(){return new oe(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new T(this.headers),url:this.url})},oe.error=function(){var g=new oe(null,{status:0,statusText:""});return g.type="error",g};var be=[301,302,303,307,308];oe.redirect=function(g,P){if(be.indexOf(P)===-1)throw new RangeError("Invalid status code");return new oe(null,{status:P,headers:{location:g}})},d.DOMException=h.DOMException;try{new d.DOMException}catch{d.DOMException=function(P,te){this.message=P,this.name=te;var pe=Error(P);this.stack=pe.stack},d.DOMException.prototype=Object.create(Error.prototype),d.DOMException.prototype.constructor=d.DOMException}function De(g,P){return new Promise(function(te,pe){var Y=new q(g,P);if(Y.signal&&Y.signal.aborted)return pe(new d.DOMException("Aborted","AbortError"));var V=new XMLHttpRequest;function G(){V.abort()}V.onload=function(){var Z={status:V.status,statusText:V.statusText,headers:J(V.getAllResponseHeaders()||"")};Z.url="responseURL"in V?V.responseURL:Z.headers.get("X-Request-URL");var We="response"in V?V.response:V.responseText;te(new oe(We,Z))},V.onerror=function(){pe(new TypeError("Network request failed"))},V.ontimeout=function(){pe(new TypeError("Network request failed"))},V.onabort=function(){pe(new d.DOMException("Aborted","AbortError"))},V.open(Y.method,Y.url,!0),Y.credentials==="include"?V.withCredentials=!0:Y.credentials==="omit"&&(V.withCredentials=!1),"responseType"in V&&m.blob&&(V.responseType="blob"),Y.headers.forEach(function(Z,We){V.setRequestHeader(We,Z)}),Y.signal&&(Y.signal.addEventListener("abort",G),V.onreadystatechange=function(){V.readyState===4&&Y.signal.removeEventListener("abort",G)}),V.send(typeof Y._bodyInit>"u"?null:Y._bodyInit)})}return De.polyfill=!0,h.fetch||(h.fetch=De,h.Headers=T,h.Request=q,h.Response=oe),d.Headers=T,d.Request=q,d.Response=oe,d.fetch=De,Object.defineProperty(d,"__esModule",{value:!0}),d})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var o=n;r=o.fetch,r.default=o.fetch,r.fetch=o.fetch,r.Headers=o.Headers,r.Request=o.Request,r.Response=o.Response,a.exports=r}(Us,Us.exports)),Us.exports}var WE=GE();const $l=go(WE);var JE=Object.defineProperty,YE=Object.defineProperties,ZE=Object.getOwnPropertyDescriptors,Ll=Object.getOwnPropertySymbols,XE=Object.prototype.hasOwnProperty,QE=Object.prototype.propertyIsEnumerable,jl=(a,r,i)=>r in a?JE(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,Ml=(a,r)=>{for(var i in r||(r={}))XE.call(r,i)&&jl(a,i,r[i]);if(Ll)for(var i of Ll(r))QE.call(r,i)&&jl(a,i,r[i]);return a},zl=(a,r)=>YE(a,ZE(r));const eI={Accept:"application/json","Content-Type":"application/json"},tI="POST",ql={headers:eI,method:tI},Ul=10;let Hi=class{constructor(r,i=!1){if(this.url=r,this.disableProviderPing=i,this.events=new Ar.EventEmitter,this.isAvailable=!1,this.registering=!1,!al(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);this.url=r,this.disableProviderPing=i}get connected(){return this.isAvailable}get connecting(){return this.registering}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}off(r,i){this.events.off(r,i)}removeListener(r,i){this.events.removeListener(r,i)}async open(r=this.url){await this.register(r)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(r){this.isAvailable||await this.register();try{const i=qi(r),n=await(await $l(this.url,zl(Ml({},ql),{body:i}))).json();this.onPayload({data:n})}catch(i){this.onError(r.id,i)}}async register(r=this.url){if(!al(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);if(this.registering){const i=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=i||this.events.listenerCount("open")>=i)&&this.events.setMaxListeners(i+1),new Promise((n,o)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),o(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));n()})})}this.url=r,this.registering=!0;try{if(!this.disableProviderPing){const i=qi({id:1,jsonrpc:"2.0",method:"test",params:[]});await $l(r,zl(Ml({},ql),{body:i}))}this.onOpen()}catch(i){const n=this.parseError(i);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(r){if(typeof r.data>"u")return;const i=typeof r.data=="string"?Vs(r.data):r.data;this.events.emit("payload",i)}onError(r,i){const n=this.parseError(i),o=n.message||n.toString(),h=_o(r,o);this.events.emit("payload",h)}parseError(r,i=this.url){return vf(r,i,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Ul&&this.events.setMaxListeners(Ul)}};const kl="error",rI="wss://relay.walletconnect.com",iI="wc",sI="universal_provider",Hl=`${iI}@2:${sI}:`,nI="https://rpc.walletconnect.com/v1",Ii={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var zs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},_c={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(a,r){(function(){var i,n="4.17.21",o=200,h="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",d="Expected a function",m="Invalid `variable` option passed into `_.template`",b="__lodash_hash_undefined__",v=500,x="__lodash_placeholder__",N=1,L=2,K=4,T=1,W=2,se=1,ge=2,fe=4,ue=8,z=16,j=32,E=64,C=128,q=256,Q=512,J=30,oe="...",be=800,De=16,g=1,P=2,te=3,pe=1/0,Y=9007199254740991,V=17976931348623157e292,G=NaN,Z=4294967295,We=Z-1,He=Z>>>1,Mr=[["ary",C],["bind",se],["bindKey",ge],["curry",ue],["curryRight",z],["flip",Q],["partial",j],["partialRight",E],["rearg",q]],xe="[object Arguments]",It="[object Array]",M="[object AsyncFunction]",$="[object Boolean]",R="[object Date]",u="[object DOMException]",I="[object Error]",ne="[object Function]",ye="[object GeneratorFunction]",Ee="[object Map]",Te="[object Number]",$e="[object Null]",Oe="[object Object]",xt="[object Promise]",vt="[object Proxy]",st="[object RegExp]",je="[object Set]",Ye="[object String]",Ze="[object Symbol]",nt="[object Undefined]",Ue="[object WeakMap]",Xe="[object WeakSet]",Ne="[object ArrayBuffer]",Ke="[object DataView]",ct="[object Float32Array]",ze="[object Float64Array]",Pt="[object Int8Array]",$t="[object Int16Array]",kt="[object Int32Array]",Ht="[object Uint8Array]",Mt="[object Uint8ClampedArray]",Gt="[object Uint16Array]",er="[object Uint32Array]",zr=/\b__p \+= '';/g,Wt=/\b(__p \+=) '' \+/g,Gr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ci=/&(?:amp|lt|gt|quot|#39);/g,xi=/[&<>"']/g,ut=RegExp(ci.source),tt=RegExp(xi.source),ht=/<%-([\s\S]+?)%>/g,lt=/<%([\s\S]+?)%>/g,ot=/<%=([\s\S]+?)%>/g,rt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,St=/^\w*$/,Ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ft=/[\\^$.*+?()[\]{}|]/g,At=RegExp(ft.source),pt=/^\s+/,mt=/\s/,dt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Je=/\{\n\/\* \[wrapped with (.+)\] \*/,Rt=/,? & /,Ct=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,xo=/[()=,{}\[\]\/\s]/,Po=/\\(\\)?/g,So=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,yr=/\w*$/,Oo=/^[-+]0x[0-9a-f]+$/i,Ao=/^0b[01]+$/i,Ro=/^\[object .+?Constructor\]$/,Co=/^0o[0-7]+$/i,To=/^(?:0|[1-9]\d*)$/,Wr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ki=/($^)/,No=/['\n\r\u2028\u2029\\]/g,Bi="\\ud800-\\udfff",Do="\\u0300-\\u036f",$o="\\ufe20-\\ufe2f",Vi="\\u20d0-\\u20ff",Js=Do+$o+Vi,Ys="\\u2700-\\u27bf",Rr="a-z\\xdf-\\xf6\\xf8-\\xff",Lo="\\xac\\xb1\\xd7\\xf7",jo="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Mo="\\u2000-\\u206f",zo=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Zs="A-Z\\xc0-\\xd6\\xd8-\\xde",Xs="\\ufe0e\\ufe0f",Pi=Lo+jo+Mo+zo,ps="[']",Si="["+Bi+"]",ds="["+Pi+"]",Oi="["+Js+"]",Qs="\\d+",qo="["+Ys+"]",en="["+Rr+"]",tn="[^"+Bi+Pi+Qs+Ys+Rr+Zs+"]",Fi="\\ud83c[\\udffb-\\udfff]",Uo="(?:"+Oi+"|"+Fi+")",rn="[^"+Bi+"]",Gi="(?:\\ud83c[\\udde6-\\uddff]){2}",ui="[\\ud800-\\udbff][\\udc00-\\udfff]",ur="["+Zs+"]",sn="\\u200d",nn="(?:"+en+"|"+tn+")",qr="(?:"+ur+"|"+tn+")",on="(?:"+ps+"(?:d|ll|m|re|s|t|ve))?",an="(?:"+ps+"(?:D|LL|M|RE|S|T|VE))?",cn=Uo+"?",un="["+Xs+"]?",ko="(?:"+sn+"(?:"+[rn,Gi,ui].join("|")+")"+un+cn+")*",Jr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",hn="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ln=un+cn+ko,Wi="(?:"+[qo,Gi,ui].join("|")+")"+ln,Ho="(?:"+[rn+Oi+"?",Oi,Gi,ui,Si].join("|")+")",gs=RegExp(ps,"g"),Ko=RegExp(Oi,"g"),Ji=RegExp(Fi+"(?="+Fi+")|"+Ho+ln,"g"),fn=RegExp([ur+"?"+en+"+"+on+"(?="+[ds,ur,"$"].join("|")+")",qr+"+"+an+"(?="+[ds,ur+nn,"$"].join("|")+")",ur+"?"+nn+"+"+on,ur+"+"+an,hn,Jr,Qs,Wi].join("|"),"g"),pn=RegExp("["+sn+Bi+Js+Xs+"]"),Ai=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,dn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Bo=-1,Be={};Be[ct]=Be[ze]=Be[Pt]=Be[$t]=Be[kt]=Be[Ht]=Be[Mt]=Be[Gt]=Be[er]=!0,Be[xe]=Be[It]=Be[Ne]=Be[$]=Be[Ke]=Be[R]=Be[I]=Be[ne]=Be[Ee]=Be[Te]=Be[Oe]=Be[st]=Be[je]=Be[Ye]=Be[Ue]=!1;var ke={};ke[xe]=ke[It]=ke[Ne]=ke[Ke]=ke[$]=ke[R]=ke[ct]=ke[ze]=ke[Pt]=ke[$t]=ke[kt]=ke[Ee]=ke[Te]=ke[Oe]=ke[st]=ke[je]=ke[Ye]=ke[Ze]=ke[Ht]=ke[Mt]=ke[Gt]=ke[er]=!0,ke[I]=ke[ne]=ke[Ue]=!1;var y={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},S={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},B={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},ee={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ve=parseFloat,me=parseInt,Qe=typeof zs=="object"&&zs&&zs.Object===Object&&zs,Tt=typeof self=="object"&&self&&self.Object===Object&&self,Re=Qe||Tt||Function("return this")(),Fe=r&&!r.nodeType&&r,wt=Fe&&!0&&a&&!a.nodeType&&a,tr=wt&&wt.exports===Fe,Nt=tr&&Qe.process,et=function(){try{var O=wt&&wt.require&&wt.require("util").types;return O||Nt&&Nt.binding&&Nt.binding("util")}catch{}}(),Jt=et&&et.isArrayBuffer,Cr=et&&et.isDate,vr=et&&et.isMap,Ur=et&&et.isRegExp,ys=et&&et.isSet,Ri=et&&et.isTypedArray;function zt(O,U,D){switch(D.length){case 0:return O.call(U);case 1:return O.call(U,D[0]);case 2:return O.call(U,D[0],D[1]);case 3:return O.call(U,D[0],D[1],D[2])}return O.apply(U,D)}function Hf(O,U,D,re){for(var ve=-1,Le=O==null?0:O.length;++ve<Le;){var Lt=O[ve];U(re,Lt,D(Lt),O)}return re}function mr(O,U){for(var D=-1,re=O==null?0:O.length;++D<re&&U(O[D],D,O)!==!1;);return O}function Kf(O,U){for(var D=O==null?0:O.length;D--&&U(O[D],D,O)!==!1;);return O}function Lc(O,U){for(var D=-1,re=O==null?0:O.length;++D<re;)if(!U(O[D],D,O))return!1;return!0}function hi(O,U){for(var D=-1,re=O==null?0:O.length,ve=0,Le=[];++D<re;){var Lt=O[D];U(Lt,D,O)&&(Le[ve++]=Lt)}return Le}function gn(O,U){var D=O==null?0:O.length;return!!D&&Yi(O,U,0)>-1}function Vo(O,U,D){for(var re=-1,ve=O==null?0:O.length;++re<ve;)if(D(U,O[re]))return!0;return!1}function it(O,U){for(var D=-1,re=O==null?0:O.length,ve=Array(re);++D<re;)ve[D]=U(O[D],D,O);return ve}function li(O,U){for(var D=-1,re=U.length,ve=O.length;++D<re;)O[ve+D]=U[D];return O}function Fo(O,U,D,re){var ve=-1,Le=O==null?0:O.length;for(re&&Le&&(D=O[++ve]);++ve<Le;)D=U(D,O[ve],ve,O);return D}function Bf(O,U,D,re){var ve=O==null?0:O.length;for(re&&ve&&(D=O[--ve]);ve--;)D=U(D,O[ve],ve,O);return D}function Go(O,U){for(var D=-1,re=O==null?0:O.length;++D<re;)if(U(O[D],D,O))return!0;return!1}var Vf=Wo("length");function Ff(O){return O.split("")}function Gf(O){return O.match(Ct)||[]}function jc(O,U,D){var re;return D(O,function(ve,Le,Lt){if(U(ve,Le,Lt))return re=Le,!1}),re}function yn(O,U,D,re){for(var ve=O.length,Le=D+(re?1:-1);re?Le--:++Le<ve;)if(U(O[Le],Le,O))return Le;return-1}function Yi(O,U,D){return U===U?np(O,U,D):yn(O,Mc,D)}function Wf(O,U,D,re){for(var ve=D-1,Le=O.length;++ve<Le;)if(re(O[ve],U))return ve;return-1}function Mc(O){return O!==O}function zc(O,U){var D=O==null?0:O.length;return D?Yo(O,U)/D:G}function Wo(O){return function(U){return U==null?i:U[O]}}function Jo(O){return function(U){return O==null?i:O[U]}}function qc(O,U,D,re,ve){return ve(O,function(Le,Lt,Ge){D=re?(re=!1,Le):U(D,Le,Lt,Ge)}),D}function Jf(O,U){var D=O.length;for(O.sort(U);D--;)O[D]=O[D].value;return O}function Yo(O,U){for(var D,re=-1,ve=O.length;++re<ve;){var Le=U(O[re]);Le!==i&&(D=D===i?Le:D+Le)}return D}function Zo(O,U){for(var D=-1,re=Array(O);++D<O;)re[D]=U(D);return re}function Yf(O,U){return it(U,function(D){return[D,O[D]]})}function Uc(O){return O&&O.slice(0,Bc(O)+1).replace(pt,"")}function hr(O){return function(U){return O(U)}}function Xo(O,U){return it(U,function(D){return O[D]})}function vs(O,U){return O.has(U)}function kc(O,U){for(var D=-1,re=O.length;++D<re&&Yi(U,O[D],0)>-1;);return D}function Hc(O,U){for(var D=O.length;D--&&Yi(U,O[D],0)>-1;);return D}function Zf(O,U){for(var D=O.length,re=0;D--;)O[D]===U&&++re;return re}var Xf=Jo(y),Qf=Jo(S);function ep(O){return"\\"+ee[O]}function tp(O,U){return O==null?i:O[U]}function Zi(O){return pn.test(O)}function rp(O){return Ai.test(O)}function ip(O){for(var U,D=[];!(U=O.next()).done;)D.push(U.value);return D}function Qo(O){var U=-1,D=Array(O.size);return O.forEach(function(re,ve){D[++U]=[ve,re]}),D}function Kc(O,U){return function(D){return O(U(D))}}function fi(O,U){for(var D=-1,re=O.length,ve=0,Le=[];++D<re;){var Lt=O[D];(Lt===U||Lt===x)&&(O[D]=x,Le[ve++]=D)}return Le}function vn(O){var U=-1,D=Array(O.size);return O.forEach(function(re){D[++U]=re}),D}function sp(O){var U=-1,D=Array(O.size);return O.forEach(function(re){D[++U]=[re,re]}),D}function np(O,U,D){for(var re=D-1,ve=O.length;++re<ve;)if(O[re]===U)return re;return-1}function op(O,U,D){for(var re=D+1;re--;)if(O[re]===U)return re;return re}function Xi(O){return Zi(O)?cp(O):Vf(O)}function Tr(O){return Zi(O)?up(O):Ff(O)}function Bc(O){for(var U=O.length;U--&&mt.test(O.charAt(U)););return U}var ap=Jo(B);function cp(O){for(var U=Ji.lastIndex=0;Ji.test(O);)++U;return U}function up(O){return O.match(Ji)||[]}function hp(O){return O.match(fn)||[]}var lp=function O(U){U=U==null?Re:Qi.defaults(Re.Object(),U,Qi.pick(Re,dn));var D=U.Array,re=U.Date,ve=U.Error,Le=U.Function,Lt=U.Math,Ge=U.Object,ea=U.RegExp,fp=U.String,wr=U.TypeError,mn=D.prototype,pp=Le.prototype,es=Ge.prototype,wn=U["__core-js_shared__"],_n=pp.toString,qe=es.hasOwnProperty,dp=0,Vc=function(){var e=/[^.]+$/.exec(wn&&wn.keys&&wn.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),bn=es.toString,gp=_n.call(Ge),yp=Re._,vp=ea("^"+_n.call(qe).replace(ft,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),En=tr?U.Buffer:i,pi=U.Symbol,In=U.Uint8Array,Fc=En?En.allocUnsafe:i,xn=Kc(Ge.getPrototypeOf,Ge),Gc=Ge.create,Wc=es.propertyIsEnumerable,Pn=mn.splice,Jc=pi?pi.isConcatSpreadable:i,ms=pi?pi.iterator:i,Ci=pi?pi.toStringTag:i,Sn=function(){try{var e=Li(Ge,"defineProperty");return e({},"",{}),e}catch{}}(),mp=U.clearTimeout!==Re.clearTimeout&&U.clearTimeout,wp=re&&re.now!==Re.Date.now&&re.now,_p=U.setTimeout!==Re.setTimeout&&U.setTimeout,On=Lt.ceil,An=Lt.floor,ta=Ge.getOwnPropertySymbols,bp=En?En.isBuffer:i,Yc=U.isFinite,Ep=mn.join,Ip=Kc(Ge.keys,Ge),jt=Lt.max,Vt=Lt.min,xp=re.now,Pp=U.parseInt,Zc=Lt.random,Sp=mn.reverse,ra=Li(U,"DataView"),ws=Li(U,"Map"),ia=Li(U,"Promise"),ts=Li(U,"Set"),_s=Li(U,"WeakMap"),bs=Li(Ge,"create"),Rn=_s&&new _s,rs={},Op=ji(ra),Ap=ji(ws),Rp=ji(ia),Cp=ji(ts),Tp=ji(_s),Cn=pi?pi.prototype:i,Es=Cn?Cn.valueOf:i,Xc=Cn?Cn.toString:i;function f(e){if(gt(e)&&!we(e)&&!(e instanceof Ae)){if(e instanceof _r)return e;if(qe.call(e,"__wrapped__"))return Qu(e)}return new _r(e)}var is=function(){function e(){}return function(t){if(!at(t))return{};if(Gc)return Gc(t);e.prototype=t;var s=new e;return e.prototype=i,s}}();function Tn(){}function _r(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=i}f.templateSettings={escape:ht,evaluate:lt,interpolate:ot,variable:"",imports:{_:f}},f.prototype=Tn.prototype,f.prototype.constructor=f,_r.prototype=is(Tn.prototype),_r.prototype.constructor=_r;function Ae(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Z,this.__views__=[]}function Np(){var e=new Ae(this.__wrapped__);return e.__actions__=rr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=rr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=rr(this.__views__),e}function Dp(){if(this.__filtered__){var e=new Ae(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function $p(){var e=this.__wrapped__.value(),t=this.__dir__,s=we(e),c=t<0,l=s?e.length:0,p=Fd(0,l,this.__views__),w=p.start,_=p.end,A=_-w,k=c?_:w-1,H=this.__iteratees__,F=H.length,X=0,ae=Vt(A,this.__takeCount__);if(!s||!c&&l==A&&ae==A)return Eu(e,this.__actions__);var he=[];e:for(;A--&&X<ae;){k+=t;for(var Ie=-1,le=e[k];++Ie<F;){var Se=H[Ie],Ce=Se.iteratee,pr=Se.type,Xt=Ce(le);if(pr==P)le=Xt;else if(!Xt){if(pr==g)continue e;break e}}he[X++]=le}return he}Ae.prototype=is(Tn.prototype),Ae.prototype.constructor=Ae;function Ti(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var c=e[t];this.set(c[0],c[1])}}function Lp(){this.__data__=bs?bs(null):{},this.size=0}function jp(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Mp(e){var t=this.__data__;if(bs){var s=t[e];return s===b?i:s}return qe.call(t,e)?t[e]:i}function zp(e){var t=this.__data__;return bs?t[e]!==i:qe.call(t,e)}function qp(e,t){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=bs&&t===i?b:t,this}Ti.prototype.clear=Lp,Ti.prototype.delete=jp,Ti.prototype.get=Mp,Ti.prototype.has=zp,Ti.prototype.set=qp;function Yr(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var c=e[t];this.set(c[0],c[1])}}function Up(){this.__data__=[],this.size=0}function kp(e){var t=this.__data__,s=Nn(t,e);if(s<0)return!1;var c=t.length-1;return s==c?t.pop():Pn.call(t,s,1),--this.size,!0}function Hp(e){var t=this.__data__,s=Nn(t,e);return s<0?i:t[s][1]}function Kp(e){return Nn(this.__data__,e)>-1}function Bp(e,t){var s=this.__data__,c=Nn(s,e);return c<0?(++this.size,s.push([e,t])):s[c][1]=t,this}Yr.prototype.clear=Up,Yr.prototype.delete=kp,Yr.prototype.get=Hp,Yr.prototype.has=Kp,Yr.prototype.set=Bp;function Zr(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var c=e[t];this.set(c[0],c[1])}}function Vp(){this.size=0,this.__data__={hash:new Ti,map:new(ws||Yr),string:new Ti}}function Fp(e){var t=Bn(this,e).delete(e);return this.size-=t?1:0,t}function Gp(e){return Bn(this,e).get(e)}function Wp(e){return Bn(this,e).has(e)}function Jp(e,t){var s=Bn(this,e),c=s.size;return s.set(e,t),this.size+=s.size==c?0:1,this}Zr.prototype.clear=Vp,Zr.prototype.delete=Fp,Zr.prototype.get=Gp,Zr.prototype.has=Wp,Zr.prototype.set=Jp;function Ni(e){var t=-1,s=e==null?0:e.length;for(this.__data__=new Zr;++t<s;)this.add(e[t])}function Yp(e){return this.__data__.set(e,b),this}function Zp(e){return this.__data__.has(e)}Ni.prototype.add=Ni.prototype.push=Yp,Ni.prototype.has=Zp;function Nr(e){var t=this.__data__=new Yr(e);this.size=t.size}function Xp(){this.__data__=new Yr,this.size=0}function Qp(e){var t=this.__data__,s=t.delete(e);return this.size=t.size,s}function ed(e){return this.__data__.get(e)}function td(e){return this.__data__.has(e)}function rd(e,t){var s=this.__data__;if(s instanceof Yr){var c=s.__data__;if(!ws||c.length<o-1)return c.push([e,t]),this.size=++s.size,this;s=this.__data__=new Zr(c)}return s.set(e,t),this.size=s.size,this}Nr.prototype.clear=Xp,Nr.prototype.delete=Qp,Nr.prototype.get=ed,Nr.prototype.has=td,Nr.prototype.set=rd;function Qc(e,t){var s=we(e),c=!s&&Mi(e),l=!s&&!c&&mi(e),p=!s&&!c&&!l&&as(e),w=s||c||l||p,_=w?Zo(e.length,fp):[],A=_.length;for(var k in e)(t||qe.call(e,k))&&!(w&&(k=="length"||l&&(k=="offset"||k=="parent")||p&&(k=="buffer"||k=="byteLength"||k=="byteOffset")||ti(k,A)))&&_.push(k);return _}function eu(e){var t=e.length;return t?e[da(0,t-1)]:i}function id(e,t){return Vn(rr(e),Di(t,0,e.length))}function sd(e){return Vn(rr(e))}function sa(e,t,s){(s!==i&&!Dr(e[t],s)||s===i&&!(t in e))&&Xr(e,t,s)}function Is(e,t,s){var c=e[t];(!(qe.call(e,t)&&Dr(c,s))||s===i&&!(t in e))&&Xr(e,t,s)}function Nn(e,t){for(var s=e.length;s--;)if(Dr(e[s][0],t))return s;return-1}function nd(e,t,s,c){return di(e,function(l,p,w){t(c,l,s(l),w)}),c}function tu(e,t){return e&&Hr(t,qt(t),e)}function od(e,t){return e&&Hr(t,sr(t),e)}function Xr(e,t,s){t=="__proto__"&&Sn?Sn(e,t,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[t]=s}function na(e,t){for(var s=-1,c=t.length,l=D(c),p=e==null;++s<c;)l[s]=p?i:qa(e,t[s]);return l}function Di(e,t,s){return e===e&&(s!==i&&(e=e<=s?e:s),t!==i&&(e=e>=t?e:t)),e}function br(e,t,s,c,l,p){var w,_=t&N,A=t&L,k=t&K;if(s&&(w=l?s(e,c,l,p):s(e)),w!==i)return w;if(!at(e))return e;var H=we(e);if(H){if(w=Wd(e),!_)return rr(e,w)}else{var F=Ft(e),X=F==ne||F==ye;if(mi(e))return Pu(e,_);if(F==Oe||F==xe||X&&!l){if(w=A||X?{}:Bu(e),!_)return A?Md(e,od(w,e)):jd(e,tu(w,e))}else{if(!ke[F])return l?e:{};w=Jd(e,F,_)}}p||(p=new Nr);var ae=p.get(e);if(ae)return ae;p.set(e,w),wh(e)?e.forEach(function(le){w.add(br(le,t,s,le,e,p))}):vh(e)&&e.forEach(function(le,Se){w.set(Se,br(le,t,s,Se,e,p))});var he=k?A?Pa:xa:A?sr:qt,Ie=H?i:he(e);return mr(Ie||e,function(le,Se){Ie&&(Se=le,le=e[Se]),Is(w,Se,br(le,t,s,Se,e,p))}),w}function ad(e){var t=qt(e);return function(s){return ru(s,e,t)}}function ru(e,t,s){var c=s.length;if(e==null)return!c;for(e=Ge(e);c--;){var l=s[c],p=t[l],w=e[l];if(w===i&&!(l in e)||!p(w))return!1}return!0}function iu(e,t,s){if(typeof e!="function")throw new wr(d);return Cs(function(){e.apply(i,s)},t)}function xs(e,t,s,c){var l=-1,p=gn,w=!0,_=e.length,A=[],k=t.length;if(!_)return A;s&&(t=it(t,hr(s))),c?(p=Vo,w=!1):t.length>=o&&(p=vs,w=!1,t=new Ni(t));e:for(;++l<_;){var H=e[l],F=s==null?H:s(H);if(H=c||H!==0?H:0,w&&F===F){for(var X=k;X--;)if(t[X]===F)continue e;A.push(H)}else p(t,F,c)||A.push(H)}return A}var di=Cu(kr),su=Cu(aa,!0);function cd(e,t){var s=!0;return di(e,function(c,l,p){return s=!!t(c,l,p),s}),s}function Dn(e,t,s){for(var c=-1,l=e.length;++c<l;){var p=e[c],w=t(p);if(w!=null&&(_===i?w===w&&!fr(w):s(w,_)))var _=w,A=p}return A}function ud(e,t,s,c){var l=e.length;for(s=_e(s),s<0&&(s=-s>l?0:l+s),c=c===i||c>l?l:_e(c),c<0&&(c+=l),c=s>c?0:bh(c);s<c;)e[s++]=t;return e}function nu(e,t){var s=[];return di(e,function(c,l,p){t(c,l,p)&&s.push(c)}),s}function Kt(e,t,s,c,l){var p=-1,w=e.length;for(s||(s=Zd),l||(l=[]);++p<w;){var _=e[p];t>0&&s(_)?t>1?Kt(_,t-1,s,c,l):li(l,_):c||(l[l.length]=_)}return l}var oa=Tu(),ou=Tu(!0);function kr(e,t){return e&&oa(e,t,qt)}function aa(e,t){return e&&ou(e,t,qt)}function $n(e,t){return hi(t,function(s){return ri(e[s])})}function $i(e,t){t=yi(t,e);for(var s=0,c=t.length;e!=null&&s<c;)e=e[Kr(t[s++])];return s&&s==c?e:i}function au(e,t,s){var c=t(e);return we(e)?c:li(c,s(e))}function Yt(e){return e==null?e===i?nt:$e:Ci&&Ci in Ge(e)?Vd(e):sg(e)}function ca(e,t){return e>t}function hd(e,t){return e!=null&&qe.call(e,t)}function ld(e,t){return e!=null&&t in Ge(e)}function fd(e,t,s){return e>=Vt(t,s)&&e<jt(t,s)}function ua(e,t,s){for(var c=s?Vo:gn,l=e[0].length,p=e.length,w=p,_=D(p),A=1/0,k=[];w--;){var H=e[w];w&&t&&(H=it(H,hr(t))),A=Vt(H.length,A),_[w]=!s&&(t||l>=120&&H.length>=120)?new Ni(w&&H):i}H=e[0];var F=-1,X=_[0];e:for(;++F<l&&k.length<A;){var ae=H[F],he=t?t(ae):ae;if(ae=s||ae!==0?ae:0,!(X?vs(X,he):c(k,he,s))){for(w=p;--w;){var Ie=_[w];if(!(Ie?vs(Ie,he):c(e[w],he,s)))continue e}X&&X.push(he),k.push(ae)}}return k}function pd(e,t,s,c){return kr(e,function(l,p,w){t(c,s(l),p,w)}),c}function Ps(e,t,s){t=yi(t,e),e=Wu(e,t);var c=e==null?e:e[Kr(Ir(t))];return c==null?i:zt(c,e,s)}function cu(e){return gt(e)&&Yt(e)==xe}function dd(e){return gt(e)&&Yt(e)==Ne}function gd(e){return gt(e)&&Yt(e)==R}function Ss(e,t,s,c,l){return e===t?!0:e==null||t==null||!gt(e)&&!gt(t)?e!==e&&t!==t:yd(e,t,s,c,Ss,l)}function yd(e,t,s,c,l,p){var w=we(e),_=we(t),A=w?It:Ft(e),k=_?It:Ft(t);A=A==xe?Oe:A,k=k==xe?Oe:k;var H=A==Oe,F=k==Oe,X=A==k;if(X&&mi(e)){if(!mi(t))return!1;w=!0,H=!1}if(X&&!H)return p||(p=new Nr),w||as(e)?ku(e,t,s,c,l,p):Kd(e,t,A,s,c,l,p);if(!(s&T)){var ae=H&&qe.call(e,"__wrapped__"),he=F&&qe.call(t,"__wrapped__");if(ae||he){var Ie=ae?e.value():e,le=he?t.value():t;return p||(p=new Nr),l(Ie,le,s,c,p)}}return X?(p||(p=new Nr),Bd(e,t,s,c,l,p)):!1}function vd(e){return gt(e)&&Ft(e)==Ee}function ha(e,t,s,c){var l=s.length,p=l,w=!c;if(e==null)return!p;for(e=Ge(e);l--;){var _=s[l];if(w&&_[2]?_[1]!==e[_[0]]:!(_[0]in e))return!1}for(;++l<p;){_=s[l];var A=_[0],k=e[A],H=_[1];if(w&&_[2]){if(k===i&&!(A in e))return!1}else{var F=new Nr;if(c)var X=c(k,H,A,e,t,F);if(!(X===i?Ss(H,k,T|W,c,F):X))return!1}}return!0}function uu(e){if(!at(e)||Qd(e))return!1;var t=ri(e)?vp:Ro;return t.test(ji(e))}function md(e){return gt(e)&&Yt(e)==st}function wd(e){return gt(e)&&Ft(e)==je}function _d(e){return gt(e)&&Zn(e.length)&&!!Be[Yt(e)]}function hu(e){return typeof e=="function"?e:e==null?nr:typeof e=="object"?we(e)?pu(e[0],e[1]):fu(e):Nh(e)}function la(e){if(!Rs(e))return Ip(e);var t=[];for(var s in Ge(e))qe.call(e,s)&&s!="constructor"&&t.push(s);return t}function bd(e){if(!at(e))return ig(e);var t=Rs(e),s=[];for(var c in e)c=="constructor"&&(t||!qe.call(e,c))||s.push(c);return s}function fa(e,t){return e<t}function lu(e,t){var s=-1,c=ir(e)?D(e.length):[];return di(e,function(l,p,w){c[++s]=t(l,p,w)}),c}function fu(e){var t=Oa(e);return t.length==1&&t[0][2]?Fu(t[0][0],t[0][1]):function(s){return s===e||ha(s,e,t)}}function pu(e,t){return Ra(e)&&Vu(t)?Fu(Kr(e),t):function(s){var c=qa(s,e);return c===i&&c===t?Ua(s,e):Ss(t,c,T|W)}}function Ln(e,t,s,c,l){e!==t&&oa(t,function(p,w){if(l||(l=new Nr),at(p))Ed(e,t,w,s,Ln,c,l);else{var _=c?c(Ta(e,w),p,w+"",e,t,l):i;_===i&&(_=p),sa(e,w,_)}},sr)}function Ed(e,t,s,c,l,p,w){var _=Ta(e,s),A=Ta(t,s),k=w.get(A);if(k){sa(e,s,k);return}var H=p?p(_,A,s+"",e,t,w):i,F=H===i;if(F){var X=we(A),ae=!X&&mi(A),he=!X&&!ae&&as(A);H=A,X||ae||he?we(_)?H=_:_t(_)?H=rr(_):ae?(F=!1,H=Pu(A,!0)):he?(F=!1,H=Su(A,!0)):H=[]:Ts(A)||Mi(A)?(H=_,Mi(_)?H=Eh(_):(!at(_)||ri(_))&&(H=Bu(A))):F=!1}F&&(w.set(A,H),l(H,A,c,p,w),w.delete(A)),sa(e,s,H)}function du(e,t){var s=e.length;if(s)return t+=t<0?s:0,ti(t,s)?e[t]:i}function gu(e,t,s){t.length?t=it(t,function(p){return we(p)?function(w){return $i(w,p.length===1?p[0]:p)}:p}):t=[nr];var c=-1;t=it(t,hr(ce()));var l=lu(e,function(p,w,_){var A=it(t,function(k){return k(p)});return{criteria:A,index:++c,value:p}});return Jf(l,function(p,w){return Ld(p,w,s)})}function Id(e,t){return yu(e,t,function(s,c){return Ua(e,c)})}function yu(e,t,s){for(var c=-1,l=t.length,p={};++c<l;){var w=t[c],_=$i(e,w);s(_,w)&&Os(p,yi(w,e),_)}return p}function xd(e){return function(t){return $i(t,e)}}function pa(e,t,s,c){var l=c?Wf:Yi,p=-1,w=t.length,_=e;for(e===t&&(t=rr(t)),s&&(_=it(e,hr(s)));++p<w;)for(var A=0,k=t[p],H=s?s(k):k;(A=l(_,H,A,c))>-1;)_!==e&&Pn.call(_,A,1),Pn.call(e,A,1);return e}function vu(e,t){for(var s=e?t.length:0,c=s-1;s--;){var l=t[s];if(s==c||l!==p){var p=l;ti(l)?Pn.call(e,l,1):va(e,l)}}return e}function da(e,t){return e+An(Zc()*(t-e+1))}function Pd(e,t,s,c){for(var l=-1,p=jt(On((t-e)/(s||1)),0),w=D(p);p--;)w[c?p:++l]=e,e+=s;return w}function ga(e,t){var s="";if(!e||t<1||t>Y)return s;do t%2&&(s+=e),t=An(t/2),t&&(e+=e);while(t);return s}function Pe(e,t){return Na(Gu(e,t,nr),e+"")}function Sd(e){return eu(cs(e))}function Od(e,t){var s=cs(e);return Vn(s,Di(t,0,s.length))}function Os(e,t,s,c){if(!at(e))return e;t=yi(t,e);for(var l=-1,p=t.length,w=p-1,_=e;_!=null&&++l<p;){var A=Kr(t[l]),k=s;if(A==="__proto__"||A==="constructor"||A==="prototype")return e;if(l!=w){var H=_[A];k=c?c(H,A,_):i,k===i&&(k=at(H)?H:ti(t[l+1])?[]:{})}Is(_,A,k),_=_[A]}return e}var mu=Rn?function(e,t){return Rn.set(e,t),e}:nr,Ad=Sn?function(e,t){return Sn(e,"toString",{configurable:!0,enumerable:!1,value:Ha(t),writable:!0})}:nr;function Rd(e){return Vn(cs(e))}function Er(e,t,s){var c=-1,l=e.length;t<0&&(t=-t>l?0:l+t),s=s>l?l:s,s<0&&(s+=l),l=t>s?0:s-t>>>0,t>>>=0;for(var p=D(l);++c<l;)p[c]=e[c+t];return p}function Cd(e,t){var s;return di(e,function(c,l,p){return s=t(c,l,p),!s}),!!s}function jn(e,t,s){var c=0,l=e==null?c:e.length;if(typeof t=="number"&&t===t&&l<=He){for(;c<l;){var p=c+l>>>1,w=e[p];w!==null&&!fr(w)&&(s?w<=t:w<t)?c=p+1:l=p}return l}return ya(e,t,nr,s)}function ya(e,t,s,c){var l=0,p=e==null?0:e.length;if(p===0)return 0;t=s(t);for(var w=t!==t,_=t===null,A=fr(t),k=t===i;l<p;){var H=An((l+p)/2),F=s(e[H]),X=F!==i,ae=F===null,he=F===F,Ie=fr(F);if(w)var le=c||he;else k?le=he&&(c||X):_?le=he&&X&&(c||!ae):A?le=he&&X&&!ae&&(c||!Ie):ae||Ie?le=!1:le=c?F<=t:F<t;le?l=H+1:p=H}return Vt(p,We)}function wu(e,t){for(var s=-1,c=e.length,l=0,p=[];++s<c;){var w=e[s],_=t?t(w):w;if(!s||!Dr(_,A)){var A=_;p[l++]=w===0?0:w}}return p}function _u(e){return typeof e=="number"?e:fr(e)?G:+e}function lr(e){if(typeof e=="string")return e;if(we(e))return it(e,lr)+"";if(fr(e))return Xc?Xc.call(e):"";var t=e+"";return t=="0"&&1/e==-pe?"-0":t}function gi(e,t,s){var c=-1,l=gn,p=e.length,w=!0,_=[],A=_;if(s)w=!1,l=Vo;else if(p>=o){var k=t?null:kd(e);if(k)return vn(k);w=!1,l=vs,A=new Ni}else A=t?[]:_;e:for(;++c<p;){var H=e[c],F=t?t(H):H;if(H=s||H!==0?H:0,w&&F===F){for(var X=A.length;X--;)if(A[X]===F)continue e;t&&A.push(F),_.push(H)}else l(A,F,s)||(A!==_&&A.push(F),_.push(H))}return _}function va(e,t){return t=yi(t,e),e=Wu(e,t),e==null||delete e[Kr(Ir(t))]}function bu(e,t,s,c){return Os(e,t,s($i(e,t)),c)}function Mn(e,t,s,c){for(var l=e.length,p=c?l:-1;(c?p--:++p<l)&&t(e[p],p,e););return s?Er(e,c?0:p,c?p+1:l):Er(e,c?p+1:0,c?l:p)}function Eu(e,t){var s=e;return s instanceof Ae&&(s=s.value()),Fo(t,function(c,l){return l.func.apply(l.thisArg,li([c],l.args))},s)}function ma(e,t,s){var c=e.length;if(c<2)return c?gi(e[0]):[];for(var l=-1,p=D(c);++l<c;)for(var w=e[l],_=-1;++_<c;)_!=l&&(p[l]=xs(p[l]||w,e[_],t,s));return gi(Kt(p,1),t,s)}function Iu(e,t,s){for(var c=-1,l=e.length,p=t.length,w={};++c<l;){var _=c<p?t[c]:i;s(w,e[c],_)}return w}function wa(e){return _t(e)?e:[]}function _a(e){return typeof e=="function"?e:nr}function yi(e,t){return we(e)?e:Ra(e,t)?[e]:Xu(Me(e))}var Td=Pe;function vi(e,t,s){var c=e.length;return s=s===i?c:s,!t&&s>=c?e:Er(e,t,s)}var xu=mp||function(e){return Re.clearTimeout(e)};function Pu(e,t){if(t)return e.slice();var s=e.length,c=Fc?Fc(s):new e.constructor(s);return e.copy(c),c}function ba(e){var t=new e.constructor(e.byteLength);return new In(t).set(new In(e)),t}function Nd(e,t){var s=t?ba(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.byteLength)}function Dd(e){var t=new e.constructor(e.source,yr.exec(e));return t.lastIndex=e.lastIndex,t}function $d(e){return Es?Ge(Es.call(e)):{}}function Su(e,t){var s=t?ba(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.length)}function Ou(e,t){if(e!==t){var s=e!==i,c=e===null,l=e===e,p=fr(e),w=t!==i,_=t===null,A=t===t,k=fr(t);if(!_&&!k&&!p&&e>t||p&&w&&A&&!_&&!k||c&&w&&A||!s&&A||!l)return 1;if(!c&&!p&&!k&&e<t||k&&s&&l&&!c&&!p||_&&s&&l||!w&&l||!A)return-1}return 0}function Ld(e,t,s){for(var c=-1,l=e.criteria,p=t.criteria,w=l.length,_=s.length;++c<w;){var A=Ou(l[c],p[c]);if(A){if(c>=_)return A;var k=s[c];return A*(k=="desc"?-1:1)}}return e.index-t.index}function Au(e,t,s,c){for(var l=-1,p=e.length,w=s.length,_=-1,A=t.length,k=jt(p-w,0),H=D(A+k),F=!c;++_<A;)H[_]=t[_];for(;++l<w;)(F||l<p)&&(H[s[l]]=e[l]);for(;k--;)H[_++]=e[l++];return H}function Ru(e,t,s,c){for(var l=-1,p=e.length,w=-1,_=s.length,A=-1,k=t.length,H=jt(p-_,0),F=D(H+k),X=!c;++l<H;)F[l]=e[l];for(var ae=l;++A<k;)F[ae+A]=t[A];for(;++w<_;)(X||l<p)&&(F[ae+s[w]]=e[l++]);return F}function rr(e,t){var s=-1,c=e.length;for(t||(t=D(c));++s<c;)t[s]=e[s];return t}function Hr(e,t,s,c){var l=!s;s||(s={});for(var p=-1,w=t.length;++p<w;){var _=t[p],A=c?c(s[_],e[_],_,s,e):i;A===i&&(A=e[_]),l?Xr(s,_,A):Is(s,_,A)}return s}function jd(e,t){return Hr(e,Aa(e),t)}function Md(e,t){return Hr(e,Hu(e),t)}function zn(e,t){return function(s,c){var l=we(s)?Hf:nd,p=t?t():{};return l(s,e,ce(c,2),p)}}function ss(e){return Pe(function(t,s){var c=-1,l=s.length,p=l>1?s[l-1]:i,w=l>2?s[2]:i;for(p=e.length>3&&typeof p=="function"?(l--,p):i,w&&Zt(s[0],s[1],w)&&(p=l<3?i:p,l=1),t=Ge(t);++c<l;){var _=s[c];_&&e(t,_,c,p)}return t})}function Cu(e,t){return function(s,c){if(s==null)return s;if(!ir(s))return e(s,c);for(var l=s.length,p=t?l:-1,w=Ge(s);(t?p--:++p<l)&&c(w[p],p,w)!==!1;);return s}}function Tu(e){return function(t,s,c){for(var l=-1,p=Ge(t),w=c(t),_=w.length;_--;){var A=w[e?_:++l];if(s(p[A],A,p)===!1)break}return t}}function zd(e,t,s){var c=t&se,l=As(e);function p(){var w=this&&this!==Re&&this instanceof p?l:e;return w.apply(c?s:this,arguments)}return p}function Nu(e){return function(t){t=Me(t);var s=Zi(t)?Tr(t):i,c=s?s[0]:t.charAt(0),l=s?vi(s,1).join(""):t.slice(1);return c[e]()+l}}function ns(e){return function(t){return Fo(Ch(Rh(t).replace(gs,"")),e,"")}}function As(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var s=is(e.prototype),c=e.apply(s,t);return at(c)?c:s}}function qd(e,t,s){var c=As(e);function l(){for(var p=arguments.length,w=D(p),_=p,A=os(l);_--;)w[_]=arguments[_];var k=p<3&&w[0]!==A&&w[p-1]!==A?[]:fi(w,A);if(p-=k.length,p<s)return Mu(e,t,qn,l.placeholder,i,w,k,i,i,s-p);var H=this&&this!==Re&&this instanceof l?c:e;return zt(H,this,w)}return l}function Du(e){return function(t,s,c){var l=Ge(t);if(!ir(t)){var p=ce(s,3);t=qt(t),s=function(_){return p(l[_],_,l)}}var w=e(t,s,c);return w>-1?l[p?t[w]:w]:i}}function $u(e){return ei(function(t){var s=t.length,c=s,l=_r.prototype.thru;for(e&&t.reverse();c--;){var p=t[c];if(typeof p!="function")throw new wr(d);if(l&&!w&&Kn(p)=="wrapper")var w=new _r([],!0)}for(c=w?c:s;++c<s;){p=t[c];var _=Kn(p),A=_=="wrapper"?Sa(p):i;A&&Ca(A[0])&&A[1]==(C|ue|j|q)&&!A[4].length&&A[9]==1?w=w[Kn(A[0])].apply(w,A[3]):w=p.length==1&&Ca(p)?w[_]():w.thru(p)}return function(){var k=arguments,H=k[0];if(w&&k.length==1&&we(H))return w.plant(H).value();for(var F=0,X=s?t[F].apply(this,k):H;++F<s;)X=t[F].call(this,X);return X}})}function qn(e,t,s,c,l,p,w,_,A,k){var H=t&C,F=t&se,X=t&ge,ae=t&(ue|z),he=t&Q,Ie=X?i:As(e);function le(){for(var Se=arguments.length,Ce=D(Se),pr=Se;pr--;)Ce[pr]=arguments[pr];if(ae)var Xt=os(le),dr=Zf(Ce,Xt);if(c&&(Ce=Au(Ce,c,l,ae)),p&&(Ce=Ru(Ce,p,w,ae)),Se-=dr,ae&&Se<k){var bt=fi(Ce,Xt);return Mu(e,t,qn,le.placeholder,s,Ce,bt,_,A,k-Se)}var $r=F?s:this,si=X?$r[e]:e;return Se=Ce.length,_?Ce=ng(Ce,_):he&&Se>1&&Ce.reverse(),H&&A<Se&&(Ce.length=A),this&&this!==Re&&this instanceof le&&(si=Ie||As(si)),si.apply($r,Ce)}return le}function Lu(e,t){return function(s,c){return pd(s,e,t(c),{})}}function Un(e,t){return function(s,c){var l;if(s===i&&c===i)return t;if(s!==i&&(l=s),c!==i){if(l===i)return c;typeof s=="string"||typeof c=="string"?(s=lr(s),c=lr(c)):(s=_u(s),c=_u(c)),l=e(s,c)}return l}}function Ea(e){return ei(function(t){return t=it(t,hr(ce())),Pe(function(s){var c=this;return e(t,function(l){return zt(l,c,s)})})})}function kn(e,t){t=t===i?" ":lr(t);var s=t.length;if(s<2)return s?ga(t,e):t;var c=ga(t,On(e/Xi(t)));return Zi(t)?vi(Tr(c),0,e).join(""):c.slice(0,e)}function Ud(e,t,s,c){var l=t&se,p=As(e);function w(){for(var _=-1,A=arguments.length,k=-1,H=c.length,F=D(H+A),X=this&&this!==Re&&this instanceof w?p:e;++k<H;)F[k]=c[k];for(;A--;)F[k++]=arguments[++_];return zt(X,l?s:this,F)}return w}function ju(e){return function(t,s,c){return c&&typeof c!="number"&&Zt(t,s,c)&&(s=c=i),t=ii(t),s===i?(s=t,t=0):s=ii(s),c=c===i?t<s?1:-1:ii(c),Pd(t,s,c,e)}}function Hn(e){return function(t,s){return typeof t=="string"&&typeof s=="string"||(t=xr(t),s=xr(s)),e(t,s)}}function Mu(e,t,s,c,l,p,w,_,A,k){var H=t&ue,F=H?w:i,X=H?i:w,ae=H?p:i,he=H?i:p;t|=H?j:E,t&=~(H?E:j),t&fe||(t&=~(se|ge));var Ie=[e,t,l,ae,F,he,X,_,A,k],le=s.apply(i,Ie);return Ca(e)&&Ju(le,Ie),le.placeholder=c,Yu(le,e,t)}function Ia(e){var t=Lt[e];return function(s,c){if(s=xr(s),c=c==null?0:Vt(_e(c),292),c&&Yc(s)){var l=(Me(s)+"e").split("e"),p=t(l[0]+"e"+(+l[1]+c));return l=(Me(p)+"e").split("e"),+(l[0]+"e"+(+l[1]-c))}return t(s)}}var kd=ts&&1/vn(new ts([,-0]))[1]==pe?function(e){return new ts(e)}:Va;function zu(e){return function(t){var s=Ft(t);return s==Ee?Qo(t):s==je?sp(t):Yf(t,e(t))}}function Qr(e,t,s,c,l,p,w,_){var A=t&ge;if(!A&&typeof e!="function")throw new wr(d);var k=c?c.length:0;if(k||(t&=~(j|E),c=l=i),w=w===i?w:jt(_e(w),0),_=_===i?_:_e(_),k-=l?l.length:0,t&E){var H=c,F=l;c=l=i}var X=A?i:Sa(e),ae=[e,t,s,c,l,H,F,p,w,_];if(X&&rg(ae,X),e=ae[0],t=ae[1],s=ae[2],c=ae[3],l=ae[4],_=ae[9]=ae[9]===i?A?0:e.length:jt(ae[9]-k,0),!_&&t&(ue|z)&&(t&=~(ue|z)),!t||t==se)var he=zd(e,t,s);else t==ue||t==z?he=qd(e,t,_):(t==j||t==(se|j))&&!l.length?he=Ud(e,t,s,c):he=qn.apply(i,ae);var Ie=X?mu:Ju;return Yu(Ie(he,ae),e,t)}function qu(e,t,s,c){return e===i||Dr(e,es[s])&&!qe.call(c,s)?t:e}function Uu(e,t,s,c,l,p){return at(e)&&at(t)&&(p.set(t,e),Ln(e,t,i,Uu,p),p.delete(t)),e}function Hd(e){return Ts(e)?i:e}function ku(e,t,s,c,l,p){var w=s&T,_=e.length,A=t.length;if(_!=A&&!(w&&A>_))return!1;var k=p.get(e),H=p.get(t);if(k&&H)return k==t&&H==e;var F=-1,X=!0,ae=s&W?new Ni:i;for(p.set(e,t),p.set(t,e);++F<_;){var he=e[F],Ie=t[F];if(c)var le=w?c(Ie,he,F,t,e,p):c(he,Ie,F,e,t,p);if(le!==i){if(le)continue;X=!1;break}if(ae){if(!Go(t,function(Se,Ce){if(!vs(ae,Ce)&&(he===Se||l(he,Se,s,c,p)))return ae.push(Ce)})){X=!1;break}}else if(!(he===Ie||l(he,Ie,s,c,p))){X=!1;break}}return p.delete(e),p.delete(t),X}function Kd(e,t,s,c,l,p,w){switch(s){case Ke:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Ne:return!(e.byteLength!=t.byteLength||!p(new In(e),new In(t)));case $:case R:case Te:return Dr(+e,+t);case I:return e.name==t.name&&e.message==t.message;case st:case Ye:return e==t+"";case Ee:var _=Qo;case je:var A=c&T;if(_||(_=vn),e.size!=t.size&&!A)return!1;var k=w.get(e);if(k)return k==t;c|=W,w.set(e,t);var H=ku(_(e),_(t),c,l,p,w);return w.delete(e),H;case Ze:if(Es)return Es.call(e)==Es.call(t)}return!1}function Bd(e,t,s,c,l,p){var w=s&T,_=xa(e),A=_.length,k=xa(t),H=k.length;if(A!=H&&!w)return!1;for(var F=A;F--;){var X=_[F];if(!(w?X in t:qe.call(t,X)))return!1}var ae=p.get(e),he=p.get(t);if(ae&&he)return ae==t&&he==e;var Ie=!0;p.set(e,t),p.set(t,e);for(var le=w;++F<A;){X=_[F];var Se=e[X],Ce=t[X];if(c)var pr=w?c(Ce,Se,X,t,e,p):c(Se,Ce,X,e,t,p);if(!(pr===i?Se===Ce||l(Se,Ce,s,c,p):pr)){Ie=!1;break}le||(le=X=="constructor")}if(Ie&&!le){var Xt=e.constructor,dr=t.constructor;Xt!=dr&&"constructor"in e&&"constructor"in t&&!(typeof Xt=="function"&&Xt instanceof Xt&&typeof dr=="function"&&dr instanceof dr)&&(Ie=!1)}return p.delete(e),p.delete(t),Ie}function ei(e){return Na(Gu(e,i,rh),e+"")}function xa(e){return au(e,qt,Aa)}function Pa(e){return au(e,sr,Hu)}var Sa=Rn?function(e){return Rn.get(e)}:Va;function Kn(e){for(var t=e.name+"",s=rs[t],c=qe.call(rs,t)?s.length:0;c--;){var l=s[c],p=l.func;if(p==null||p==e)return l.name}return t}function os(e){var t=qe.call(f,"placeholder")?f:e;return t.placeholder}function ce(){var e=f.iteratee||Ka;return e=e===Ka?hu:e,arguments.length?e(arguments[0],arguments[1]):e}function Bn(e,t){var s=e.__data__;return Xd(t)?s[typeof t=="string"?"string":"hash"]:s.map}function Oa(e){for(var t=qt(e),s=t.length;s--;){var c=t[s],l=e[c];t[s]=[c,l,Vu(l)]}return t}function Li(e,t){var s=tp(e,t);return uu(s)?s:i}function Vd(e){var t=qe.call(e,Ci),s=e[Ci];try{e[Ci]=i;var c=!0}catch{}var l=bn.call(e);return c&&(t?e[Ci]=s:delete e[Ci]),l}var Aa=ta?function(e){return e==null?[]:(e=Ge(e),hi(ta(e),function(t){return Wc.call(e,t)}))}:Fa,Hu=ta?function(e){for(var t=[];e;)li(t,Aa(e)),e=xn(e);return t}:Fa,Ft=Yt;(ra&&Ft(new ra(new ArrayBuffer(1)))!=Ke||ws&&Ft(new ws)!=Ee||ia&&Ft(ia.resolve())!=xt||ts&&Ft(new ts)!=je||_s&&Ft(new _s)!=Ue)&&(Ft=function(e){var t=Yt(e),s=t==Oe?e.constructor:i,c=s?ji(s):"";if(c)switch(c){case Op:return Ke;case Ap:return Ee;case Rp:return xt;case Cp:return je;case Tp:return Ue}return t});function Fd(e,t,s){for(var c=-1,l=s.length;++c<l;){var p=s[c],w=p.size;switch(p.type){case"drop":e+=w;break;case"dropRight":t-=w;break;case"take":t=Vt(t,e+w);break;case"takeRight":e=jt(e,t-w);break}}return{start:e,end:t}}function Gd(e){var t=e.match(Je);return t?t[1].split(Rt):[]}function Ku(e,t,s){t=yi(t,e);for(var c=-1,l=t.length,p=!1;++c<l;){var w=Kr(t[c]);if(!(p=e!=null&&s(e,w)))break;e=e[w]}return p||++c!=l?p:(l=e==null?0:e.length,!!l&&Zn(l)&&ti(w,l)&&(we(e)||Mi(e)))}function Wd(e){var t=e.length,s=new e.constructor(t);return t&&typeof e[0]=="string"&&qe.call(e,"index")&&(s.index=e.index,s.input=e.input),s}function Bu(e){return typeof e.constructor=="function"&&!Rs(e)?is(xn(e)):{}}function Jd(e,t,s){var c=e.constructor;switch(t){case Ne:return ba(e);case $:case R:return new c(+e);case Ke:return Nd(e,s);case ct:case ze:case Pt:case $t:case kt:case Ht:case Mt:case Gt:case er:return Su(e,s);case Ee:return new c;case Te:case Ye:return new c(e);case st:return Dd(e);case je:return new c;case Ze:return $d(e)}}function Yd(e,t){var s=t.length;if(!s)return e;var c=s-1;return t[c]=(s>1?"& ":"")+t[c],t=t.join(s>2?", ":" "),e.replace(dt,`{
/* [wrapped with `+t+`] */
`)}function Zd(e){return we(e)||Mi(e)||!!(Jc&&e&&e[Jc])}function ti(e,t){var s=typeof e;return t=t??Y,!!t&&(s=="number"||s!="symbol"&&To.test(e))&&e>-1&&e%1==0&&e<t}function Zt(e,t,s){if(!at(s))return!1;var c=typeof t;return(c=="number"?ir(s)&&ti(t,s.length):c=="string"&&t in s)?Dr(s[t],e):!1}function Ra(e,t){if(we(e))return!1;var s=typeof e;return s=="number"||s=="symbol"||s=="boolean"||e==null||fr(e)?!0:St.test(e)||!rt.test(e)||t!=null&&e in Ge(t)}function Xd(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Ca(e){var t=Kn(e),s=f[t];if(typeof s!="function"||!(t in Ae.prototype))return!1;if(e===s)return!0;var c=Sa(s);return!!c&&e===c[0]}function Qd(e){return!!Vc&&Vc in e}var eg=wn?ri:Ga;function Rs(e){var t=e&&e.constructor,s=typeof t=="function"&&t.prototype||es;return e===s}function Vu(e){return e===e&&!at(e)}function Fu(e,t){return function(s){return s==null?!1:s[e]===t&&(t!==i||e in Ge(s))}}function tg(e){var t=Jn(e,function(c){return s.size===v&&s.clear(),c}),s=t.cache;return t}function rg(e,t){var s=e[1],c=t[1],l=s|c,p=l<(se|ge|C),w=c==C&&s==ue||c==C&&s==q&&e[7].length<=t[8]||c==(C|q)&&t[7].length<=t[8]&&s==ue;if(!(p||w))return e;c&se&&(e[2]=t[2],l|=s&se?0:fe);var _=t[3];if(_){var A=e[3];e[3]=A?Au(A,_,t[4]):_,e[4]=A?fi(e[3],x):t[4]}return _=t[5],_&&(A=e[5],e[5]=A?Ru(A,_,t[6]):_,e[6]=A?fi(e[5],x):t[6]),_=t[7],_&&(e[7]=_),c&C&&(e[8]=e[8]==null?t[8]:Vt(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=l,e}function ig(e){var t=[];if(e!=null)for(var s in Ge(e))t.push(s);return t}function sg(e){return bn.call(e)}function Gu(e,t,s){return t=jt(t===i?e.length-1:t,0),function(){for(var c=arguments,l=-1,p=jt(c.length-t,0),w=D(p);++l<p;)w[l]=c[t+l];l=-1;for(var _=D(t+1);++l<t;)_[l]=c[l];return _[t]=s(w),zt(e,this,_)}}function Wu(e,t){return t.length<2?e:$i(e,Er(t,0,-1))}function ng(e,t){for(var s=e.length,c=Vt(t.length,s),l=rr(e);c--;){var p=t[c];e[c]=ti(p,s)?l[p]:i}return e}function Ta(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var Ju=Zu(mu),Cs=_p||function(e,t){return Re.setTimeout(e,t)},Na=Zu(Ad);function Yu(e,t,s){var c=t+"";return Na(e,Yd(c,og(Gd(c),s)))}function Zu(e){var t=0,s=0;return function(){var c=xp(),l=De-(c-s);if(s=c,l>0){if(++t>=be)return arguments[0]}else t=0;return e.apply(i,arguments)}}function Vn(e,t){var s=-1,c=e.length,l=c-1;for(t=t===i?c:t;++s<t;){var p=da(s,l),w=e[p];e[p]=e[s],e[s]=w}return e.length=t,e}var Xu=tg(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Ot,function(s,c,l,p){t.push(l?p.replace(Po,"$1"):c||s)}),t});function Kr(e){if(typeof e=="string"||fr(e))return e;var t=e+"";return t=="0"&&1/e==-pe?"-0":t}function ji(e){if(e!=null){try{return _n.call(e)}catch{}try{return e+""}catch{}}return""}function og(e,t){return mr(Mr,function(s){var c="_."+s[0];t&s[1]&&!gn(e,c)&&e.push(c)}),e.sort()}function Qu(e){if(e instanceof Ae)return e.clone();var t=new _r(e.__wrapped__,e.__chain__);return t.__actions__=rr(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function ag(e,t,s){(s?Zt(e,t,s):t===i)?t=1:t=jt(_e(t),0);var c=e==null?0:e.length;if(!c||t<1)return[];for(var l=0,p=0,w=D(On(c/t));l<c;)w[p++]=Er(e,l,l+=t);return w}function cg(e){for(var t=-1,s=e==null?0:e.length,c=0,l=[];++t<s;){var p=e[t];p&&(l[c++]=p)}return l}function ug(){var e=arguments.length;if(!e)return[];for(var t=D(e-1),s=arguments[0],c=e;c--;)t[c-1]=arguments[c];return li(we(s)?rr(s):[s],Kt(t,1))}var hg=Pe(function(e,t){return _t(e)?xs(e,Kt(t,1,_t,!0)):[]}),lg=Pe(function(e,t){var s=Ir(t);return _t(s)&&(s=i),_t(e)?xs(e,Kt(t,1,_t,!0),ce(s,2)):[]}),fg=Pe(function(e,t){var s=Ir(t);return _t(s)&&(s=i),_t(e)?xs(e,Kt(t,1,_t,!0),i,s):[]});function pg(e,t,s){var c=e==null?0:e.length;return c?(t=s||t===i?1:_e(t),Er(e,t<0?0:t,c)):[]}function dg(e,t,s){var c=e==null?0:e.length;return c?(t=s||t===i?1:_e(t),t=c-t,Er(e,0,t<0?0:t)):[]}function gg(e,t){return e&&e.length?Mn(e,ce(t,3),!0,!0):[]}function yg(e,t){return e&&e.length?Mn(e,ce(t,3),!0):[]}function vg(e,t,s,c){var l=e==null?0:e.length;return l?(s&&typeof s!="number"&&Zt(e,t,s)&&(s=0,c=l),ud(e,t,s,c)):[]}function eh(e,t,s){var c=e==null?0:e.length;if(!c)return-1;var l=s==null?0:_e(s);return l<0&&(l=jt(c+l,0)),yn(e,ce(t,3),l)}function th(e,t,s){var c=e==null?0:e.length;if(!c)return-1;var l=c-1;return s!==i&&(l=_e(s),l=s<0?jt(c+l,0):Vt(l,c-1)),yn(e,ce(t,3),l,!0)}function rh(e){var t=e==null?0:e.length;return t?Kt(e,1):[]}function mg(e){var t=e==null?0:e.length;return t?Kt(e,pe):[]}function wg(e,t){var s=e==null?0:e.length;return s?(t=t===i?1:_e(t),Kt(e,t)):[]}function _g(e){for(var t=-1,s=e==null?0:e.length,c={};++t<s;){var l=e[t];c[l[0]]=l[1]}return c}function ih(e){return e&&e.length?e[0]:i}function bg(e,t,s){var c=e==null?0:e.length;if(!c)return-1;var l=s==null?0:_e(s);return l<0&&(l=jt(c+l,0)),Yi(e,t,l)}function Eg(e){var t=e==null?0:e.length;return t?Er(e,0,-1):[]}var Ig=Pe(function(e){var t=it(e,wa);return t.length&&t[0]===e[0]?ua(t):[]}),xg=Pe(function(e){var t=Ir(e),s=it(e,wa);return t===Ir(s)?t=i:s.pop(),s.length&&s[0]===e[0]?ua(s,ce(t,2)):[]}),Pg=Pe(function(e){var t=Ir(e),s=it(e,wa);return t=typeof t=="function"?t:i,t&&s.pop(),s.length&&s[0]===e[0]?ua(s,i,t):[]});function Sg(e,t){return e==null?"":Ep.call(e,t)}function Ir(e){var t=e==null?0:e.length;return t?e[t-1]:i}function Og(e,t,s){var c=e==null?0:e.length;if(!c)return-1;var l=c;return s!==i&&(l=_e(s),l=l<0?jt(c+l,0):Vt(l,c-1)),t===t?op(e,t,l):yn(e,Mc,l,!0)}function Ag(e,t){return e&&e.length?du(e,_e(t)):i}var Rg=Pe(sh);function sh(e,t){return e&&e.length&&t&&t.length?pa(e,t):e}function Cg(e,t,s){return e&&e.length&&t&&t.length?pa(e,t,ce(s,2)):e}function Tg(e,t,s){return e&&e.length&&t&&t.length?pa(e,t,i,s):e}var Ng=ei(function(e,t){var s=e==null?0:e.length,c=na(e,t);return vu(e,it(t,function(l){return ti(l,s)?+l:l}).sort(Ou)),c});function Dg(e,t){var s=[];if(!(e&&e.length))return s;var c=-1,l=[],p=e.length;for(t=ce(t,3);++c<p;){var w=e[c];t(w,c,e)&&(s.push(w),l.push(c))}return vu(e,l),s}function Da(e){return e==null?e:Sp.call(e)}function $g(e,t,s){var c=e==null?0:e.length;return c?(s&&typeof s!="number"&&Zt(e,t,s)?(t=0,s=c):(t=t==null?0:_e(t),s=s===i?c:_e(s)),Er(e,t,s)):[]}function Lg(e,t){return jn(e,t)}function jg(e,t,s){return ya(e,t,ce(s,2))}function Mg(e,t){var s=e==null?0:e.length;if(s){var c=jn(e,t);if(c<s&&Dr(e[c],t))return c}return-1}function zg(e,t){return jn(e,t,!0)}function qg(e,t,s){return ya(e,t,ce(s,2),!0)}function Ug(e,t){var s=e==null?0:e.length;if(s){var c=jn(e,t,!0)-1;if(Dr(e[c],t))return c}return-1}function kg(e){return e&&e.length?wu(e):[]}function Hg(e,t){return e&&e.length?wu(e,ce(t,2)):[]}function Kg(e){var t=e==null?0:e.length;return t?Er(e,1,t):[]}function Bg(e,t,s){return e&&e.length?(t=s||t===i?1:_e(t),Er(e,0,t<0?0:t)):[]}function Vg(e,t,s){var c=e==null?0:e.length;return c?(t=s||t===i?1:_e(t),t=c-t,Er(e,t<0?0:t,c)):[]}function Fg(e,t){return e&&e.length?Mn(e,ce(t,3),!1,!0):[]}function Gg(e,t){return e&&e.length?Mn(e,ce(t,3)):[]}var Wg=Pe(function(e){return gi(Kt(e,1,_t,!0))}),Jg=Pe(function(e){var t=Ir(e);return _t(t)&&(t=i),gi(Kt(e,1,_t,!0),ce(t,2))}),Yg=Pe(function(e){var t=Ir(e);return t=typeof t=="function"?t:i,gi(Kt(e,1,_t,!0),i,t)});function Zg(e){return e&&e.length?gi(e):[]}function Xg(e,t){return e&&e.length?gi(e,ce(t,2)):[]}function Qg(e,t){return t=typeof t=="function"?t:i,e&&e.length?gi(e,i,t):[]}function $a(e){if(!(e&&e.length))return[];var t=0;return e=hi(e,function(s){if(_t(s))return t=jt(s.length,t),!0}),Zo(t,function(s){return it(e,Wo(s))})}function nh(e,t){if(!(e&&e.length))return[];var s=$a(e);return t==null?s:it(s,function(c){return zt(t,i,c)})}var ey=Pe(function(e,t){return _t(e)?xs(e,t):[]}),ty=Pe(function(e){return ma(hi(e,_t))}),ry=Pe(function(e){var t=Ir(e);return _t(t)&&(t=i),ma(hi(e,_t),ce(t,2))}),iy=Pe(function(e){var t=Ir(e);return t=typeof t=="function"?t:i,ma(hi(e,_t),i,t)}),sy=Pe($a);function ny(e,t){return Iu(e||[],t||[],Is)}function oy(e,t){return Iu(e||[],t||[],Os)}var ay=Pe(function(e){var t=e.length,s=t>1?e[t-1]:i;return s=typeof s=="function"?(e.pop(),s):i,nh(e,s)});function oh(e){var t=f(e);return t.__chain__=!0,t}function cy(e,t){return t(e),e}function Fn(e,t){return t(e)}var uy=ei(function(e){var t=e.length,s=t?e[0]:0,c=this.__wrapped__,l=function(p){return na(p,e)};return t>1||this.__actions__.length||!(c instanceof Ae)||!ti(s)?this.thru(l):(c=c.slice(s,+s+(t?1:0)),c.__actions__.push({func:Fn,args:[l],thisArg:i}),new _r(c,this.__chain__).thru(function(p){return t&&!p.length&&p.push(i),p}))});function hy(){return oh(this)}function ly(){return new _r(this.value(),this.__chain__)}function fy(){this.__values__===i&&(this.__values__=_h(this.value()));var e=this.__index__>=this.__values__.length,t=e?i:this.__values__[this.__index__++];return{done:e,value:t}}function py(){return this}function dy(e){for(var t,s=this;s instanceof Tn;){var c=Qu(s);c.__index__=0,c.__values__=i,t?l.__wrapped__=c:t=c;var l=c;s=s.__wrapped__}return l.__wrapped__=e,t}function gy(){var e=this.__wrapped__;if(e instanceof Ae){var t=e;return this.__actions__.length&&(t=new Ae(this)),t=t.reverse(),t.__actions__.push({func:Fn,args:[Da],thisArg:i}),new _r(t,this.__chain__)}return this.thru(Da)}function yy(){return Eu(this.__wrapped__,this.__actions__)}var vy=zn(function(e,t,s){qe.call(e,s)?++e[s]:Xr(e,s,1)});function my(e,t,s){var c=we(e)?Lc:cd;return s&&Zt(e,t,s)&&(t=i),c(e,ce(t,3))}function wy(e,t){var s=we(e)?hi:nu;return s(e,ce(t,3))}var _y=Du(eh),by=Du(th);function Ey(e,t){return Kt(Gn(e,t),1)}function Iy(e,t){return Kt(Gn(e,t),pe)}function xy(e,t,s){return s=s===i?1:_e(s),Kt(Gn(e,t),s)}function ah(e,t){var s=we(e)?mr:di;return s(e,ce(t,3))}function ch(e,t){var s=we(e)?Kf:su;return s(e,ce(t,3))}var Py=zn(function(e,t,s){qe.call(e,s)?e[s].push(t):Xr(e,s,[t])});function Sy(e,t,s,c){e=ir(e)?e:cs(e),s=s&&!c?_e(s):0;var l=e.length;return s<0&&(s=jt(l+s,0)),Xn(e)?s<=l&&e.indexOf(t,s)>-1:!!l&&Yi(e,t,s)>-1}var Oy=Pe(function(e,t,s){var c=-1,l=typeof t=="function",p=ir(e)?D(e.length):[];return di(e,function(w){p[++c]=l?zt(t,w,s):Ps(w,t,s)}),p}),Ay=zn(function(e,t,s){Xr(e,s,t)});function Gn(e,t){var s=we(e)?it:lu;return s(e,ce(t,3))}function Ry(e,t,s,c){return e==null?[]:(we(t)||(t=t==null?[]:[t]),s=c?i:s,we(s)||(s=s==null?[]:[s]),gu(e,t,s))}var Cy=zn(function(e,t,s){e[s?0:1].push(t)},function(){return[[],[]]});function Ty(e,t,s){var c=we(e)?Fo:qc,l=arguments.length<3;return c(e,ce(t,4),s,l,di)}function Ny(e,t,s){var c=we(e)?Bf:qc,l=arguments.length<3;return c(e,ce(t,4),s,l,su)}function Dy(e,t){var s=we(e)?hi:nu;return s(e,Yn(ce(t,3)))}function $y(e){var t=we(e)?eu:Sd;return t(e)}function Ly(e,t,s){(s?Zt(e,t,s):t===i)?t=1:t=_e(t);var c=we(e)?id:Od;return c(e,t)}function jy(e){var t=we(e)?sd:Rd;return t(e)}function My(e){if(e==null)return 0;if(ir(e))return Xn(e)?Xi(e):e.length;var t=Ft(e);return t==Ee||t==je?e.size:la(e).length}function zy(e,t,s){var c=we(e)?Go:Cd;return s&&Zt(e,t,s)&&(t=i),c(e,ce(t,3))}var qy=Pe(function(e,t){if(e==null)return[];var s=t.length;return s>1&&Zt(e,t[0],t[1])?t=[]:s>2&&Zt(t[0],t[1],t[2])&&(t=[t[0]]),gu(e,Kt(t,1),[])}),Wn=wp||function(){return Re.Date.now()};function Uy(e,t){if(typeof t!="function")throw new wr(d);return e=_e(e),function(){if(--e<1)return t.apply(this,arguments)}}function uh(e,t,s){return t=s?i:t,t=e&&t==null?e.length:t,Qr(e,C,i,i,i,i,t)}function hh(e,t){var s;if(typeof t!="function")throw new wr(d);return e=_e(e),function(){return--e>0&&(s=t.apply(this,arguments)),e<=1&&(t=i),s}}var La=Pe(function(e,t,s){var c=se;if(s.length){var l=fi(s,os(La));c|=j}return Qr(e,c,t,s,l)}),lh=Pe(function(e,t,s){var c=se|ge;if(s.length){var l=fi(s,os(lh));c|=j}return Qr(t,c,e,s,l)});function fh(e,t,s){t=s?i:t;var c=Qr(e,ue,i,i,i,i,i,t);return c.placeholder=fh.placeholder,c}function ph(e,t,s){t=s?i:t;var c=Qr(e,z,i,i,i,i,i,t);return c.placeholder=ph.placeholder,c}function dh(e,t,s){var c,l,p,w,_,A,k=0,H=!1,F=!1,X=!0;if(typeof e!="function")throw new wr(d);t=xr(t)||0,at(s)&&(H=!!s.leading,F="maxWait"in s,p=F?jt(xr(s.maxWait)||0,t):p,X="trailing"in s?!!s.trailing:X);function ae(bt){var $r=c,si=l;return c=l=i,k=bt,w=e.apply(si,$r),w}function he(bt){return k=bt,_=Cs(Se,t),H?ae(bt):w}function Ie(bt){var $r=bt-A,si=bt-k,Dh=t-$r;return F?Vt(Dh,p-si):Dh}function le(bt){var $r=bt-A,si=bt-k;return A===i||$r>=t||$r<0||F&&si>=p}function Se(){var bt=Wn();if(le(bt))return Ce(bt);_=Cs(Se,Ie(bt))}function Ce(bt){return _=i,X&&c?ae(bt):(c=l=i,w)}function pr(){_!==i&&xu(_),k=0,c=A=l=_=i}function Xt(){return _===i?w:Ce(Wn())}function dr(){var bt=Wn(),$r=le(bt);if(c=arguments,l=this,A=bt,$r){if(_===i)return he(A);if(F)return xu(_),_=Cs(Se,t),ae(A)}return _===i&&(_=Cs(Se,t)),w}return dr.cancel=pr,dr.flush=Xt,dr}var ky=Pe(function(e,t){return iu(e,1,t)}),Hy=Pe(function(e,t,s){return iu(e,xr(t)||0,s)});function Ky(e){return Qr(e,Q)}function Jn(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new wr(d);var s=function(){var c=arguments,l=t?t.apply(this,c):c[0],p=s.cache;if(p.has(l))return p.get(l);var w=e.apply(this,c);return s.cache=p.set(l,w)||p,w};return s.cache=new(Jn.Cache||Zr),s}Jn.Cache=Zr;function Yn(e){if(typeof e!="function")throw new wr(d);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function By(e){return hh(2,e)}var Vy=Td(function(e,t){t=t.length==1&&we(t[0])?it(t[0],hr(ce())):it(Kt(t,1),hr(ce()));var s=t.length;return Pe(function(c){for(var l=-1,p=Vt(c.length,s);++l<p;)c[l]=t[l].call(this,c[l]);return zt(e,this,c)})}),ja=Pe(function(e,t){var s=fi(t,os(ja));return Qr(e,j,i,t,s)}),gh=Pe(function(e,t){var s=fi(t,os(gh));return Qr(e,E,i,t,s)}),Fy=ei(function(e,t){return Qr(e,q,i,i,i,t)});function Gy(e,t){if(typeof e!="function")throw new wr(d);return t=t===i?t:_e(t),Pe(e,t)}function Wy(e,t){if(typeof e!="function")throw new wr(d);return t=t==null?0:jt(_e(t),0),Pe(function(s){var c=s[t],l=vi(s,0,t);return c&&li(l,c),zt(e,this,l)})}function Jy(e,t,s){var c=!0,l=!0;if(typeof e!="function")throw new wr(d);return at(s)&&(c="leading"in s?!!s.leading:c,l="trailing"in s?!!s.trailing:l),dh(e,t,{leading:c,maxWait:t,trailing:l})}function Yy(e){return uh(e,1)}function Zy(e,t){return ja(_a(t),e)}function Xy(){if(!arguments.length)return[];var e=arguments[0];return we(e)?e:[e]}function Qy(e){return br(e,K)}function ev(e,t){return t=typeof t=="function"?t:i,br(e,K,t)}function tv(e){return br(e,N|K)}function rv(e,t){return t=typeof t=="function"?t:i,br(e,N|K,t)}function iv(e,t){return t==null||ru(e,t,qt(t))}function Dr(e,t){return e===t||e!==e&&t!==t}var sv=Hn(ca),nv=Hn(function(e,t){return e>=t}),Mi=cu(function(){return arguments}())?cu:function(e){return gt(e)&&qe.call(e,"callee")&&!Wc.call(e,"callee")},we=D.isArray,ov=Jt?hr(Jt):dd;function ir(e){return e!=null&&Zn(e.length)&&!ri(e)}function _t(e){return gt(e)&&ir(e)}function av(e){return e===!0||e===!1||gt(e)&&Yt(e)==$}var mi=bp||Ga,cv=Cr?hr(Cr):gd;function uv(e){return gt(e)&&e.nodeType===1&&!Ts(e)}function hv(e){if(e==null)return!0;if(ir(e)&&(we(e)||typeof e=="string"||typeof e.splice=="function"||mi(e)||as(e)||Mi(e)))return!e.length;var t=Ft(e);if(t==Ee||t==je)return!e.size;if(Rs(e))return!la(e).length;for(var s in e)if(qe.call(e,s))return!1;return!0}function lv(e,t){return Ss(e,t)}function fv(e,t,s){s=typeof s=="function"?s:i;var c=s?s(e,t):i;return c===i?Ss(e,t,i,s):!!c}function Ma(e){if(!gt(e))return!1;var t=Yt(e);return t==I||t==u||typeof e.message=="string"&&typeof e.name=="string"&&!Ts(e)}function pv(e){return typeof e=="number"&&Yc(e)}function ri(e){if(!at(e))return!1;var t=Yt(e);return t==ne||t==ye||t==M||t==vt}function yh(e){return typeof e=="number"&&e==_e(e)}function Zn(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Y}function at(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function gt(e){return e!=null&&typeof e=="object"}var vh=vr?hr(vr):vd;function dv(e,t){return e===t||ha(e,t,Oa(t))}function gv(e,t,s){return s=typeof s=="function"?s:i,ha(e,t,Oa(t),s)}function yv(e){return mh(e)&&e!=+e}function vv(e){if(eg(e))throw new ve(h);return uu(e)}function mv(e){return e===null}function wv(e){return e==null}function mh(e){return typeof e=="number"||gt(e)&&Yt(e)==Te}function Ts(e){if(!gt(e)||Yt(e)!=Oe)return!1;var t=xn(e);if(t===null)return!0;var s=qe.call(t,"constructor")&&t.constructor;return typeof s=="function"&&s instanceof s&&_n.call(s)==gp}var za=Ur?hr(Ur):md;function _v(e){return yh(e)&&e>=-Y&&e<=Y}var wh=ys?hr(ys):wd;function Xn(e){return typeof e=="string"||!we(e)&&gt(e)&&Yt(e)==Ye}function fr(e){return typeof e=="symbol"||gt(e)&&Yt(e)==Ze}var as=Ri?hr(Ri):_d;function bv(e){return e===i}function Ev(e){return gt(e)&&Ft(e)==Ue}function Iv(e){return gt(e)&&Yt(e)==Xe}var xv=Hn(fa),Pv=Hn(function(e,t){return e<=t});function _h(e){if(!e)return[];if(ir(e))return Xn(e)?Tr(e):rr(e);if(ms&&e[ms])return ip(e[ms]());var t=Ft(e),s=t==Ee?Qo:t==je?vn:cs;return s(e)}function ii(e){if(!e)return e===0?e:0;if(e=xr(e),e===pe||e===-pe){var t=e<0?-1:1;return t*V}return e===e?e:0}function _e(e){var t=ii(e),s=t%1;return t===t?s?t-s:t:0}function bh(e){return e?Di(_e(e),0,Z):0}function xr(e){if(typeof e=="number")return e;if(fr(e))return G;if(at(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=at(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Uc(e);var s=Ao.test(e);return s||Co.test(e)?me(e.slice(2),s?2:8):Oo.test(e)?G:+e}function Eh(e){return Hr(e,sr(e))}function Sv(e){return e?Di(_e(e),-Y,Y):e===0?e:0}function Me(e){return e==null?"":lr(e)}var Ov=ss(function(e,t){if(Rs(t)||ir(t)){Hr(t,qt(t),e);return}for(var s in t)qe.call(t,s)&&Is(e,s,t[s])}),Ih=ss(function(e,t){Hr(t,sr(t),e)}),Qn=ss(function(e,t,s,c){Hr(t,sr(t),e,c)}),Av=ss(function(e,t,s,c){Hr(t,qt(t),e,c)}),Rv=ei(na);function Cv(e,t){var s=is(e);return t==null?s:tu(s,t)}var Tv=Pe(function(e,t){e=Ge(e);var s=-1,c=t.length,l=c>2?t[2]:i;for(l&&Zt(t[0],t[1],l)&&(c=1);++s<c;)for(var p=t[s],w=sr(p),_=-1,A=w.length;++_<A;){var k=w[_],H=e[k];(H===i||Dr(H,es[k])&&!qe.call(e,k))&&(e[k]=p[k])}return e}),Nv=Pe(function(e){return e.push(i,Uu),zt(xh,i,e)});function Dv(e,t){return jc(e,ce(t,3),kr)}function $v(e,t){return jc(e,ce(t,3),aa)}function Lv(e,t){return e==null?e:oa(e,ce(t,3),sr)}function jv(e,t){return e==null?e:ou(e,ce(t,3),sr)}function Mv(e,t){return e&&kr(e,ce(t,3))}function zv(e,t){return e&&aa(e,ce(t,3))}function qv(e){return e==null?[]:$n(e,qt(e))}function Uv(e){return e==null?[]:$n(e,sr(e))}function qa(e,t,s){var c=e==null?i:$i(e,t);return c===i?s:c}function kv(e,t){return e!=null&&Ku(e,t,hd)}function Ua(e,t){return e!=null&&Ku(e,t,ld)}var Hv=Lu(function(e,t,s){t!=null&&typeof t.toString!="function"&&(t=bn.call(t)),e[t]=s},Ha(nr)),Kv=Lu(function(e,t,s){t!=null&&typeof t.toString!="function"&&(t=bn.call(t)),qe.call(e,t)?e[t].push(s):e[t]=[s]},ce),Bv=Pe(Ps);function qt(e){return ir(e)?Qc(e):la(e)}function sr(e){return ir(e)?Qc(e,!0):bd(e)}function Vv(e,t){var s={};return t=ce(t,3),kr(e,function(c,l,p){Xr(s,t(c,l,p),c)}),s}function Fv(e,t){var s={};return t=ce(t,3),kr(e,function(c,l,p){Xr(s,l,t(c,l,p))}),s}var Gv=ss(function(e,t,s){Ln(e,t,s)}),xh=ss(function(e,t,s,c){Ln(e,t,s,c)}),Wv=ei(function(e,t){var s={};if(e==null)return s;var c=!1;t=it(t,function(p){return p=yi(p,e),c||(c=p.length>1),p}),Hr(e,Pa(e),s),c&&(s=br(s,N|L|K,Hd));for(var l=t.length;l--;)va(s,t[l]);return s});function Jv(e,t){return Ph(e,Yn(ce(t)))}var Yv=ei(function(e,t){return e==null?{}:Id(e,t)});function Ph(e,t){if(e==null)return{};var s=it(Pa(e),function(c){return[c]});return t=ce(t),yu(e,s,function(c,l){return t(c,l[0])})}function Zv(e,t,s){t=yi(t,e);var c=-1,l=t.length;for(l||(l=1,e=i);++c<l;){var p=e==null?i:e[Kr(t[c])];p===i&&(c=l,p=s),e=ri(p)?p.call(e):p}return e}function Xv(e,t,s){return e==null?e:Os(e,t,s)}function Qv(e,t,s,c){return c=typeof c=="function"?c:i,e==null?e:Os(e,t,s,c)}var Sh=zu(qt),Oh=zu(sr);function e0(e,t,s){var c=we(e),l=c||mi(e)||as(e);if(t=ce(t,4),s==null){var p=e&&e.constructor;l?s=c?new p:[]:at(e)?s=ri(p)?is(xn(e)):{}:s={}}return(l?mr:kr)(e,function(w,_,A){return t(s,w,_,A)}),s}function t0(e,t){return e==null?!0:va(e,t)}function r0(e,t,s){return e==null?e:bu(e,t,_a(s))}function i0(e,t,s,c){return c=typeof c=="function"?c:i,e==null?e:bu(e,t,_a(s),c)}function cs(e){return e==null?[]:Xo(e,qt(e))}function s0(e){return e==null?[]:Xo(e,sr(e))}function n0(e,t,s){return s===i&&(s=t,t=i),s!==i&&(s=xr(s),s=s===s?s:0),t!==i&&(t=xr(t),t=t===t?t:0),Di(xr(e),t,s)}function o0(e,t,s){return t=ii(t),s===i?(s=t,t=0):s=ii(s),e=xr(e),fd(e,t,s)}function a0(e,t,s){if(s&&typeof s!="boolean"&&Zt(e,t,s)&&(t=s=i),s===i&&(typeof t=="boolean"?(s=t,t=i):typeof e=="boolean"&&(s=e,e=i)),e===i&&t===i?(e=0,t=1):(e=ii(e),t===i?(t=e,e=0):t=ii(t)),e>t){var c=e;e=t,t=c}if(s||e%1||t%1){var l=Zc();return Vt(e+l*(t-e+Ve("1e-"+((l+"").length-1))),t)}return da(e,t)}var c0=ns(function(e,t,s){return t=t.toLowerCase(),e+(s?Ah(t):t)});function Ah(e){return ka(Me(e).toLowerCase())}function Rh(e){return e=Me(e),e&&e.replace(Wr,Xf).replace(Ko,"")}function u0(e,t,s){e=Me(e),t=lr(t);var c=e.length;s=s===i?c:Di(_e(s),0,c);var l=s;return s-=t.length,s>=0&&e.slice(s,l)==t}function h0(e){return e=Me(e),e&&tt.test(e)?e.replace(xi,Qf):e}function l0(e){return e=Me(e),e&&At.test(e)?e.replace(ft,"\\$&"):e}var f0=ns(function(e,t,s){return e+(s?"-":"")+t.toLowerCase()}),p0=ns(function(e,t,s){return e+(s?" ":"")+t.toLowerCase()}),d0=Nu("toLowerCase");function g0(e,t,s){e=Me(e),t=_e(t);var c=t?Xi(e):0;if(!t||c>=t)return e;var l=(t-c)/2;return kn(An(l),s)+e+kn(On(l),s)}function y0(e,t,s){e=Me(e),t=_e(t);var c=t?Xi(e):0;return t&&c<t?e+kn(t-c,s):e}function v0(e,t,s){e=Me(e),t=_e(t);var c=t?Xi(e):0;return t&&c<t?kn(t-c,s)+e:e}function m0(e,t,s){return s||t==null?t=0:t&&(t=+t),Pp(Me(e).replace(pt,""),t||0)}function w0(e,t,s){return(s?Zt(e,t,s):t===i)?t=1:t=_e(t),ga(Me(e),t)}function _0(){var e=arguments,t=Me(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var b0=ns(function(e,t,s){return e+(s?"_":"")+t.toLowerCase()});function E0(e,t,s){return s&&typeof s!="number"&&Zt(e,t,s)&&(t=s=i),s=s===i?Z:s>>>0,s?(e=Me(e),e&&(typeof t=="string"||t!=null&&!za(t))&&(t=lr(t),!t&&Zi(e))?vi(Tr(e),0,s):e.split(t,s)):[]}var I0=ns(function(e,t,s){return e+(s?" ":"")+ka(t)});function x0(e,t,s){return e=Me(e),s=s==null?0:Di(_e(s),0,e.length),t=lr(t),e.slice(s,s+t.length)==t}function P0(e,t,s){var c=f.templateSettings;s&&Zt(e,t,s)&&(t=i),e=Me(e),t=Qn({},t,c,qu);var l=Qn({},t.imports,c.imports,qu),p=qt(l),w=Xo(l,p),_,A,k=0,H=t.interpolate||Ki,F="__p += '",X=ea((t.escape||Ki).source+"|"+H.source+"|"+(H===ot?So:Ki).source+"|"+(t.evaluate||Ki).source+"|$","g"),ae="//# sourceURL="+(qe.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Bo+"]")+`
`;e.replace(X,function(le,Se,Ce,pr,Xt,dr){return Ce||(Ce=pr),F+=e.slice(k,dr).replace(No,ep),Se&&(_=!0,F+=`' +
__e(`+Se+`) +
'`),Xt&&(A=!0,F+=`';
`+Xt+`;
__p += '`),Ce&&(F+=`' +
((__t = (`+Ce+`)) == null ? '' : __t) +
'`),k=dr+le.length,le}),F+=`';
`;var he=qe.call(t,"variable")&&t.variable;if(!he)F=`with (obj) {
`+F+`
}
`;else if(xo.test(he))throw new ve(m);F=(A?F.replace(zr,""):F).replace(Wt,"$1").replace(Gr,"$1;"),F="function("+(he||"obj")+`) {
`+(he?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(_?", __e = _.escape":"")+(A?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+F+`return __p
}`;var Ie=Th(function(){return Le(p,ae+"return "+F).apply(i,w)});if(Ie.source=F,Ma(Ie))throw Ie;return Ie}function S0(e){return Me(e).toLowerCase()}function O0(e){return Me(e).toUpperCase()}function A0(e,t,s){if(e=Me(e),e&&(s||t===i))return Uc(e);if(!e||!(t=lr(t)))return e;var c=Tr(e),l=Tr(t),p=kc(c,l),w=Hc(c,l)+1;return vi(c,p,w).join("")}function R0(e,t,s){if(e=Me(e),e&&(s||t===i))return e.slice(0,Bc(e)+1);if(!e||!(t=lr(t)))return e;var c=Tr(e),l=Hc(c,Tr(t))+1;return vi(c,0,l).join("")}function C0(e,t,s){if(e=Me(e),e&&(s||t===i))return e.replace(pt,"");if(!e||!(t=lr(t)))return e;var c=Tr(e),l=kc(c,Tr(t));return vi(c,l).join("")}function T0(e,t){var s=J,c=oe;if(at(t)){var l="separator"in t?t.separator:l;s="length"in t?_e(t.length):s,c="omission"in t?lr(t.omission):c}e=Me(e);var p=e.length;if(Zi(e)){var w=Tr(e);p=w.length}if(s>=p)return e;var _=s-Xi(c);if(_<1)return c;var A=w?vi(w,0,_).join(""):e.slice(0,_);if(l===i)return A+c;if(w&&(_+=A.length-_),za(l)){if(e.slice(_).search(l)){var k,H=A;for(l.global||(l=ea(l.source,Me(yr.exec(l))+"g")),l.lastIndex=0;k=l.exec(H);)var F=k.index;A=A.slice(0,F===i?_:F)}}else if(e.indexOf(lr(l),_)!=_){var X=A.lastIndexOf(l);X>-1&&(A=A.slice(0,X))}return A+c}function N0(e){return e=Me(e),e&&ut.test(e)?e.replace(ci,ap):e}var D0=ns(function(e,t,s){return e+(s?" ":"")+t.toUpperCase()}),ka=Nu("toUpperCase");function Ch(e,t,s){return e=Me(e),t=s?i:t,t===i?rp(e)?hp(e):Gf(e):e.match(t)||[]}var Th=Pe(function(e,t){try{return zt(e,i,t)}catch(s){return Ma(s)?s:new ve(s)}}),$0=ei(function(e,t){return mr(t,function(s){s=Kr(s),Xr(e,s,La(e[s],e))}),e});function L0(e){var t=e==null?0:e.length,s=ce();return e=t?it(e,function(c){if(typeof c[1]!="function")throw new wr(d);return[s(c[0]),c[1]]}):[],Pe(function(c){for(var l=-1;++l<t;){var p=e[l];if(zt(p[0],this,c))return zt(p[1],this,c)}})}function j0(e){return ad(br(e,N))}function Ha(e){return function(){return e}}function M0(e,t){return e==null||e!==e?t:e}var z0=$u(),q0=$u(!0);function nr(e){return e}function Ka(e){return hu(typeof e=="function"?e:br(e,N))}function U0(e){return fu(br(e,N))}function k0(e,t){return pu(e,br(t,N))}var H0=Pe(function(e,t){return function(s){return Ps(s,e,t)}}),K0=Pe(function(e,t){return function(s){return Ps(e,s,t)}});function Ba(e,t,s){var c=qt(t),l=$n(t,c);s==null&&!(at(t)&&(l.length||!c.length))&&(s=t,t=e,e=this,l=$n(t,qt(t)));var p=!(at(s)&&"chain"in s)||!!s.chain,w=ri(e);return mr(l,function(_){var A=t[_];e[_]=A,w&&(e.prototype[_]=function(){var k=this.__chain__;if(p||k){var H=e(this.__wrapped__),F=H.__actions__=rr(this.__actions__);return F.push({func:A,args:arguments,thisArg:e}),H.__chain__=k,H}return A.apply(e,li([this.value()],arguments))})}),e}function B0(){return Re._===this&&(Re._=yp),this}function Va(){}function V0(e){return e=_e(e),Pe(function(t){return du(t,e)})}var F0=Ea(it),G0=Ea(Lc),W0=Ea(Go);function Nh(e){return Ra(e)?Wo(Kr(e)):xd(e)}function J0(e){return function(t){return e==null?i:$i(e,t)}}var Y0=ju(),Z0=ju(!0);function Fa(){return[]}function Ga(){return!1}function X0(){return{}}function Q0(){return""}function em(){return!0}function tm(e,t){if(e=_e(e),e<1||e>Y)return[];var s=Z,c=Vt(e,Z);t=ce(t),e-=Z;for(var l=Zo(c,t);++s<e;)t(s);return l}function rm(e){return we(e)?it(e,Kr):fr(e)?[e]:rr(Xu(Me(e)))}function im(e){var t=++dp;return Me(e)+t}var sm=Un(function(e,t){return e+t},0),nm=Ia("ceil"),om=Un(function(e,t){return e/t},1),am=Ia("floor");function cm(e){return e&&e.length?Dn(e,nr,ca):i}function um(e,t){return e&&e.length?Dn(e,ce(t,2),ca):i}function hm(e){return zc(e,nr)}function lm(e,t){return zc(e,ce(t,2))}function fm(e){return e&&e.length?Dn(e,nr,fa):i}function pm(e,t){return e&&e.length?Dn(e,ce(t,2),fa):i}var dm=Un(function(e,t){return e*t},1),gm=Ia("round"),ym=Un(function(e,t){return e-t},0);function vm(e){return e&&e.length?Yo(e,nr):0}function mm(e,t){return e&&e.length?Yo(e,ce(t,2)):0}return f.after=Uy,f.ary=uh,f.assign=Ov,f.assignIn=Ih,f.assignInWith=Qn,f.assignWith=Av,f.at=Rv,f.before=hh,f.bind=La,f.bindAll=$0,f.bindKey=lh,f.castArray=Xy,f.chain=oh,f.chunk=ag,f.compact=cg,f.concat=ug,f.cond=L0,f.conforms=j0,f.constant=Ha,f.countBy=vy,f.create=Cv,f.curry=fh,f.curryRight=ph,f.debounce=dh,f.defaults=Tv,f.defaultsDeep=Nv,f.defer=ky,f.delay=Hy,f.difference=hg,f.differenceBy=lg,f.differenceWith=fg,f.drop=pg,f.dropRight=dg,f.dropRightWhile=gg,f.dropWhile=yg,f.fill=vg,f.filter=wy,f.flatMap=Ey,f.flatMapDeep=Iy,f.flatMapDepth=xy,f.flatten=rh,f.flattenDeep=mg,f.flattenDepth=wg,f.flip=Ky,f.flow=z0,f.flowRight=q0,f.fromPairs=_g,f.functions=qv,f.functionsIn=Uv,f.groupBy=Py,f.initial=Eg,f.intersection=Ig,f.intersectionBy=xg,f.intersectionWith=Pg,f.invert=Hv,f.invertBy=Kv,f.invokeMap=Oy,f.iteratee=Ka,f.keyBy=Ay,f.keys=qt,f.keysIn=sr,f.map=Gn,f.mapKeys=Vv,f.mapValues=Fv,f.matches=U0,f.matchesProperty=k0,f.memoize=Jn,f.merge=Gv,f.mergeWith=xh,f.method=H0,f.methodOf=K0,f.mixin=Ba,f.negate=Yn,f.nthArg=V0,f.omit=Wv,f.omitBy=Jv,f.once=By,f.orderBy=Ry,f.over=F0,f.overArgs=Vy,f.overEvery=G0,f.overSome=W0,f.partial=ja,f.partialRight=gh,f.partition=Cy,f.pick=Yv,f.pickBy=Ph,f.property=Nh,f.propertyOf=J0,f.pull=Rg,f.pullAll=sh,f.pullAllBy=Cg,f.pullAllWith=Tg,f.pullAt=Ng,f.range=Y0,f.rangeRight=Z0,f.rearg=Fy,f.reject=Dy,f.remove=Dg,f.rest=Gy,f.reverse=Da,f.sampleSize=Ly,f.set=Xv,f.setWith=Qv,f.shuffle=jy,f.slice=$g,f.sortBy=qy,f.sortedUniq=kg,f.sortedUniqBy=Hg,f.split=E0,f.spread=Wy,f.tail=Kg,f.take=Bg,f.takeRight=Vg,f.takeRightWhile=Fg,f.takeWhile=Gg,f.tap=cy,f.throttle=Jy,f.thru=Fn,f.toArray=_h,f.toPairs=Sh,f.toPairsIn=Oh,f.toPath=rm,f.toPlainObject=Eh,f.transform=e0,f.unary=Yy,f.union=Wg,f.unionBy=Jg,f.unionWith=Yg,f.uniq=Zg,f.uniqBy=Xg,f.uniqWith=Qg,f.unset=t0,f.unzip=$a,f.unzipWith=nh,f.update=r0,f.updateWith=i0,f.values=cs,f.valuesIn=s0,f.without=ey,f.words=Ch,f.wrap=Zy,f.xor=ty,f.xorBy=ry,f.xorWith=iy,f.zip=sy,f.zipObject=ny,f.zipObjectDeep=oy,f.zipWith=ay,f.entries=Sh,f.entriesIn=Oh,f.extend=Ih,f.extendWith=Qn,Ba(f,f),f.add=sm,f.attempt=Th,f.camelCase=c0,f.capitalize=Ah,f.ceil=nm,f.clamp=n0,f.clone=Qy,f.cloneDeep=tv,f.cloneDeepWith=rv,f.cloneWith=ev,f.conformsTo=iv,f.deburr=Rh,f.defaultTo=M0,f.divide=om,f.endsWith=u0,f.eq=Dr,f.escape=h0,f.escapeRegExp=l0,f.every=my,f.find=_y,f.findIndex=eh,f.findKey=Dv,f.findLast=by,f.findLastIndex=th,f.findLastKey=$v,f.floor=am,f.forEach=ah,f.forEachRight=ch,f.forIn=Lv,f.forInRight=jv,f.forOwn=Mv,f.forOwnRight=zv,f.get=qa,f.gt=sv,f.gte=nv,f.has=kv,f.hasIn=Ua,f.head=ih,f.identity=nr,f.includes=Sy,f.indexOf=bg,f.inRange=o0,f.invoke=Bv,f.isArguments=Mi,f.isArray=we,f.isArrayBuffer=ov,f.isArrayLike=ir,f.isArrayLikeObject=_t,f.isBoolean=av,f.isBuffer=mi,f.isDate=cv,f.isElement=uv,f.isEmpty=hv,f.isEqual=lv,f.isEqualWith=fv,f.isError=Ma,f.isFinite=pv,f.isFunction=ri,f.isInteger=yh,f.isLength=Zn,f.isMap=vh,f.isMatch=dv,f.isMatchWith=gv,f.isNaN=yv,f.isNative=vv,f.isNil=wv,f.isNull=mv,f.isNumber=mh,f.isObject=at,f.isObjectLike=gt,f.isPlainObject=Ts,f.isRegExp=za,f.isSafeInteger=_v,f.isSet=wh,f.isString=Xn,f.isSymbol=fr,f.isTypedArray=as,f.isUndefined=bv,f.isWeakMap=Ev,f.isWeakSet=Iv,f.join=Sg,f.kebabCase=f0,f.last=Ir,f.lastIndexOf=Og,f.lowerCase=p0,f.lowerFirst=d0,f.lt=xv,f.lte=Pv,f.max=cm,f.maxBy=um,f.mean=hm,f.meanBy=lm,f.min=fm,f.minBy=pm,f.stubArray=Fa,f.stubFalse=Ga,f.stubObject=X0,f.stubString=Q0,f.stubTrue=em,f.multiply=dm,f.nth=Ag,f.noConflict=B0,f.noop=Va,f.now=Wn,f.pad=g0,f.padEnd=y0,f.padStart=v0,f.parseInt=m0,f.random=a0,f.reduce=Ty,f.reduceRight=Ny,f.repeat=w0,f.replace=_0,f.result=Zv,f.round=gm,f.runInContext=O,f.sample=$y,f.size=My,f.snakeCase=b0,f.some=zy,f.sortedIndex=Lg,f.sortedIndexBy=jg,f.sortedIndexOf=Mg,f.sortedLastIndex=zg,f.sortedLastIndexBy=qg,f.sortedLastIndexOf=Ug,f.startCase=I0,f.startsWith=x0,f.subtract=ym,f.sum=vm,f.sumBy=mm,f.template=P0,f.times=tm,f.toFinite=ii,f.toInteger=_e,f.toLength=bh,f.toLower=S0,f.toNumber=xr,f.toSafeInteger=Sv,f.toString=Me,f.toUpper=O0,f.trim=A0,f.trimEnd=R0,f.trimStart=C0,f.truncate=T0,f.unescape=N0,f.uniqueId=im,f.upperCase=D0,f.upperFirst=ka,f.each=ah,f.eachRight=ch,f.first=ih,Ba(f,function(){var e={};return kr(f,function(t,s){qe.call(f.prototype,s)||(e[s]=t)}),e}(),{chain:!1}),f.VERSION=n,mr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){f[e].placeholder=f}),mr(["drop","take"],function(e,t){Ae.prototype[e]=function(s){s=s===i?1:jt(_e(s),0);var c=this.__filtered__&&!t?new Ae(this):this.clone();return c.__filtered__?c.__takeCount__=Vt(s,c.__takeCount__):c.__views__.push({size:Vt(s,Z),type:e+(c.__dir__<0?"Right":"")}),c},Ae.prototype[e+"Right"]=function(s){return this.reverse()[e](s).reverse()}}),mr(["filter","map","takeWhile"],function(e,t){var s=t+1,c=s==g||s==te;Ae.prototype[e]=function(l){var p=this.clone();return p.__iteratees__.push({iteratee:ce(l,3),type:s}),p.__filtered__=p.__filtered__||c,p}}),mr(["head","last"],function(e,t){var s="take"+(t?"Right":"");Ae.prototype[e]=function(){return this[s](1).value()[0]}}),mr(["initial","tail"],function(e,t){var s="drop"+(t?"":"Right");Ae.prototype[e]=function(){return this.__filtered__?new Ae(this):this[s](1)}}),Ae.prototype.compact=function(){return this.filter(nr)},Ae.prototype.find=function(e){return this.filter(e).head()},Ae.prototype.findLast=function(e){return this.reverse().find(e)},Ae.prototype.invokeMap=Pe(function(e,t){return typeof e=="function"?new Ae(this):this.map(function(s){return Ps(s,e,t)})}),Ae.prototype.reject=function(e){return this.filter(Yn(ce(e)))},Ae.prototype.slice=function(e,t){e=_e(e);var s=this;return s.__filtered__&&(e>0||t<0)?new Ae(s):(e<0?s=s.takeRight(-e):e&&(s=s.drop(e)),t!==i&&(t=_e(t),s=t<0?s.dropRight(-t):s.take(t-e)),s)},Ae.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ae.prototype.toArray=function(){return this.take(Z)},kr(Ae.prototype,function(e,t){var s=/^(?:filter|find|map|reject)|While$/.test(t),c=/^(?:head|last)$/.test(t),l=f[c?"take"+(t=="last"?"Right":""):t],p=c||/^find/.test(t);l&&(f.prototype[t]=function(){var w=this.__wrapped__,_=c?[1]:arguments,A=w instanceof Ae,k=_[0],H=A||we(w),F=function(Se){var Ce=l.apply(f,li([Se],_));return c&&X?Ce[0]:Ce};H&&s&&typeof k=="function"&&k.length!=1&&(A=H=!1);var X=this.__chain__,ae=!!this.__actions__.length,he=p&&!X,Ie=A&&!ae;if(!p&&H){w=Ie?w:new Ae(this);var le=e.apply(w,_);return le.__actions__.push({func:Fn,args:[F],thisArg:i}),new _r(le,X)}return he&&Ie?e.apply(this,_):(le=this.thru(F),he?c?le.value()[0]:le.value():le)})}),mr(["pop","push","shift","sort","splice","unshift"],function(e){var t=mn[e],s=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",c=/^(?:pop|shift)$/.test(e);f.prototype[e]=function(){var l=arguments;if(c&&!this.__chain__){var p=this.value();return t.apply(we(p)?p:[],l)}return this[s](function(w){return t.apply(we(w)?w:[],l)})}}),kr(Ae.prototype,function(e,t){var s=f[t];if(s){var c=s.name+"";qe.call(rs,c)||(rs[c]=[]),rs[c].push({name:t,func:s})}}),rs[qn(i,ge).name]=[{name:"wrapper",func:i}],Ae.prototype.clone=Np,Ae.prototype.reverse=Dp,Ae.prototype.value=$p,f.prototype.at=uy,f.prototype.chain=hy,f.prototype.commit=ly,f.prototype.next=fy,f.prototype.plant=dy,f.prototype.reverse=gy,f.prototype.toJSON=f.prototype.valueOf=f.prototype.value=yy,f.prototype.first=f.prototype.head,ms&&(f.prototype[ms]=py),f},Qi=lp();wt?((wt.exports=Qi)._=Qi,Fe._=Qi):Re._=Qi}).call(zs)})(_c,_c.exports);var oI=Object.defineProperty,aI=Object.defineProperties,cI=Object.getOwnPropertyDescriptors,Kl=Object.getOwnPropertySymbols,uI=Object.prototype.hasOwnProperty,hI=Object.prototype.propertyIsEnumerable,Bl=(a,r,i)=>r in a?oI(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,so=(a,r)=>{for(var i in r||(r={}))uI.call(r,i)&&Bl(a,i,r[i]);if(Kl)for(var i of Kl(r))hI.call(r,i)&&Bl(a,i,r[i]);return a},lI=(a,r)=>aI(a,cI(r));function Or(a,r,i){let n;const o=bc(a);return r.rpcMap&&(n=r.rpcMap[o]),n||(n=`${nI}?chainId=eip155:${o}&projectId=${i}`),n}function bc(a){return a.includes("eip155")?Number(a.split(":")[1]):Number(a)}function Uf(a){return a.map(r=>`${r.split(":")[0]}:${r.split(":")[1]}`)}function fI(a,r){const i=Object.keys(r.namespaces).filter(o=>o.includes(a));if(!i.length)return[];const n=[];return i.forEach(o=>{const h=r.namespaces[o].accounts;n.push(...h)}),n}function pI(a={},r={}){const i=Vl(a),n=Vl(r);return _c.exports.merge(i,n)}function Vl(a){var r,i,n,o;const h={};if(!ao(a))return h;for(const[d,m]of Object.entries(a)){const b=nf(d)?[d]:m.chains,v=m.methods||[],x=m.events||[],N=m.rpcMap||{},L=co(d);h[L]=lI(so(so({},h[L]),m),{chains:Ja(b,(r=h[L])==null?void 0:r.chains),methods:Ja(v,(i=h[L])==null?void 0:i.methods),events:Ja(x,(n=h[L])==null?void 0:n.events),rpcMap:so(so({},N),(o=h[L])==null?void 0:o.rpcMap)})}return h}function dI(a){return a.includes(":")?a.split(":")[2]:a}function gI(a){const r={};for(const[i,n]of Object.entries(a)){const o=n.methods||[],h=n.events||[],d=n.accounts||[],m=nf(i)?[i]:n.chains?n.chains:Uf(n.accounts);r[i]={chains:m,methods:o,events:h,accounts:d}}return r}const kf={},Et=a=>kf[a],fc=(a,r)=>{kf[a]=r};class yI{constructor(r){this.name="polkadot",this.namespace=r.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(this.chainId=r,!this.httpProviders[r]){const n=i||Or(`${this.name}:${r}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;r[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Or(r,this.namespace);return typeof n>"u"?void 0:new Ei(new Hi(n,Et("disableProviderPing")))}}class vI{constructor(r){this.name="eip155",this.namespace=r.namespace,this.events=Et("events"),this.client=Et("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(r){switch(r.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(r);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(r.request.method)?await this.client.request(r):this.getHttpProvider().request(r.request)}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}setDefaultChain(r,i){const n=bc(r);if(!this.httpProviders[n]){const o=i||Or(`${this.name}:${n}`,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${n}`);this.setHttpProvider(n,o)}this.chainId=n,this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${n}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}createHttpProvider(r,i){const n=i||Or(`${this.name}:${r}`,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Ei(new Hi(n,Et("disableProviderPing")))}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;const o=bc(i);r[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}getHttpProvider(){const r=this.chainId,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}async handleSwitchChain(r){var i,n;let o=r.request.params?(i=r.request.params[0])==null?void 0:i.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const h=parseInt(o,16);if(this.isChainApproved(h))this.setDefaultChain(`${h}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:r.topic,request:{method:r.request.method,params:[{chainId:o}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${h}`);else throw new Error(`Failed to switch to chain 'eip155:${h}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(r){return this.namespace.chains.includes(`${this.name}:${r}`)}}class mI{constructor(r){this.name="solana",this.namespace=r.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(!this.httpProviders[r]){const n=i||Or(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.chainId=r,this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;r[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Or(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Ei(new Hi(n,Et("disableProviderPing")))}}class wI{constructor(r){this.name="cosmos",this.namespace=r.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(this.chainId=r,!this.httpProviders[r]){const n=i||Or(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;r[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Or(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Ei(new Hi(n,Et("disableProviderPing")))}}class _I{constructor(r){this.name="cip34",this.namespace=r.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(this.chainId=r,!this.httpProviders[r]){const n=i||this.getCardanoRPCUrl(r);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{const n=this.getCardanoRPCUrl(i);r[i]=this.createHttpProvider(i,n)}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}getCardanoRPCUrl(r){const i=this.namespace.rpcMap;if(i)return i[r]}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||this.getCardanoRPCUrl(r);return typeof n>"u"?void 0:new Ei(new Hi(n,Et("disableProviderPing")))}}class bI{constructor(r){this.name="elrond",this.namespace=r.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(!this.httpProviders[r]){const n=i||Or(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.chainId=r,this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;r[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Or(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Ei(new Hi(n,Et("disableProviderPing")))}}class EI{constructor(r){this.name="multiversx",this.namespace=r.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(!this.httpProviders[r]){const n=i||Or(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.chainId=r,this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;r[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Or(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Ei(new Hi(n,Et("disableProviderPing")))}}var II=Object.defineProperty,xI=Object.defineProperties,PI=Object.getOwnPropertyDescriptors,Fl=Object.getOwnPropertySymbols,SI=Object.prototype.hasOwnProperty,OI=Object.prototype.propertyIsEnumerable,Gl=(a,r,i)=>r in a?II(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,no=(a,r)=>{for(var i in r||(r={}))SI.call(r,i)&&Gl(a,i,r[i]);if(Fl)for(var i of Fl(r))OI.call(r,i)&&Gl(a,i,r[i]);return a},pc=(a,r)=>xI(a,PI(r));class Dc{constructor(r){this.events=new Pc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=r,this.logger=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:vo(mo({level:(r==null?void 0:r.logger)||kl})),this.disableProviderPing=(r==null?void 0:r.disableProviderPing)||!1}static async init(r){const i=new Dc(r);return await i.initialize(),i}async request(r,i){const[n,o]=this.validateChain(i);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:no({},r),chainId:`${n}:${o}`,topic:this.session.topic})}sendAsync(r,i,n){this.request(r,n).then(o=>i(null,o)).catch(o=>i(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var r;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(r=this.session)==null?void 0:r.topic,reason:Qt("USER_DISCONNECTED")}),await this.cleanup()}async connect(r){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(r),await this.cleanupPendingPairings(),!r.skipPairing)return await this.pair(r.pairingTopic)}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}removeListener(r,i){this.events.removeListener(r,i)}off(r,i){this.events.off(r,i)}get isWalletConnect(){return!0}async pair(r){this.shouldAbortPairingAttempt=!1;let i=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(i>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:o}=await this.client.connect({pairingTopic:r,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await o().then(h=>{this.session=h,this.namespaces||(this.namespaces=gI(h.namespaces),this.persist("namespaces",this.namespaces))}).catch(h=>{if(h.message!==zf)throw h;i++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(r,i){try{if(!this.session)return;const[n,o]=this.validateChain(r);this.getProvider(n).setDefaultChain(o,i)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(r={}){this.logger.info("Cleaning up inactive pairings...");const i=this.client.pairing.getAll();if(fs(i)){for(const n of i)r.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${i.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const r=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[r]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await VE.init({logger:this.providerOpts.logger||kl,relayUrl:this.providerOpts.relayUrl||rI,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const r=[...new Set(Object.keys(this.session.namespaces).map(i=>co(i)))];fc("client",this.client),fc("events",this.events),fc("disableProviderPing",this.disableProviderPing),r.forEach(i=>{if(!this.session)return;const n=fI(i,this.session),o=Uf(n),h=pI(this.namespaces,this.optionalNamespaces),d=pc(no({},h[i]),{accounts:n,chains:o});switch(i){case"eip155":this.rpcProviders[i]=new vI({namespace:d});break;case"solana":this.rpcProviders[i]=new mI({namespace:d});break;case"cosmos":this.rpcProviders[i]=new wI({namespace:d});break;case"polkadot":this.rpcProviders[i]=new yI({namespace:d});break;case"cip34":this.rpcProviders[i]=new _I({namespace:d});break;case"elrond":this.rpcProviders[i]=new bI({namespace:d});break;case"multiversx":this.rpcProviders[i]=new EI({namespace:d});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",r=>{this.events.emit("session_ping",r)}),this.client.on("session_event",r=>{const{params:i}=r,{event:n}=i;if(n.name==="accountsChanged"){const o=n.data;o&&fs(o)&&this.events.emit("accountsChanged",o.map(dI))}else n.name==="chainChanged"?this.onChainChanged(i.chainId):this.events.emit(n.name,n.data);this.events.emit("session_event",r)}),this.client.on("session_update",({topic:r,params:i})=>{var n;const{namespaces:o}=i,h=(n=this.client)==null?void 0:n.session.get(r);this.session=pc(no({},h),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:r,params:i})}),this.client.on("session_delete",async r=>{await this.cleanup(),this.events.emit("session_delete",r),this.events.emit("disconnect",pc(no({},Qt("USER_DISCONNECTED")),{data:r.topic}))}),this.on(Ii.DEFAULT_CHAIN_CHANGED,r=>{this.onChainChanged(r,!0)})}getProvider(r){if(!this.rpcProviders[r])throw new Error(`Provider not found: ${r}`);return this.rpcProviders[r]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(r=>{var i;this.getProvider(r).updateNamespace((i=this.session)==null?void 0:i.namespaces[r])})}setNamespaces(r){const{namespaces:i,optionalNamespaces:n,sessionProperties:o}=r;i&&Object.keys(i).length&&(this.namespaces=i),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=o,this.persist("namespaces",i),this.persist("optionalNamespaces",n)}validateChain(r){const[i,n]=(r==null?void 0:r.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[i,n];if(i&&!Object.keys(this.namespaces||{}).map(d=>co(d)).includes(i))throw new Error(`Namespace '${i}' is not configured. Please call connect() first with namespace config.`);if(i&&n)return[i,n];const o=co(Object.keys(this.namespaces)[0]),h=this.rpcProviders[o].getDefaultChain();return[o,h]}async requestAccounts(){const[r]=this.validateChain();return await this.getProvider(r).requestAccounts()}onChainChanged(r,i=!1){var n;if(!this.namespaces)return;const[o,h]=this.validateChain(r);i||this.getProvider(o).setDefaultChain(h),((n=this.namespaces[o])!=null?n:this.namespaces[`${o}:${h}`]).defaultChain=h,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",h)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(r,i){this.client.core.storage.setItem(`${Hl}/${r}`,i)}async getFromStore(r){return await this.client.core.storage.getItem(`${Hl}/${r}`)}}const AI=Dc,RI="wc",CI="ethereum_provider",TI=`${RI}@2:${CI}:`,NI="https://rpc.walletconnect.com/v1/",Ec=["eth_sendTransaction","personal_sign"],DI=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Ic=["chainChanged","accountsChanged"],$I=["message","disconnect","connect"];var LI=Object.defineProperty,jI=Object.defineProperties,MI=Object.getOwnPropertyDescriptors,Wl=Object.getOwnPropertySymbols,zI=Object.prototype.hasOwnProperty,qI=Object.prototype.propertyIsEnumerable,Jl=(a,r,i)=>r in a?LI(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,ks=(a,r)=>{for(var i in r||(r={}))zI.call(r,i)&&Jl(a,i,r[i]);if(Wl)for(var i of Wl(r))qI.call(r,i)&&Jl(a,i,r[i]);return a},Yl=(a,r)=>jI(a,MI(r));function po(a){return Number(a[0].split(":")[1])}function dc(a){return`0x${a.toString(16)}`}function UI(a){const{chains:r,optionalChains:i,methods:n,optionalMethods:o,events:h,optionalEvents:d,rpcMap:m}=a;if(!fs(r))throw new Error("Invalid chains");const b={chains:r,methods:n||Ec,events:h||Ic,rpcMap:ks({},r.length?{[po(r)]:m[po(r)]}:{})},v=h==null?void 0:h.filter(K=>!Ic.includes(K)),x=n==null?void 0:n.filter(K=>!Ec.includes(K));if(!i&&!d&&!o&&!(v!=null&&v.length)&&!(x!=null&&x.length))return{required:r.length?b:void 0};const N=(v==null?void 0:v.length)&&(x==null?void 0:x.length)||!i,L={chains:[...new Set(N?b.chains.concat(i||[]):i)],methods:[...new Set(b.methods.concat(o!=null&&o.length?o:DI))],events:[...new Set(b.events.concat(d||$I))],rpcMap:m};return{required:r.length?b:void 0,optional:i.length?L:void 0}}class $c{constructor(){this.events=new Ar.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=TI,this.on=(r,i)=>(this.events.on(r,i),this),this.once=(r,i)=>(this.events.once(r,i),this),this.removeListener=(r,i)=>(this.events.removeListener(r,i),this),this.off=(r,i)=>(this.events.off(r,i),this),this.parseAccount=r=>this.isCompatibleChainId(r)?this.parseAccountId(r).address:r,this.signer={},this.rpc={}}static async init(r){const i=new $c;return await i.initialize(r),i}async request(r){return await this.signer.request(r,this.formatChainId(this.chainId))}sendAsync(r,i){this.signer.sendAsync(r,i,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(r){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(r);const{required:i,optional:n}=UI(this.rpc);try{const o=await new Promise(async(d,m)=>{var b;this.rpc.showQrModal&&((b=this.modal)==null||b.subscribeModal(v=>{!v.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),m(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Yl(ks({namespaces:ks({},i&&{[this.namespace]:i})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:r==null?void 0:r.pairingTopic})).then(v=>{d(v)}).catch(v=>{m(new Error(v.message))})});if(!o)return;this.setChainIds(this.rpc.chains);const h=nw(o.namespaces,[this.namespace]);this.setAccounts(h),this.events.emit("connect",{chainId:dc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",r=>{const{params:i}=r,{event:n}=i;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",r)}),this.signer.on("chainChanged",r=>{const i=parseInt(r);this.chainId=i,this.events.emit("chainChanged",dc(this.chainId)),this.persist()}),this.signer.on("session_update",r=>{this.events.emit("session_update",r)}),this.signer.on("session_delete",r=>{this.reset(),this.events.emit("session_delete",r),this.events.emit("disconnect",Yl(ks({},Qt("USER_DISCONNECTED")),{data:r.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",r=>{var i,n;this.rpc.showQrModal&&((i=this.modal)==null||i.closeModal(),(n=this.modal)==null||n.openModal({uri:r})),this.events.emit("display_uri",r)})}switchEthereumChain(r){this.request({method:"wallet_switchEthereumChain",params:[{chainId:r.toString(16)}]})}isCompatibleChainId(r){return typeof r=="string"?r.startsWith(`${this.namespace}:`):!1}formatChainId(r){return`${this.namespace}:${r}`}parseChainId(r){return Number(r.split(":")[1])}setChainIds(r){const i=r.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));i.length&&(this.chainId=i[0],this.events.emit("chainChanged",dc(this.chainId)),this.persist())}setChainId(r){if(this.isCompatibleChainId(r)){const i=this.parseChainId(r);this.chainId=i,this.switchEthereumChain(i)}}parseAccountId(r){const[i,n,o]=r.split(":");return{chainId:`${i}:${n}`,address:o}}setAccounts(r){this.accounts=r.filter(i=>this.parseChainId(this.parseAccountId(i).chainId)===this.chainId).map(i=>this.parseAccountId(i).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(r){var i,n;const o=(i=r==null?void 0:r.chains)!=null?i:[],h=(n=r==null?void 0:r.optionalChains)!=null?n:[],d=o.concat(h);if(!d.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const m=o.length?(r==null?void 0:r.methods)||Ec:[],b=o.length?(r==null?void 0:r.events)||Ic:[],v=(r==null?void 0:r.optionalMethods)||[],x=(r==null?void 0:r.optionalEvents)||[],N=(r==null?void 0:r.rpcMap)||this.buildRpcMap(d,r.projectId),L=(r==null?void 0:r.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(K=>this.formatChainId(K)),optionalChains:h.map(K=>this.formatChainId(K)),methods:m,events:b,optionalMethods:v,optionalEvents:x,rpcMap:N,showQrModal:!!(r!=null&&r.showQrModal),qrModalOptions:L,projectId:r.projectId,metadata:r.metadata}}buildRpcMap(r,i){const n={};return r.forEach(o=>{n[o]=this.getRpcUrl(o,i)}),n}async initialize(r){if(this.rpc=this.getRpcConfig(r),this.chainId=this.rpc.chains.length?po(this.rpc.chains):po(this.rpc.optionalChains),this.signer=await AI.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:r.disableProviderPing,relayUrl:r.relayUrl,storageOptions:r.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let i;try{const{WalletConnectModal:n}=await ow(()=>import("./chunk.index-5LjPrz-e.js").then(o=>o.a),__vite__mapDeps([0,1]));i=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(i)try{this.modal=new i(ks({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(r){if(!r)return;const{chains:i,optionalChains:n,rpcMap:o}=r;i&&fs(i)&&(this.rpc.chains=i.map(h=>this.formatChainId(h)),i.forEach(h=>{this.rpc.rpcMap[h]=(o==null?void 0:o[h])||this.getRpcUrl(h)})),n&&fs(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(h=>this.formatChainId(h)),n.forEach(h=>{this.rpc.rpcMap[h]=(o==null?void 0:o[h])||this.getRpcUrl(h)}))}getRpcUrl(r,i){var n;return((n=this.rpc.rpcMap)==null?void 0:n[r])||`${NI}?chainId=eip155:${r}&projectId=${i||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const r=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),i=this.session.namespaces[`${this.namespace}:${r}`]?this.session.namespaces[`${this.namespace}:${r}`]:this.session.namespaces[this.namespace];this.setChainIds(r?[this.formatChainId(r)]:i==null?void 0:i.accounts),this.setAccounts(i==null?void 0:i.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(r){return typeof r=="string"||r instanceof String?[this.parseAccount(r)]:r.map(i=>this.parseAccount(i))}}const sx=$c;export{sx as EthereumProvider,$I as OPTIONAL_EVENTS,DI as OPTIONAL_METHODS,Ic as REQUIRED_EVENTS,Ec as REQUIRED_METHODS,$c as default};
